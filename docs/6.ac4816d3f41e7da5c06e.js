(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"/che":function(e,t,n){"use strict";n.d(t,"a",function(){return a});class a{constructor(){this.eventDelegateID=null,this.eventID=null,this.contactID=null,this.addedByID=null,this.assessmentScore=null,this.contractNumber=null,this.eventDelegateTypeID=null,this.eventDelegateStatusID=null,this.setaID=null,this.endDate=null,this.startDate=null,this.projectedEndDate=null,this.scormRegistrationID=null,this.companyID=null}}},"6xY7":function(e,t,n){"use strict";n.d(t,"a",function(){return z});var a=n("8J6U"),i=n("eIep"),r=n("cp0P"),o=n("LRne"),s=n("w6ya"),c=n("4CJs"),l=n("3DXX"),m=n("kSZh"),p=n("t0yg"),g=n("AytR"),d=n("p+bo"),u=n("/che"),h=n("3DtY"),I=n("fXoL"),S=n("8CXc"),D=n("9nlD"),f=n("1bi4"),y=n("5eHb"),v=n("6BoG"),b=n("ev4g"),x=n("kmKP"),E=n("7w9U"),T=n("1kSV"),C=n("euQB"),P=n("XAmU"),M=n("hpld"),k=n("f+9o"),w=n("SVtl"),j=n("S2+F"),O=n("ofXK"),L=n("Jn3s"),V=n("3Pt+"),B=n("SdWN");function A(e,t){1&e&&(I["\u0275\u0275elementContainerStart"](0),I["\u0275\u0275text"](1," Move to next stage "),I["\u0275\u0275elementContainerEnd"]())}function U(e,t){if(1&e&&(I["\u0275\u0275elementContainerStart"](0),I["\u0275\u0275text"](1),I["\u0275\u0275elementContainerEnd"]()),2&e){const e=I["\u0275\u0275nextContext"]();I["\u0275\u0275advance"](1),I["\u0275\u0275textInterpolate1"](" Decline ",e.currentStage.programStageTitle," Stage? ")}}function N(e,t){if(1&e&&(I["\u0275\u0275elementStart"](0,"span"),I["\u0275\u0275text"](1),I["\u0275\u0275elementEnd"]()),2&e){const e=I["\u0275\u0275nextContext"]();I["\u0275\u0275advance"](1),I["\u0275\u0275textInterpolate1"]("+ ",(null==e.applicants?null:e.applicants.length)-1," other candidates")}}function _(e,t){if(1&e&&(I["\u0275\u0275elementStart"](0,"option",24),I["\u0275\u0275text"](1),I["\u0275\u0275elementEnd"]()),2&e){const e=I["\u0275\u0275nextContext"]().$implicit;I["\u0275\u0275property"]("ngValue",e.programInstanceStageID),I["\u0275\u0275advance"](1),I["\u0275\u0275textInterpolate1"](" ",e.programStageTitle," ")}}function $(e,t){if(1&e&&(I["\u0275\u0275elementContainerStart"](0),I["\u0275\u0275template"](1,_,2,2,"option",23),I["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit,n=I["\u0275\u0275nextContext"](2);I["\u0275\u0275advance"](1),I["\u0275\u0275property"]("ngIf",1!==e.programStageTypeID&&n.currentStage.programInstanceStageID!==e.programInstanceStageID)}}function F(e,t){if(1&e){const e=I["\u0275\u0275getCurrentView"]();I["\u0275\u0275elementStart"](0,"div",19),I["\u0275\u0275elementStart"](1,"label",20),I["\u0275\u0275text"](2,"Confirm Stage you'd like to move them to"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](3,"select",21),I["\u0275\u0275listener"]("change",function(){return I["\u0275\u0275restoreView"](e),I["\u0275\u0275nextContext"]().onStageChange()})("ngModelChange",function(t){return I["\u0275\u0275restoreView"](e),I["\u0275\u0275nextContext"]().nextStageID=t}),I["\u0275\u0275template"](4,$,2,1,"ng-container",22),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"]()}if(2&e){const e=I["\u0275\u0275nextContext"]();I["\u0275\u0275advance"](3),I["\u0275\u0275property"]("ngModel",e.nextStageID),I["\u0275\u0275advance"](1),I["\u0275\u0275property"]("ngForOf",e.programInstanceStages)}}function R(e,t){if(1&e&&(I["\u0275\u0275elementStart"](0,"option",24),I["\u0275\u0275text"](1),I["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;I["\u0275\u0275property"]("ngValue",e),I["\u0275\u0275advance"](1),I["\u0275\u0275textInterpolate"](e.emailTemplateTitle)}}function X(e,t){if(1&e){const e=I["\u0275\u0275getCurrentView"]();I["\u0275\u0275elementStart"](0,"button",34),I["\u0275\u0275listener"]("click",function(){return I["\u0275\u0275restoreView"](e),I["\u0275\u0275nextContext"](2).previewTemplate()}),I["\u0275\u0275text"](1," Edit or Preview Template "),I["\u0275\u0275elementEnd"]()}}function q(e,t){if(1&e){const e=I["\u0275\u0275getCurrentView"]();I["\u0275\u0275elementStart"](0,"button",35),I["\u0275\u0275listener"]("click",function(){return I["\u0275\u0275restoreView"](e),I["\u0275\u0275nextContext"](2).sendMeTest()}),I["\u0275\u0275text"](1," Send me a test "),I["\u0275\u0275elementEnd"]()}}function J(e,t){if(1&e){const e=I["\u0275\u0275getCurrentView"]();I["\u0275\u0275elementStart"](0,"div",19),I["\u0275\u0275elementStart"](1,"div",25),I["\u0275\u0275elementStart"](2,"select",26),I["\u0275\u0275listener"]("ngModelChange",function(t){return I["\u0275\u0275restoreView"](e),I["\u0275\u0275nextContext"]().emailTemplate=t}),I["\u0275\u0275elementStart"](3,"option",24),I["\u0275\u0275text"](4,"Select Template"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275template"](5,R,2,2,"option",27),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](6,"div",28),I["\u0275\u0275elementStart"](7,"span",29),I["\u0275\u0275text"](8,"or"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](9,"span",30),I["\u0275\u0275listener"]("click",function(){return I["\u0275\u0275restoreView"](e),I["\u0275\u0275nextContext"]().addTemplate()}),I["\u0275\u0275text"](10,"Add New"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](11,"div",31),I["\u0275\u0275template"](12,X,2,0,"button",32),I["\u0275\u0275template"](13,q,2,0,"button",33),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"]()}if(2&e){const e=I["\u0275\u0275nextContext"]();I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("ngModel",e.emailTemplate),I["\u0275\u0275advance"](1),I["\u0275\u0275property"]("ngValue",void 0),I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("ngForOf",e.emailTemplates),I["\u0275\u0275advance"](7),I["\u0275\u0275property"]("ngIf",e.emailTemplate),I["\u0275\u0275advance"](1),I["\u0275\u0275property"]("ngIf",e.emailTemplate)}}let z=(()=>{class e{constructor(e,t,n,a,i,r,o,s,c,l,m,p,d,u,h,I){this.programsService=e,this.notificationService=t,this.distributionService=n,this.toastrService=a,this.eventService=i,this.taskService=r,this.userService=o,this.emailTemplateService=s,this.activeModal=c,this.portfolioService=l,this.discussionService=m,this.courseService=p,this.trainingPlanService=d,this.networkService=u,this.modal=h,this.signalRService=I,this.programInstanceStages=[],this.applicants=[],this.emailTemplates=[],this.tasks=[],this.events=[],this.courses=[],this.blobUrl=g.a.apiBlobUrl+"/512px/",this.user=this.userService.user.getValue(),this.contactID=this.user.contactID}ngOnInit(){this.applicant=this.applicants[0],this.nextStageID=this.nextStage?this.nextStage.programInstanceStageID:this.currentStage.programInstanceStageID,this.fillTemplates(),this.nextStage&&(this.getCourses(),this.getEvents(),this.getTasks())}onStageChange(){this.courses=[],this.events=[],this.tasks=[],this.getTasks(),this.getCourses(),this.getEvents(),this.nextStage&&(this.nextStage=this.programInstanceStages.find(e=>e.programInstanceStageID===this.nextStageID))}submit(){3===this.stageStatus?this.accept():this.decline()}accept(){let e,t;this.loading=!0;const n=[];this.applicants.forEach(i=>{e=i.companyProgramStageStartDate,t=i.companyProgramStageEndDate,this.currentStage.rollingIntake&&3===this.stageStatus&&(t=Object(a.a)(new Date)),n.push(this.portfolioService.updateStage({companyProgramInstanceStageID:i.companyProgramInstanceStageID,companyProgramStageStartDate:e,companyProgramStageEndDate:t,companyProgramStageStatusID:3,companyLocationID:i.companyLocationID,companyProgramInstanceStageTypeID:i.companyProgramInstanceStageTypeID,programInstanceStageID:i.programInstanceStageID,companyProgramInstanceStageActivationStatusDate:i.companyProgramInstanceStageActivationStatusDate,companyProgramInstanceStageActivationStatusID:i.companyProgramInstanceStageActivationStatusID,programInstanceStageStatusID:i.programInstanceStageStatusID,companyProgramInstanceID:i.companyProgramInstanceID}))}),Object(r.a)(n).pipe(Object(i.a)(()=>{if(!this.nextStage)return Object(o.a)([]);const e=[];return this.applicants.forEach(t=>{let n=this.nextStage.programStageStartDate,i=this.nextStage.programStageEndDate;this.nextStage.rollingIntake&&(n=Object(a.a)(new Date),i=null);const r={programInstanceStageID:this.nextStage.programInstanceStageID,companyProgramStageStartDate:n,companyProgramStageEndDate:i,companyProgramStageStatusID:2,companyLocationID:t.companyLocationID,companyProgramInstanceID:t.companyProgramInstanceID,companyProgramInstanceStageTypeID:t.companyProgramInstanceStageTypeID,contactID:t.contactID,companyID:t.companyID};3===this.nextStage.programStageTypeID&&t.companyID&&this.joinNetwork(t.companyID),e.push(this.portfolioService.insertStage(r))}),Object(r.a)(e)})).subscribe(e=>{let t={};e.forEach(e=>{e.companyProgramInstanceStageID=e.inOut_CompanyProgramInstanceStageID,e.programStageTitle=this.nextStage.programStageTitle;const n=this.applicants.find(t=>t.companyProgramInstanceID===e.companyProgramInstanceID);n&&(e.companyID=n.companyID,e.contactID=n.contactID),t=e,this.activate(e)}),this.notifyApplicant(),this.emailOn&&this.applicants.forEach(e=>{this.discussionCheck(e)}),this.loading=!1,this.toastrService.success(`${this.applicants.length} candidates successfully enrolled on ${this.programInstance.programTitle}`),this.activeModal.close({currentStage:this.applicant,nextStage:t})})}decline(){this.loading=!0;const e=[];let t;this.applicants.forEach(n=>{t=n.companyProgramStageEndDate,this.currentStage.rollingIntake&&3===this.stageStatus&&(t=Object(a.a)(new Date)),e.push(this.portfolioService.updateStage({companyProgramInstanceStageID:n.companyProgramInstanceStageID,companyProgramStageStartDate:n.companyProgramStageStartDate,companyProgramStageEndDate:t,companyProgramStageStatusID:4,companyLocationID:n.companyLocationID,companyProgramInstanceStageTypeID:n.companyProgramInstanceStageTypeID,programInstanceStageID:n.programInstanceStageID,companyProgramInstanceStageActivationStatusDate:n.companyProgramInstanceStageActivationStatusDate,companyProgramInstanceStageActivationStatusID:n.companyProgramInstanceStageActivationStatusID,programInstanceStageStatusID:n.programInstanceStageStatusID,companyProgramInstanceID:n.companyProgramInstanceID}))}),Object(r.a)(e).subscribe(()=>{this.emailOn&&this.applicants.forEach(e=>{this.discussionCheck(e)}),this.notifyApplicant(),this.loading=!1,this.activeModal.close({currentStage:this.applicant})})}dismiss(){this.activeModal.dismiss()}notifyApplicant(){this.applicants.forEach(e=>{let t=`Congratulations, you've progressed to the ${this.nextStage.programStageTitle||this.currentStage.programStageTitle} of ${this.programInstance.programTitle}`,n=s.a.program_stage_accept;4===this.stageStatus&&(t=`Unfortunately you did not progress to the ${this.nextStage.programStageTitle||this.currentStage.programStageTitle} of ${this.programInstance.programTitle}`,n=s.a.program_stage_decline);const i={notificationCategoryID:n,referenceID:3===this.stageStatus?this.nextStage.programInstanceStageID||this.currentStage.programInstanceStageID:e.programInstanceStageID,contactID:e.contactID,description:t,createdContact:this.contactID},r=(new Date).getTime()+"|"+e.companyProgramInstanceStageID,o={date:Object(a.a)(new Date),body:t,topic:t,senderFullName:"",senderPhoto:"",notificationId:Math.floor(1e3*Math.random()),channel:"dashboard",reference:i.referenceID,notificationType:c.a.other,senderId:i.createdContact,receivers:[i.contactID],uniqueId:r,discussionId:0};this.notificationService.noticeNotification(i).subscribe(()=>{this.signalRService.transferMessage("dashboard",o)})})}discussionCheck(e){let t,n=[];this.discussionService.fetchDiscussions(0,e.companyProgramInstanceID,5,0,0,0).pipe(Object(i.a)(e=>e.length>0?(t=e[0],this.discussionService.getAllMembers(e[0].discussionID)):Object(o.a)([]))).subscribe(i=>{if(n=i,t&&!n.filter(e=>e.contactID===this.contactID).length){const e={discussionID:t.discussionID,contactID:this.contactID,isAdmin:!0,hasAccepted:!0,dateAccepted:Object(a.a)(new Date)};this.discussionService.addMember(e).subscribe()}if(t&&!n.filter(t=>t.contactID===e.contactID).length){const n={discussionID:t.discussionID,contactID:e.contactID,isAdmin:!0,hasAccepted:!0,dateAccepted:Object(a.a)(new Date)};this.discussionService.addMember(n).subscribe()}i.length||t?this.sendEmail(e,t):this.createDiscussion(e)})}createDiscussion(e){let t;this.discussionService.insertDiscussion({discussionTopic:""+e.companyName,discussionCategoryID:5,isDirectMessage:!0,discussionCreatedByContactID:this.contactID,referenceID:e.companyProgramInstanceID,discussionBody:""+e.companyName}).pipe(Object(i.a)(n=>{t=n;const a=[],i=[e.contactID];return i.includes(this.contactID)||i.push(this.contactID),i.forEach(e=>{a.push(this.discussionService.addMember({discussionID:t.discussionID,contactID:e,isAdmin:!0}))}),Object(r.a)(a)})).subscribe(()=>{this.sendEmail(e,t)})}sendEmail(e,t){var n;const i=t.discussionID,r="chat"+i,o=Object(a.n)(i+"|"+e.contactID+"|"+r);let s=`<p>Hi ${e.firstname},</p>`+this.emailTemplate.emailBody;e.masterCompanyLogo&&(s=l.a.logo(this.blobUrl+e.masterCompanyLogo)+s);const c={distributionTitle:"Stage sign off status",distributionCategoryID:this.emailTemplate.distributionCategoryID,referenceID:e.programInstanceStageID,distributionDate:null,userID:this.user.contactID,emailBody:l.a.template(s),subjectLine:this.emailTemplate.subjectLine||"Delivery Test",senderEmail:"info@incubatorportal.com",senderName:`${this.user.firstName} ${this.user.surname}`,replyTo:o+"@message.avnon.co",contacts:[e.contactID]};this.distributionService.create(c).subscribe(()=>{},()=>{});let m="";m=(null===(n=this.nextStage)||void 0===n?void 0:n.programStageTitle)?this.nextStage.programStageTitle:this.currentStage.programStageTitle,this.discussionService.insertDiscussion({discussionTopic:m+" "+(3===this.stageStatus?"Passed":"Failed"),discussionCategoryID:3===this.stageStatus?5:40,isDirectMessage:!0,discussionCreatedByContactID:this.contactID,discussionBody:this.emailTemplate.emailBody,parentDiscussionID:t.discussionID,referenceID:e.companyProgramInstanceStageID}).subscribe()}fillTemplates(){this.emailLoading=!0,this.emailTemplateService.getEmailTemplate(0,0,this.user.companyID,0).subscribe(e=>{this.emailTemplates=e.filter(e=>7!==e.distributionCategoryID),this.emailLoading=!1},()=>this.emailLoading=!1)}addTemplate(){const e=this.modal.open(m.a,{backdrop:"static",size:"lg"});e.componentInstance.isStage=!0,e.result.then(e=>{e&&(this.emailTemplates.push(e),this.previewTemplate(e))})}previewTemplate(e=null){const t=this.modal.open(p.a,{size:"lg",backdrop:"static"});t.componentInstance.emailTemplate=Object(a.l)(this.emailTemplate),t.componentInstance.firstName=this.applicants.length>1?"{firstName}":this.applicant.firstname||this.applicant.firstName,t.componentInstance.companyLogo=this.blobUrl+this.applicant.masterCompanyLogo,e&&(t.componentInstance.emailTemplate=e),t.result.then(e=>{if(e&&e.emailTemplateID){const t=this.emailTemplates.findIndex(t=>t.emailTemplateID===e.emailTemplateID);-1!==t&&(this.emailTemplates[t]=e,this.emailTemplate=e)}})}sendMeTest(){let e=`<p>Hi ${this.applicant.firstname},</p>`+this.emailTemplate.emailBody;this.applicant.masterCompanyLogo&&(e=l.a.logo(this.blobUrl+this.applicant.masterCompanyLogo)+e);const t={distributionTitle:"Stage sign off status",distributionCategoryID:this.emailTemplate.distributionCategoryID,referenceID:this.applicant.programInstanceStageID,distributionDate:null,userID:this.user.contactID,emailBody:l.a.template(e),subjectLine:this.emailTemplate.subjectLine||"Delivery Test",senderEmail:"info@incubatorportal.com",senderName:`${this.user.firstName} ${this.user.surname}`,replyTo:null,contacts:[this.contactID]};this.distributionService.create(t).subscribe(()=>{this.toastrService.success("Test email sent successfully")})}getTasks(){this.taskLoading=!0,this.taskService.getTask(0,17,this.nextStageID,0,0,0,0,0).subscribe(e=>{this.tasks=e,this.taskLoading=!1},()=>this.taskLoading=!1)}getEvents(){this.eventsLoading=!0,this.eventService.selectEvents({ReferenceID:this.nextStageID,EventSubCategoryID:8}).subscribe(e=>{this.events=Object(a.j)(e,"eventID"),this.eventsLoading=!1},()=>this.eventsLoading=!1)}getCourses(){this.courseLoading=!0,this.programsService.getProgramInstanceStageCourses(this.nextStageID).subscribe(e=>{this.courses=e,this.courseLoading=!1},()=>this.courseLoading=!1)}activate(e){const t={companyProgramInstanceStageID:e.companyProgramInstanceStageID,companyProgramStageStartDate:e.companyProgramStageStartDate,companyProgramStageEndDate:e.companyProgramStageEndDate,companyProgramStageStatusID:e.companyProgramStageStatusID,companyLocationID:e.companyLocationID,companyProgramInstanceStageTypeID:e.companyProgramInstanceStageTypeID,programInstanceStageID:e.programInstanceStageID,companyProgramInstanceStageActivationStatusDate:Object(a.a)(new Date),companyProgramInstanceStageActivationStatusID:1,programInstanceStageStatusID:e.programInstanceStageStatusID,companyProgramInstanceID:e.companyProgramInstanceID};this.portfolioService.updateStage(t).pipe(Object(i.a)(()=>{const t=[];return this.tasks.forEach(n=>{const a=new d.a;a.taskID=n.taskID,a.contactID=e.contactID,a.companyID=e.companyID,a.taskOwnerCategoryID=1,t.push(this.taskService.addTaskOwner(a))}),this.courses.forEach(n=>{t.push(this.trainingPlanService.insertTrainingPlan({masterCompanyID:0,periodID:0,companyID:e.companyID,contactID:e.contactID,courseID:n.courseID,trainingPlanCategoryID:2,referenceID:e.programInstanceStageID,trainingPlanStatusID:0,budgetCost:0,budgetDuration:0,budgetDurationTypeID:0,addedby:0}))}),this.events.forEach(n=>{const a=new u.a;a.eventID=n.eventID,a.contactID=e.contactID,a.companyID=e.companyID,a.eventDelegateTypeID=2!==n.eventCategoryID?h.b.TRAINING_DELEGATE:h.b.APPLICANT,a.addedByID=this.contactID,a.eventDelegateStatusID=1,t.push(this.eventService.insertEventDelegate(a))}),t.length?Object(r.a)(t):Object(o.a)([])})).subscribe(t=>{t.forEach(t=>{if(t.hasOwnProperty("taskOwnerID")){const n=this.tasks.find(e=>e.taskID===t.taskID);if(n){const s={discussionTopic:n.taskTitle,discussionCategoryID:6,referenceID:t.taskOwnerID,isDirectMessage:!0,discussionCreatedByContactID:e.contactID,discussionBody:n.taskDescription,parentDiscussionID:0},c=[];n.taskSupporters.forEach(e=>{c.includes(e.contactID)||c.push(e.contactID)}),c.includes(n.submittedBy)||c.push(n.submittedBy),c.includes(this.contactID)||c.includes(this.contactID),this.discussionService.insertDiscussion(s).pipe(Object(i.a)(e=>{const t=[];return c.forEach(n=>{const i={discussionID:e.discussionID,contactID:n,isAdmin:!0,hasAccepted:!0,dateAccepted:Object(a.a)(new Date)};t.push(this.discussionService.addMember(i))}),t.length?Object(r.a)(t):Object(o.a)([])})).subscribe()}}})},()=>{})}joinNetwork(e){var t;let n;this.networkService.getNetwork(0,0,0,0,this.user.companyID||(null===(t=this.programInstance)||void 0===t?void 0:t.companyID),0,1).pipe(Object(i.a)(t=>(n=t[0]||null,t.length?this.networkService.getNetworkMember(t[0].networkID,2,0,e,0,0):Object(o.a)([]))),Object(i.a)(t=>n&&!t.length?this.networkService.saveNetworkMember({networkID:n?n.networkID:0,networkMemberCategoryID:2,referenceID:e,addedByContactID:this.contactID,networkMemberStatusID:2}):Object(o.a)([]))).subscribe()}}return e.\u0275fac=function(t){return new(t||e)(I["\u0275\u0275directiveInject"](S.a),I["\u0275\u0275directiveInject"](D.a),I["\u0275\u0275directiveInject"](f.a),I["\u0275\u0275directiveInject"](y.b),I["\u0275\u0275directiveInject"](v.a),I["\u0275\u0275directiveInject"](b.a),I["\u0275\u0275directiveInject"](x.a),I["\u0275\u0275directiveInject"](E.a),I["\u0275\u0275directiveInject"](T.a),I["\u0275\u0275directiveInject"](C.a),I["\u0275\u0275directiveInject"](P.a),I["\u0275\u0275directiveInject"](M.a),I["\u0275\u0275directiveInject"](k.a),I["\u0275\u0275directiveInject"](w.a),I["\u0275\u0275directiveInject"](T.p),I["\u0275\u0275directiveInject"](j.a))},e.\u0275cmp=I["\u0275\u0275defineComponent"]({type:e,selectors:[["app-stage-bulk-confirm-modal"]],decls:28,vars:15,consts:[[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","d-flex","flex-column",3,"avnonLoader"],[1,"applicant-info","w-100","mb-4","pb-3","d-flex"],[1,"avatar","avatar-rounded","avatar-60",3,"src"],[1,"meta-desc","d-flex","flex-column","ml-2"],[1,"name"],[1,"company"],[3,"submit"],["f","ngForm"],["class","form-group",4,"ngIf"],[1,"form-group","form-check"],["type","checkbox","id","exampleCheck1","name","emailOn",1,"form-check-input",3,"checked","ngModel","ngModelChange"],["for","exampleCheck1",1,"form-check-label"],[1,"form-group","text-right"],[1,"btn","btn-primary",3,"disabled"],[1,"form-group"],["for","nextStage"],["name","nextStage","id","nextStage","required","",1,"form-control",3,"ngModel","change","ngModelChange"],[4,"ngFor","ngForOf"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],[1,"input-group","mb-3"],["name","emailTemplate","id","emailTemplate","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"input-group-append","align-items-center"],[1,"ml-1","mr-1"],[1,"cursor-pointer","text-primary",3,"click"],[1,"preview-action","d-flex","align-items-center"],["type","button","class","btn btn-sm btn-outline-primary",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-info ml-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-sm","btn-outline-info","ml-2",3,"click"]],template:function(e,t){if(1&e&&(I["\u0275\u0275elementStart"](0,"div",0),I["\u0275\u0275elementStart"](1,"h5",1),I["\u0275\u0275template"](2,A,2,0,"ng-container",2),I["\u0275\u0275template"](3,U,2,1,"ng-container",2),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](4,"button",3),I["\u0275\u0275listener"]("click",function(){return t.dismiss()}),I["\u0275\u0275elementStart"](5,"span",4),I["\u0275\u0275text"](6,"\xd7"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](7,"div",5),I["\u0275\u0275elementStart"](8,"div",6),I["\u0275\u0275element"](9,"img",7),I["\u0275\u0275pipe"](10,"avatar"),I["\u0275\u0275elementStart"](11,"div",8),I["\u0275\u0275elementStart"](12,"span",9),I["\u0275\u0275text"](13),I["\u0275\u0275template"](14,N,2,1,"span",2),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](15,"span",10),I["\u0275\u0275text"](16),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](17,"form",11,12),I["\u0275\u0275listener"]("submit",function(){return t.submit()}),I["\u0275\u0275template"](19,F,5,2,"div",13),I["\u0275\u0275elementStart"](20,"div",14),I["\u0275\u0275elementStart"](21,"input",15),I["\u0275\u0275listener"]("ngModelChange",function(e){return t.emailOn=e}),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementStart"](22,"label",16),I["\u0275\u0275text"](23,"Send notification email"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275template"](24,J,14,5,"div",13),I["\u0275\u0275elementStart"](25,"div",17),I["\u0275\u0275elementStart"](26,"button",18),I["\u0275\u0275text"](27," Confirm "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"](),I["\u0275\u0275elementEnd"]()),2&e){const e=I["\u0275\u0275reference"](18);I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("ngIf",3===t.stageStatus),I["\u0275\u0275advance"](1),I["\u0275\u0275property"]("ngIf",4===t.stageStatus),I["\u0275\u0275advance"](4),I["\u0275\u0275property"]("avnonLoader",t.loading||t.emailLoading||t.taskLoading||t.eventsLoading||t.courseLoading),I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("src",I["\u0275\u0275pipeBind1"](10,13,null==t.applicant?null:t.applicant.profilePhoto),I["\u0275\u0275sanitizeUrl"]),I["\u0275\u0275advance"](4),I["\u0275\u0275textInterpolate2"](" ",null==t.applicant?null:t.applicant.firstname," ",null==t.applicant?null:t.applicant.surname," "),I["\u0275\u0275advance"](1),I["\u0275\u0275property"]("ngIf",t.applicants.length-1>0),I["\u0275\u0275advance"](2),I["\u0275\u0275textInterpolate"](null==t.applicant?null:t.applicant.companyName),I["\u0275\u0275advance"](3),I["\u0275\u0275property"]("ngIf",3===t.stageStatus),I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("checked",t.emailOn)("ngModel",t.emailOn),I["\u0275\u0275advance"](3),I["\u0275\u0275property"]("ngIf",t.emailOn),I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("disabled",t.loading||e.invalid||t.emailOn&&!t.emailTemplate)}},directives:[O.n,L.a,V.E,V.r,V.s,V.a,V.q,V.t,V.B,V.A,O.m,V.v,V.D],pipes:[B.a],styles:[".applicant-info[_ngcontent-%COMP%]{border-bottom:1px dotted #aaa}.applicant-info[_ngcontent-%COMP%]   .avatar-60[_ngcontent-%COMP%]{height:60px;float:left;object-fit:cover}.applicant-info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.applicant-info[_ngcontent-%COMP%]   .company[_ngcontent-%COMP%]{font-size:14px}"]}),e})()},"7w9U":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("fXoL"),i=n("tk/3");let r=(()=>{class e{constructor(e){this.http=e,this.BaseURI="https://api.incubatorportal.com/api"}getEmailTemplate(e,t,n,a){return this.http.get(this.BaseURI+"/emailtemplate?emailTemplateCategoryID="+e+"&languageID="+t+"&companyID="+n+"&emailTemplateID="+a)}updateEmailTemplate(e){return this.http.put(this.BaseURI+"/emailtemplate",e)}addEmailTemplate(e){return this.http.post(this.BaseURI+"/emailtemplate",e)}deleteEmailTemplate(e){return this.http.delete(`${this.BaseURI}/emailtemplate/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275inject"](i.b))},e.\u0275prov=a["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},JZpI:function(e,t,n){"use strict";n.d(t,"a",function(){return a});class a{constructor(){this.emailTemplateID=null,this.companyID=null,this.emailTemplateCategoryID=null,this.emailTemplateTitle=null,this.emailTemplateDescription=null,this.emailTemplateStatusID=null,this.emailBody=null,this.subjectLine=null,this.bannerImage=null,this.languageID=null,this.distributionCategoryID=null}}},LFK6:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("fXoL"),i=n("tyNb"),r=n("ofXK");let o=(()=>{class e{constructor(e,t){this.router=e,this.location=t,this.currentUrl=""}storePreviousUrl(){this.currentUrl=this.router.url}backToPrevious(){if(this.currentUrl)return this.router.navigateByUrl(this.currentUrl),void(this.currentUrl="");this.location.back()}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275inject"](i.d),a["\u0275\u0275inject"](r.j))},e.\u0275prov=a["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},"f+9o":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("fXoL"),i=n("tk/3");let r=(()=>{class e{constructor(e){this.http=e,this.BaseURI="https://api.incubatorportal.com/api"}getCompanyTrainingPlan(e,t,n,a,i,r,o){return this.http.get(this.BaseURI+"/training/plan?masterCompanyID="+e+"&companyID="+t+"&contactID="+n+"&courseID="+a+"&periodID="+i+"&referenceID="+r+"&trainingPlanCategoryID="+o)}insertTrainingPlan(e){return this.http.post(this.BaseURI+"/training/plan",e)}updateTrainingPlan(e){return this.http.put(this.BaseURI+"/training/plan",e)}deleteTrainingPlan(e){return this.http.delete(`${this.BaseURI}/training/plan/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275inject"](i.b))},e.\u0275prov=a["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},kSZh:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n("JZpI"),i=n("fXoL"),r=n("1kSV"),o=n("7w9U"),s=n("kmKP"),c=n("Jn3s"),l=n("3Pt+"),m=n("ofXK");function p(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"option",10),i["\u0275\u0275text"](1,"Application Declined Email"),i["\u0275\u0275elementEnd"]()),2&e&&i["\u0275\u0275property"]("ngValue",10)}function g(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"option",10),i["\u0275\u0275text"](1,"Stage successfully completed"),i["\u0275\u0275elementEnd"]()),2&e&&i["\u0275\u0275property"]("ngValue",9)}function d(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"option",10),i["\u0275\u0275text"](1,"Event Delegate Email"),i["\u0275\u0275elementEnd"]()),2&e&&i["\u0275\u0275property"]("ngValue",7)}function u(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"option",10),i["\u0275\u0275text"](1,"Event Email"),i["\u0275\u0275elementEnd"]()),2&e&&i["\u0275\u0275property"]("ngValue",2)}let h=(()=>{class e{constructor(e,t,n){this.ngbActiveModal=e,this.emailTemplateService=t,this.userService=n,this.emailTemplate=new a.a,this.user=n.user.getValue()}ngOnInit(){}onSubmit(){this.loading=!0,this.emailTemplate.companyID=this.user.companyID||0,this.emailTemplateService.addEmailTemplate(this.emailTemplate).subscribe(e=>{this.loading=!1,e.emailTemplateID=e.inOut_EmailTemplateID,this.ngbActiveModal.close(e)})}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](o.a),i["\u0275\u0275directiveInject"](s.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-email-template-add"]],decls:31,vars:11,consts:[[1,"modal-header"],["id","postModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body",3,"avnonLoader"],[1,"d-flex","flex-column","w-100","template-add",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","taskTitle"],["name","templateCategory","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngIf"],["type","text","name","taskTitle","id","taskTitle","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","emailTemplateDescription","id","emailTemplateDescription","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","text-right"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",0),i["\u0275\u0275elementStart"](1,"h5",1),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"button",2),i["\u0275\u0275listener"]("click",function(){return t.ngbActiveModal.dismiss()}),i["\u0275\u0275elementStart"](4,"span",3),i["\u0275\u0275text"](5,"\xd7"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"div",4),i["\u0275\u0275elementStart"](7,"form",5,6),i["\u0275\u0275listener"]("ngSubmit",function(){return t.onSubmit()}),i["\u0275\u0275elementStart"](9,"div",7),i["\u0275\u0275elementStart"](10,"label",8),i["\u0275\u0275text"](11,"Template Category *"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"select",9),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.emailTemplate.distributionCategoryID=e}),i["\u0275\u0275elementStart"](13,"option",10),i["\u0275\u0275text"](14,"- Please select -"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](15,p,2,1,"option",11),i["\u0275\u0275template"](16,g,2,1,"option",11),i["\u0275\u0275template"](17,d,2,1,"option",11),i["\u0275\u0275template"](18,u,2,1,"option",11),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](19,"div",7),i["\u0275\u0275elementStart"](20,"label",8),i["\u0275\u0275text"](21,"Template Title *"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](22,"input",12),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.emailTemplate.emailTemplateTitle=e}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](23,"div",7),i["\u0275\u0275elementStart"](24,"label",8),i["\u0275\u0275text"](25,"Description "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](26,"textarea",13),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.emailTemplate.emailTemplateDescription=e}),i["\u0275\u0275text"](27,"\t\t\t"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](28,"div",14),i["\u0275\u0275elementStart"](29,"button",15),i["\u0275\u0275text"](30," Submit "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275reference"](8);i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate1"](" ",t.emailTemplate&&t.emailTemplate.emailTemplateID?"Edit":"Create"," Template "),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("avnonLoader",t.loading),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",t.emailTemplate.distributionCategoryID),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngValue",null),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",!t.isDelegate&&!t.isEvent),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!t.isDelegate&&!t.isEvent),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!t.isStage&&!t.isEvent),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!t.isStage&&!t.isDelegate),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngModel",t.emailTemplate.emailTemplateTitle),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngModel",t.emailTemplate.emailTemplateDescription),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("disabled",e.invalid)}},directives:[c.a,l.E,l.r,l.s,l.B,l.A,l.q,l.t,l.v,l.D,m.n,l.b],styles:["textarea.form-control[_ngcontent-%COMP%]{height:auto!important}"]}),e})()},ntIU:function(e,t,n){"use strict";n.d(t,"a",function(){return P});var a=n("OzGw"),i=n("Ay/5"),r=n("8J6U"),o=n("fXoL"),s=n("euQB"),c=n("1kSV"),l=n("Jn3s"),m=n("3Pt+"),p=n("ofXK");function g(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"option",19),o["\u0275\u0275text"](1,"Please Select"),o["\u0275\u0275elementEnd"]()),2&e&&o["\u0275\u0275property"]("ngValue",null)}function d(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"option",19),o["\u0275\u0275text"](1,"Please Select "),o["\u0275\u0275elementEnd"]()),2&e&&o["\u0275\u0275property"]("ngValue",void 0)}function u(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"option",19),o["\u0275\u0275text"](1,"Please Select"),o["\u0275\u0275elementEnd"]()),2&e&&o["\u0275\u0275property"]("ngValue",0)}let h=(()=>{class e{constructor(e,t){this.portfolioService=e,this.activeModal=t,this.stage=new i.a}ngOnInit(){if(this.stage.companyProgramStageStartDate){const e=new Date(this.stage.companyProgramStageStartDate);this.startDateModel={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}if(this.stage.companyProgramStageEndDate){const e=new Date(this.stage.companyProgramStageEndDate);this.endDateModel={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}}submit(){this.loading=!0;let e=null,t=null;this.startDateModel.year&&(e=new Date(this.startDateModel.year,this.startDateModel.month-1,this.startDateModel.day,0,0)),this.endDateModel.year&&(t=new Date(this.endDateModel.year,this.endDateModel.month-1,this.endDateModel.day,0,0)),this.stage.companyProgramStageStartDate=Object(r.a)(e),this.stage.companyProgramStageEndDate=Object(r.a)(t),this.portfolioService.updateStage(this.stage).subscribe(()=>{this.activeModal.close(this.stage),this.loading=!1})}dismiss(){this.activeModal.dismiss()}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](s.a),o["\u0275\u0275directiveInject"](c.a))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-company-stage-dialog"]],decls:43,vars:17,consts:[[1,"modal-header"],["id","postModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","d-flex","flex-column",3,"avnonLoader"],[3,"ngSubmit"],["f","ngForm"],[1,"form-group"],[1,"input-group"],["placeholder","dd-mm-yyyy","name","startDate","required","","ngbDatepicker","",1,"form-control",3,"ngModel","readOnly","ngModelChange","click"],["startDatePicker","ngbDatepicker"],[1,"input-group-append"],[1,"input-group-text","bg-transparent",3,"click"],[1,"calendar-icon","icon-sm"],["placeholder","dd-mm-yyyy","name","endDate","required","","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange","click"],["endDatePicker","ngbDatepicker"],["for","companyProgramStageStatusID"],["name","companyProgramStageStatusID","id","companyProgramStageStatusID","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],[1,"text-right","pt-3"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"div",0),o["\u0275\u0275elementStart"](1,"h5",1),o["\u0275\u0275text"](2),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"button",2),o["\u0275\u0275listener"]("click",function(){return t.dismiss()}),o["\u0275\u0275elementStart"](4,"span",3),o["\u0275\u0275text"](5,"\xd7"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](6,"div",4),o["\u0275\u0275elementStart"](7,"form",5,6),o["\u0275\u0275listener"]("ngSubmit",function(){return t.submit()}),o["\u0275\u0275elementStart"](9,"div",7),o["\u0275\u0275elementStart"](10,"label"),o["\u0275\u0275text"](11,"Start Date"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](12,"div",8),o["\u0275\u0275elementStart"](13,"input",9,10),o["\u0275\u0275listener"]("ngModelChange",function(e){return t.startDateModel=e})("click",function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275reference"](14).toggle()}),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](15,"div",11),o["\u0275\u0275elementStart"](16,"span",12),o["\u0275\u0275listener"]("click",function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275reference"](14).toggle()}),o["\u0275\u0275element"](17,"span",13),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](18,"div",7),o["\u0275\u0275elementStart"](19,"label"),o["\u0275\u0275text"](20,"End Date"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](21,"div",8),o["\u0275\u0275elementStart"](22,"input",14,15),o["\u0275\u0275listener"]("ngModelChange",function(e){return t.endDateModel=e})("click",function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275reference"](23).toggle()}),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](24,"div",11),o["\u0275\u0275elementStart"](25,"span",12),o["\u0275\u0275listener"]("click",function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275reference"](23).toggle()}),o["\u0275\u0275element"](26,"span",13),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](27,"div",7),o["\u0275\u0275elementStart"](28,"label",16),o["\u0275\u0275text"](29,"Status"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](30,"select",17),o["\u0275\u0275listener"]("ngModelChange",function(e){return t.stage.companyProgramStageStatusID=e}),o["\u0275\u0275template"](31,g,2,1,"option",18),o["\u0275\u0275template"](32,d,2,1,"option",18),o["\u0275\u0275template"](33,u,2,1,"option",18),o["\u0275\u0275elementStart"](34,"option",19),o["\u0275\u0275text"](35,"Currently Underway"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](36,"option",19),o["\u0275\u0275text"](37,"Successfully Completed"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](38,"option",19),o["\u0275\u0275text"](39,"Exit"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](40,"div",20),o["\u0275\u0275elementStart"](41,"button",21),o["\u0275\u0275text"](42,"Submit "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275reference"](8);o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate1"](" Edit ",t.stage.programStageTitle," "),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("avnonLoader",t.loading),o["\u0275\u0275advance"](7),o["\u0275\u0275classProp"]("no-actions",1===t.stage.programStageTypeID),o["\u0275\u0275property"]("ngModel",t.startDateModel)("readOnly",1===t.stage.programStageTypeID),o["\u0275\u0275advance"](3),o["\u0275\u0275classProp"]("no-actions",1===t.stage.programStageTypeID),o["\u0275\u0275advance"](6),o["\u0275\u0275property"]("ngModel",t.endDateModel),o["\u0275\u0275advance"](8),o["\u0275\u0275property"]("ngModel",t.stage.companyProgramStageStatusID),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",null===t.stage.companyProgramStageStatusID),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",void 0===t.stage.companyProgramStageStatusID),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",0===t.stage.companyProgramStageStatusID),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngValue",2),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngValue",3),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngValue",4),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("disabled",!e.valid||t.loading||0===t.stage.companyProgramStageStatusID)}},directives:[l.a,m.E,m.r,m.s,c.o,m.b,m.A,m.q,m.t,m.B,p.n,m.v,m.D],styles:[".no-actions[_ngcontent-%COMP%]{pointer-events:none}"]}),e})();var I=n("6xY7"),S=n("0mlJ");function D(e,t){if(1&e&&(o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275text"](1),o["\u0275\u0275pipe"](2,"date"),o["\u0275\u0275pipe"](3,"dateObject"),o["\u0275\u0275elementContainerEnd"]()),2&e){const e=o["\u0275\u0275nextContext"](2).$implicit;o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",o["\u0275\u0275pipeBind2"](2,1,o["\u0275\u0275pipeBind1"](3,4,e.companyProgramStageEndDate),"dd MMM yyyy")," ")}}function f(e,t){1&e&&(o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275text"](1," Current "),o["\u0275\u0275elementContainerEnd"]())}function y(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"p",21),o["\u0275\u0275text"](1),o["\u0275\u0275pipe"](2,"date"),o["\u0275\u0275pipe"](3,"dateObject"),o["\u0275\u0275template"](4,D,4,6,"ng-container",22),o["\u0275\u0275template"](5,f,2,0,"ng-container",22),o["\u0275\u0275elementEnd"]()),2&e){const e=o["\u0275\u0275nextContext"]().$implicit;o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",o["\u0275\u0275pipeBind2"](2,3,o["\u0275\u0275pipeBind1"](3,6,e.companyProgramStageStartDate),"dd MMM yyyy")," - "),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("ngIf",e.companyProgramStageEndDate),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",!e.companyProgramStageEndDate)}}function v(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"span",23),o["\u0275\u0275text"](1,"Not Started"),o["\u0275\u0275elementEnd"]())}function b(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"span",24),o["\u0275\u0275text"](1,"Currently Underway"),o["\u0275\u0275elementEnd"]())}function x(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"span",25),o["\u0275\u0275text"](1,"Successfully Completed"),o["\u0275\u0275elementEnd"]())}function E(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"span",26),o["\u0275\u0275text"](1,"Exit"),o["\u0275\u0275elementEnd"]())}function T(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"button",19),o["\u0275\u0275listener"]("click",function(){o["\u0275\u0275restoreView"](e);const t=o["\u0275\u0275nextContext"]().index;return o["\u0275\u0275nextContext"]().deleteStage(t)}),o["\u0275\u0275text"](1," Delete Stage "),o["\u0275\u0275elementEnd"]()}}function C(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"tr"),o["\u0275\u0275elementStart"](1,"td"),o["\u0275\u0275elementStart"](2,"p",9),o["\u0275\u0275text"](3),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](4,y,6,8,"p",10),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](5,"td"),o["\u0275\u0275template"](6,v,2,0,"span",11),o["\u0275\u0275template"](7,b,2,0,"span",12),o["\u0275\u0275template"](8,x,2,0,"span",13),o["\u0275\u0275template"](9,E,2,0,"span",14),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](10,"td"),o["\u0275\u0275elementStart"](11,"div",15),o["\u0275\u0275elementStart"](12,"button",16),o["\u0275\u0275element"](13,"span",17),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](14,"div",18),o["\u0275\u0275elementStart"](15,"button",19),o["\u0275\u0275listener"]("click",function(){o["\u0275\u0275restoreView"](e);const n=t.index;return o["\u0275\u0275nextContext"]().editStage(n)}),o["\u0275\u0275text"](16," Edit Stage "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](17,T,2,0,"button",20),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;o["\u0275\u0275advance"](3),o["\u0275\u0275textInterpolate"](e.programStageTitle),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",e.companyProgramStageStartDate),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngIf",1===e.companyProgramStageStatusID),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",2===e.companyProgramStageStatusID),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",3===e.companyProgramStageStatusID),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",4===e.companyProgramStageStatusID),o["\u0275\u0275advance"](8),o["\u0275\u0275property"]("ngIf",1!==e.programStageTypeID)}}let P=(()=>{class e{constructor(e,t,n){this.activeModal=e,this.modal=t,this.portfolioService=n,this.stages=[],this.programInstanceStages=[],this.removedStages=[]}ngOnInit(){this.getData()}getData(){this.loading=!0,this.portfolioService.getCompanyRoadmapStages(this.applicant.companyID,this.applicant.companyProgramInstanceID,0,this.applicant.programInstanceID).subscribe(e=>{this.stages=e.sort((e,t)=>e.programStageTypeID-t.programStageTypeID),this.loading=!1},()=>this.loading=!1)}editStage(e){const t=this.stages[e],n=this.modal.open(h,{backdrop:"static",size:"lg"});n.componentInstance.stage=Object(r.l)(t),n.result.then(t=>{t&&(this.stages[e]=t)})}deleteStage(e){const t=this.stages[e],n=this.modal.open(a.a);n.componentInstance.objectType="Stage",n.componentInstance.objectDetails=t.programStageTitle+" Stage",n.result.then(n=>{n&&"Yes"===n&&this.portfolioService.deleteStage(t.companyProgramInstanceStageID).subscribe(()=>{this.removedStages.push(t.companyProgramInstanceStageID),this.stages.splice(e,1)})})}moveToNextStage(){const e=this.programInstanceStages.findIndex(e=>e.programInstanceStageID===this.applicant.programInstanceStageID),t=this.programInstanceStages[e],n=this.programInstanceStages[e+1]||null,a=this.modal.open(I.a,{size:"lg",backdrop:"static"});a.componentInstance.programInstanceStages=this.programInstanceStages,a.componentInstance.applicant=this.applicant,a.componentInstance.applicants=[this.applicant],a.componentInstance.currentStage=t,a.componentInstance.nextStage=n,a.componentInstance.stageStatus=3,a.componentInstance.programInstance=this.applicant,a.componentInstance.programInstanceStages=this.programInstanceStages,a.result.then(e=>{if(e&&(e.hasOwnProperty(t)||e.hasOwnProperty("nextStage"))){const n=this.stages.findIndex(e=>e.programInstanceStageID===t.programInstanceStageID);if(this.stages[n].companyProgramStageStatusID=3,this.stages[n].companyProgramStageEndDate=e.currentStage.companyProgramStageEndDate,e&&e.hasOwnProperty("nextStage")){const t=e.nextStage;t.programInstanceStageStatus=null,t.programInstanceStageStatusColor=null,t.programInstanceStageStatusID=0,t.companyID=this.stages[n].companyID,t.contactID=this.stages[n].contactID,t.firstname=this.stages[n].firstname,t.surname=this.stages[n].surname,t.profilePhoto=this.stages[n].profilePhoto,t.companyName=this.stages[n].companyName,t.companyName=this.stages[n].companyName;const a=this.stages.findIndex(e=>e.companyProgramInstanceStageID===t.companyProgramInstanceStageID);-1!==a?this.stages[a]=t:this.stages.push(t)}}})}dismiss(){this.activeModal.close({stages:this.stages,removed:this.removedStages})}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](c.a),o["\u0275\u0275directiveInject"](c.p),o["\u0275\u0275directiveInject"](s.a))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-stage-statuses-modal"]],decls:13,vars:3,consts:[[1,"modal-header"],["id","postModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","d-flex","flex-column",3,"avnonLoader"],[1,"table","table-borderless"],[4,"ngFor","ngForOf"],[1,"actions","d-flex","pr-4"],[1,"cursor-pointer","text-primary",3,"click"],[1,"mb-2","stage-title"],["class","meta m-0",4,"ngIf"],["class","tag tag-alt",4,"ngIf"],["class","tag tag-blue",4,"ngIf"],["class","tag tag-green",4,"ngIf"],["class","tag tag-red",4,"ngIf"],["ngbDropdown","","container","body",1,"ngdropdown","ml-auto","d-inline-block"],["ngbDropdownToggle","","type","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-30"],[1,"ico","dots-ico"],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"click"],["ngbDropdownItem","",3,"click",4,"ngIf"],[1,"meta","m-0"],[4,"ngIf"],[1,"tag","tag-alt"],[1,"tag","tag-blue"],[1,"tag","tag-green"],[1,"tag","tag-red"]],template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"div",0),o["\u0275\u0275elementStart"](1,"h5",1),o["\u0275\u0275text"](2),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"button",2),o["\u0275\u0275listener"]("click",function(){return t.dismiss()}),o["\u0275\u0275elementStart"](4,"span",3),o["\u0275\u0275text"](5,"\xd7"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](6,"div",4),o["\u0275\u0275elementStart"](7,"table",5),o["\u0275\u0275elementStart"](8,"tbody"),o["\u0275\u0275template"](9,C,18,7,"tr",6),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](10,"div",7),o["\u0275\u0275elementStart"](11,"span",8),o["\u0275\u0275listener"]("click",function(){return t.moveToNextStage()}),o["\u0275\u0275text"](12,"Move to new stage"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate1"](" ",t.applicant.companyName," Stages "),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("avnonLoader",t.loading),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("ngForOf",t.stages))},directives:[l.a,p.m,p.n,c.i,c.m,c.k,c.j],pipes:[p.e,S.a],styles:[".stage-toggle[_ngcontent-%COMP%]{padding:0;height:20px;width:20px;background-position:50%}.stage-toggle[_ngcontent-%COMP%]:after, .stage-toggle[_ngcontent-%COMP%]:before{display:none}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px dotted #aaa}.meta[_ngcontent-%COMP%]{font-size:15px}.stage-title[_ngcontent-%COMP%]{font-weight:500}.tag[_ngcontent-%COMP%]{white-space:nowrap}"]}),e})()},t0yg:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var a=n("JZpI"),i=n("fXoL"),r=n("7w9U"),o=n("5eHb"),s=n("1kSV"),c=n("Jn3s"),l=n("3Pt+"),m=n("ofXK");function p(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",7),i["\u0275\u0275element"](1,"img",15),i["\u0275\u0275element"](2,"br"),i["\u0275\u0275elementStart"](3,"p",16),i["\u0275\u0275text"](4),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("src",e.companyLogo,i["\u0275\u0275sanitizeUrl"]),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate1"]("Hi ",e.firstName,",")}}let g=(()=>{class e{constructor(e,t,n){this.emailTemplateService=e,this.toastrService=t,this.activeModal=n,this.emailTemplate=new a.a}ngOnInit(){}onSubmit(){this.loading=!0,this.emailTemplateService.updateEmailTemplate(this.emailTemplate).subscribe(()=>{this.loading=!1,this.activeModal.close(this.emailTemplate)})}dismiss(){this.activeModal.dismiss()}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](r.a),i["\u0275\u0275directiveInject"](o.b),i["\u0275\u0275directiveInject"](s.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-email-template-builder"]],decls:20,vars:6,consts:[[1,"modal-header"],["id","postModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body",3,"avnonLoader"],[1,"w-100","d-flex","flex-column","builder-email",3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","subjectLine"],["type","text","id","subjectLine","name","subjectLine","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","d-flex","flex-column","w-100","border","p-2"],["class","form-group",4,"ngIf"],["name","emailBody","id","emailBody","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","text-right"],[1,"btn","btn-primary",3,"disabled"],["alt","logo",1,"company-logo",3,"src"],[1,"mb-0"]],template:function(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",0),i["\u0275\u0275elementStart"](1,"h5",1),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"button",2),i["\u0275\u0275listener"]("click",function(){return t.dismiss()}),i["\u0275\u0275elementStart"](4,"span",3),i["\u0275\u0275text"](5,"\xd7"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"div",4),i["\u0275\u0275elementStart"](7,"form",5,6),i["\u0275\u0275listener"]("ngSubmit",function(){return t.onSubmit()}),i["\u0275\u0275elementStart"](9,"div",7),i["\u0275\u0275elementStart"](10,"label",8),i["\u0275\u0275text"](11,"Subject Line "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"input",9),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.emailTemplate.subjectLine=e}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](13,"div",10),i["\u0275\u0275template"](14,p,5,2,"div",11),i["\u0275\u0275elementStart"](15,"textarea",12),i["\u0275\u0275listener"]("ngModelChange",function(e){return t.emailTemplate.emailBody=e}),i["\u0275\u0275text"](16,"      "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](17,"div",13),i["\u0275\u0275elementStart"](18,"button",14),i["\u0275\u0275text"](19," Submit "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275reference"](8);i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate1"](" ",t.emailTemplate.emailTemplateTitle," "),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("avnonLoader",t.loading),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngModel",t.emailTemplate.subjectLine),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",t.companyLogo&&t.firstName),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngModel",t.emailTemplate.emailBody),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("disabled",e.invalid)}},directives:[c.a,l.E,l.r,l.s,l.b,l.A,l.q,l.t,m.n],styles:["textarea.form-control[_ngcontent-%COMP%]{min-height:300px}.builder-email[_ngcontent-%COMP%]{max-height:80vh;overflow-x:hidden;overflow-y:auto}.company-logo[_ngcontent-%COMP%]{width:64px;height:64px;object-fit:contain;border-radius:5px;border:1px solid #dfdfdf}"]}),e})()}}]);