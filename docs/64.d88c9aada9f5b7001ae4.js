(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{ZlwT:function(t,e,s){"use strict";s.r(e),s.d(e,"SupportModule",function(){return j});var a=s("ofXK"),n=s("tyNb"),i=s("XNiG"),r=s("cp0P"),o=s("LRne"),c=s("p0ro"),l=s("9122"),d=s("1G5W"),p=s("eIep"),h=s("HNxE"),u=s("8J6U"),m=s("fXoL"),k=s("kmKP"),f=s("ev4g"),I=s("euQB"),D=s("f/iK"),g=s("1kSV"),S=s("VPdJ");const v=[{path:"",component:(()=>{class t{constructor(t,e,s,a,n,r,o,c){this.userService=t,this.taskService=e,this.router=s,this.portfolioService=a,this.permissionService=n,this.location=r,this.activatedRoute=o,this.modal=c,this.tasks=[],this.filteredTasks=[],this.admins=[],this.taskStatus=1,this.destroy$=new i.a,this.user=this.userService.user.getValue(),this.contactID=this.user.contactID,this.companyID=this.user.companyID}ngOnInit(){this.taskID=+this.activatedRoute.snapshot.queryParams.taskID,this.getTasks(),this.getAdmins()}getTasks(){this.loading=!0,Object(r.a)(this.taskService.getTask(0,39,0,this.contactID,0,0,0,0,!0),this.taskService.getTask(0,36,0,this.contactID,0,0,0,0,!0)).pipe(Object(d.a)(this.destroy$)).subscribe(t=>{if(this.tasks=[...t[0],...t[1]].sort((t,e)=>t.lastUpdatePosted&&e.lastUpdatePosted?new Date(e.lastUpdatePosted).getTime()-new Date(t.lastUpdatePosted).getTime():0),this.taskID){const t=this.tasks.find(t=>t.taskID===this.taskID);t&&this.taskService.storeActiveTaskRx(Object(u.l)(t))}this.filterTask(this.taskStatus),this.loading=!1})}addSupportTask(){const t=[],e=window.location.hostname.toLocaleLowerCase();if(e.includes("enviroserv")){const e=new h.a;e.contactID=19359,e.firstName="Neville",e.surname="Moopanar",t.push(e)}else if(e.includes("edgegrowth")){const e=new h.a;e.contactID=13701,e.firstName="Edge Growth",e.surname="Access",t.push(e)}else if(e.includes("qstp")){const e=new h.a;e.contactID=22186,e.firstName="AlJohara",e.surname="AlThani",t.push(e);const s=new h.a;s.contactID=14252,s.firstName="Anthea",s.surname="Fernandes",t.push(s)}else{const e=new h.a;e.contactID=13591,e.firstName="Daniel",e.surname="Avnon",t.push(e)}const s=this.modal.open(c.a);if(s.componentInstance.isGroupDiscussionTask=!0,s.componentInstance.startUpSupport=3===this.user.userGroupID,this.admins.length&&3===this.user.userGroupID)s.componentInstance.contacts=this.admins;else if(3===this.user.userGroupID)s.componentInstance.contacts=t;else{const t=new h.a;t.firstName=this.user.firstName,t.surname=this.user.surname,t.contactID=this.user.contactID,t.profilePhoto=this.user.profilePhoto,s.componentInstance.contacts=[t]}s.result.then(t=>{t.task&&(t.task.taskStatusID=1,t.task.companyName=this.user.companyName,t.task.supporterCompanyName=this.user.companyName,this.tasks.push(t.task),this.filterTask(this.taskStatus))})}getAdmins(){this.checkingPermission=!0,this.portfolioService.getCompanyRoadmapInstance(this.companyID,0,0,0,0,0,this.contactID).pipe(Object(p.a)(t=>t.length?this.permissionService.getPermission(l.b.Programs,t[0].masterCompanyID,0,t[0].masterCompanyID):Object(o.a)([]))).subscribe(t=>{this.admins=t,this.checkingPermission=!1})}filterTask(t=1){this.taskStatus=t,this.filteredTasks=this.tasks.filter(e=>3===t?e.taskStatusID===t:3!==e.taskStatusID)}onTaskDelete(t){const e=this.tasks.findIndex(e=>e.taskID===t);-1!==e&&(this.tasks.splice(e,1),this.filterTask(this.taskStatus))}onTaskUpdate(t){const e=this.tasks.findIndex(e=>e.taskID===t.taskID);-1!==e&&(this.tasks[e]=t,this.filterTask(this.taskStatus))}back(){this.location.back()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.taskService.storeActiveTaskRx(null)}}return t.\u0275fac=function(e){return new(e||t)(m["\u0275\u0275directiveInject"](k.a),m["\u0275\u0275directiveInject"](f.a),m["\u0275\u0275directiveInject"](n.c),m["\u0275\u0275directiveInject"](I.a),m["\u0275\u0275directiveInject"](D.a),m["\u0275\u0275directiveInject"](a.j),m["\u0275\u0275directiveInject"](n.a),m["\u0275\u0275directiveInject"](g.p))},t.\u0275cmp=m["\u0275\u0275defineComponent"]({type:t,selectors:[["app-support"]],decls:19,vars:17,consts:[[1,"d-flex","flex-column","full-height"],[1,"page-title"],[1,"cursor-pointer","text-primary","display-inline","mr-2",3,"click"],[1,"fas","fa-long-arrow-alt-left"],[1,"display-inline"],[1,"filter-container","d-flex","w-100","align-items-center"],[1,"d-flex","align-items-center","ml-4"],[1,"cursor-pointer","mr-2",3,"click"],[1,"cursor-pointer","ml-2",3,"click"],[1,"cursor-pointer","ml-auto",3,"click"],[1,"plus-ico-2"],[3,"tasks","companyID","user","contactID","showStatus","dateLabel","hideCheck","disableAdd","loggedBy","noYear","showDate","showHeader","taskDeleted","taskUpdated"]],template:function(t,e){1&t&&(m["\u0275\u0275elementStart"](0,"div",0),m["\u0275\u0275elementStart"](1,"div",1),m["\u0275\u0275elementStart"](2,"span",2),m["\u0275\u0275listener"]("click",function(){return e.back()}),m["\u0275\u0275element"](3,"i",3),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](4,"h1",4),m["\u0275\u0275text"](5,"Support Requests"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](6,"div",5),m["\u0275\u0275elementStart"](7,"span"),m["\u0275\u0275text"](8),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](9,"div",6),m["\u0275\u0275elementStart"](10,"span",7),m["\u0275\u0275listener"]("click",function(){return e.filterTask(1)}),m["\u0275\u0275text"](11,"Open"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](12," | "),m["\u0275\u0275elementStart"](13,"span",8),m["\u0275\u0275listener"]("click",function(){return e.filterTask(3)}),m["\u0275\u0275text"](14,"Closed"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](15,"a",9),m["\u0275\u0275listener"]("click",function(){return e.addSupportTask()}),m["\u0275\u0275element"](16,"span",10),m["\u0275\u0275text"](17,"Add "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](18,"app-weekly-todo",11),m["\u0275\u0275listener"]("taskDeleted",function(t){return e.onTaskDelete(t)})("taskUpdated",function(t){return e.onTaskUpdate(t)}),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&t&&(m["\u0275\u0275advance"](8),m["\u0275\u0275textInterpolate1"]("",e.filteredTasks.length," request(s)"),m["\u0275\u0275advance"](2),m["\u0275\u0275classProp"]("text-primary",1===e.taskStatus),m["\u0275\u0275advance"](3),m["\u0275\u0275classProp"]("text-primary",3===e.taskStatus),m["\u0275\u0275advance"](5),m["\u0275\u0275property"]("tasks",e.filteredTasks)("companyID",e.companyID)("user",e.user)("contactID",e.contactID)("showStatus",!1)("dateLabel","Date")("hideCheck",!0)("disableAdd",!0)("loggedBy",!0)("noYear",!0)("showDate",!0)("showHeader",!0))},directives:[S.a],styles:[".tag[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{white-space:nowrap}"]}),t})()}];let w=(()=>{class t{}return t.\u0275mod=m["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[n.g.forChild(v)],n.g]}),t})();var y=s("3Pt+"),T=s("zemM"),P=s("j4PG"),b=s("GKkB"),x=s("PCNd");let j=(()=>{class t{}return t.\u0275mod=m["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[a.c,w,y.l,y.z,T.a,g.q,g.l,P.a,b.a,x.a]]}),t})()}}]);