(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"69f4":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("fXoL"),a=n("4gaG"),s=n("ofXK");let r=(()=>{class e{constructor(e,t){this.mobileResponsiveService=e,this.location=t,this.isMobileScreenSize=!1,this.isMobileFilteringOn=!1}ngOnInit(){this.mobileResponsiveService.isMobileScreenSize.subscribe(e=>{this.isMobileScreenSize=e})}back(){this.location.back()}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](a.a),i["\u0275\u0275directiveInject"](s.j))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-mobile-responsive"]],decls:2,vars:0,template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"p"),i["\u0275\u0275text"](1,"mobile-responsive works!"),i["\u0275\u0275elementEnd"]())},styles:[""]}),e})()},AeW6:function(e,t,n){"use strict";n.d(t,"a",function(){return le});var i=n("fXoL"),a=n("XNiG"),s=n("cp0P"),r=n("LRne"),o=n("9122"),c=n("1G5W"),l=n("eIep"),d=n("8J6U"),m=n("3DtY"),p=n("OzGw"),h=n("frau"),u=n("w6ya"),f=n("4CJs"),g=n("ofXK"),v=n("K3/c"),D=n("xJDW"),I=n("XIp8"),y=n("p+bo"),k=n("Wgwc"),b=n("BN3N"),x=n("kmKP"),S=n("6BoG"),w=n("1kSV"),C=n("xDUJ"),O=n("ev4g"),E=n("S2+F"),M=n("9nlD"),P=n("XAmU"),T=n("5eHb"),j=n("k9EJ"),_=n("f/iK"),V=n("tyNb"),F=n("Jn3s"),A=n("VPdJ"),N=n("mFMl"),R=n("w/zQ"),B=n("0mlJ"),L=n("SdWN");function H(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",29),i["\u0275\u0275elementStart"](1,"span",30),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onClose()}),i["\u0275\u0275element"](2,"i",31),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"h1",32),i["\u0275\u0275text"](4," Event "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}}function $(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",33),i["\u0275\u0275elementStart"](1,"div",34),i["\u0275\u0275elementStart"](2,"button",35),i["\u0275\u0275element"](3,"span",36),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"ul",37),i["\u0275\u0275elementStart"](5,"li",38),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onEditEvent()}),i["\u0275\u0275elementStart"](6,"a",39),i["\u0275\u0275text"](7,"Edit"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](8,"li",38),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onDeleteEvent()}),i["\u0275\u0275elementStart"](9,"a",39),i["\u0275\u0275text"](10,"Delete"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}}function U(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"span",11),i["\u0275\u0275element"](1,"i",40),i["\u0275\u0275text"](2),i["\u0275\u0275pipe"](3,"date"),i["\u0275\u0275pipe"](4,"dateObject"),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate1"](" ",i["\u0275\u0275pipeBind2"](3,1,i["\u0275\u0275pipeBind1"](4,4,e.event.startTime),"dd MMM yyyy, HH:mm")," ")}}function W(e,t){if(1&e&&(i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275text"](1),i["\u0275\u0275elementContainerEnd"]()),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",e.event.eventInstructions," ")}}function K(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"a",43),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275property"]("href",e.event.googleURL,i["\u0275\u0275sanitizeUrl"]),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](e.event.venueName)}}function z(e,t){if(1&e&&(i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275text"](1),i["\u0275\u0275elementContainerEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",e.event.venueName," ")}}function q(e,t){if(1&e&&(i["\u0275\u0275template"](0,K,2,2,"a",41),i["\u0275\u0275template"](1,z,2,1,"ng-container",42)),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("ngIf",e.event.googleURL),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!e.event.googleURL)}}function G(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",48),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).confirmPostSession()}),i["\u0275\u0275text"](1," End Session "),i["\u0275\u0275elementEnd"]()}}function Y(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",49),i["\u0275\u0275listener"]("click",function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).navigateToFeedback()}),i["\u0275\u0275text"](1," Pending Feedback "),i["\u0275\u0275elementEnd"]()}}function J(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"span",50),i["\u0275\u0275text"](1,"Session is complete"),i["\u0275\u0275elementEnd"]())}function X(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",44),i["\u0275\u0275template"](1,G,2,0,"button",45),i["\u0275\u0275template"](2,Y,2,0,"button",46),i["\u0275\u0275template"](3,J,2,0,"span",47),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.mentor&&!e.taskOwner),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.taskOwner&&3!==e.taskOwner.taskStatusID),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.taskOwner&&3===e.taskOwner.taskStatusID)}}function Q(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"span",62),i["\u0275\u0275text"](1,"Not Attended"),i["\u0275\u0275elementEnd"]())}function Z(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"span",63),i["\u0275\u0275text"](1,"Attended"),i["\u0275\u0275elementEnd"]())}function ee(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"li",38),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"](2).index;return i["\u0275\u0275nextContext"]().updateDelegateStatus(t,1)}),i["\u0275\u0275elementStart"](1,"a",39),i["\u0275\u0275text"](2,"Mark as not attended"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}}function te(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"li",38),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"](2).index;return i["\u0275\u0275nextContext"]().updateDelegateStatus(t,2)}),i["\u0275\u0275elementStart"](1,"a",39),i["\u0275\u0275text"](2,"Mark as attended"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}}function ne(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",64),i["\u0275\u0275elementStart"](1,"button",65),i["\u0275\u0275element"](2,"span",36),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"ul",66),i["\u0275\u0275template"](4,ee,3,0,"li",67),i["\u0275\u0275template"](5,te,3,0,"li",67),i["\u0275\u0275elementStart"](6,"li",38),i["\u0275\u0275listener"]("click",function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]().index;return i["\u0275\u0275nextContext"]().deleteDelegate(t)}),i["\u0275\u0275elementStart"](7,"a",39),i["\u0275\u0275text"](8,"Delete"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]().$implicit;i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("ngIf",1!==e.eventDelegateStatusID),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",2!==e.eventDelegateStatusID)}}function ie(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",51),i["\u0275\u0275elementStart"](1,"span",52),i["\u0275\u0275element"](2,"img",53),i["\u0275\u0275pipe"](3,"avatar"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"div",54),i["\u0275\u0275elementStart"](5,"h2",55),i["\u0275\u0275text"](6),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](7,"div",56),i["\u0275\u0275elementStart"](8,"span",57),i["\u0275\u0275template"](9,Q,2,0,"span",58),i["\u0275\u0275template"](10,Z,2,0,"span",59),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](11,ne,9,2,"div",60),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"div",61),i["\u0275\u0275elementStart"](13,"span"),i["\u0275\u0275text"](14),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=t.index,a=i["\u0275\u0275nextContext"]();i["\u0275\u0275classProp"]("border-0",a.delegates.length-1===n),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("src",i["\u0275\u0275pipeBind1"](3,10,e.profileImage),i["\u0275\u0275sanitizeUrl"]),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate2"]("",e.firstName," ",e.surname,""),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",1===e.eventDelegateStatusID),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",2===e.eventDelegateStatusID),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.eventAdmin||a.superAdmin),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate2"]("",null==e?null:e.designation," ",null==e?null:e.department,"")}}function ae(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"p",68),i["\u0275\u0275text"](1,"No notes added yet"),i["\u0275\u0275elementEnd"]())}function se(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",69),i["\u0275\u0275elementStart"](1,"app-chat-card",70),i["\u0275\u0275listener"]("editChat",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onEditChatItem(t)})("removeChat",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onDeleteChatItem(t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("isAgenda",!0)("chatItem",e)("members",n.chatMembers)}}function re(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275elementStart"](1,"app-common-chat-add",73),i["\u0275\u0275listener"]("instantPost",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).onInstantAdd(t)})("onChatAdd",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).onChatAdd(t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("members",e.chatMembers)("isAgenda",!0)("delegates",e.event.delegates)("channel",e.channel)("chat",e.activeMessage)("contactId",e.contactID)}}function oe(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"app-common-chat-add",74),i["\u0275\u0275listener"]("instantPost",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).onInstantAdd(t)})("onChatAdd",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).onChatAdd(t)})("onChatEdit",function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2).onChatEdit(t)}),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275property"]("members",e.chatMembers)("editChat",e.editChat)("channel",e.channel)("chat",e.activeMessage)("contactId",e.contactID)("isAgenda",!0)("delegates",e.event.delegates)}}function ce(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",71),i["\u0275\u0275template"](1,re,2,6,"ng-container",13),i["\u0275\u0275template"](2,oe,1,7,"ng-template",null,72,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275reference"](3),t=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!t.editChat)("ngIfElse",e)}}let le=(()=>{class e{constructor(e,t,n,s,r,c,l,d,m,p,h,u){this.userService=e,this.eventService=t,this.modal=n,this.formService=s,this.taskService=r,this.signalRService=c,this.notificationService=l,this.discussionService=d,this.toastrService=m,this.contractService=p,this.permissionService=h,this.router=u,this.closed=new i.EventEmitter,this.updated=new i.EventEmitter,this.deleted=new i.EventEmitter,this.delegates=[],this.discussions=[],this.chatMembers=[],this.typingIndicator=[],this.activeTab=1,this.tasks=[],this.mentorNetworkAdmins=[],this.destroy$=new a.a,this.user=this.userService.user.getValue(),this.contactID=this.user.contactID,this.companyID=this.user.companyID,this.superAdmin=this.user.permissions.some(e=>e.permissionAreaID===o.b.Admin)}set Data(e){this.delegates=[],this.bookingCheck=null,this.event=e,this.eventAdmin=this.event.scheduledbyID===this.contactID,this.loadData(),this.getTask(),this.checkChat(),this.getMeetingTask()}ngOnInit(){}loadData(){this.loading=!0,Object(s.a)(this.eventService.selectEvent(0,this.event.eventID),this.eventService.getEventDelegate(this.event.eventID),this.eventService.getEventDates(this.event.eventID)).pipe(Object(c.a)(this.destroy$)).subscribe(e=>{this.event=e[0][0],this.event.dates=e[2],this.event.dates[0]&&(this.event.startTime=this.event.dates[0].startTime,this.event.startDate=this.event.dates[0].startTime,this.event.endTime=this.event.dates[0].endTime,this.event.endDate=this.event.dates[0].endTime),this.event.delegates=Object(d.l)(e[1]),this.delegates=this.event.delegates.filter(e=>e.eventDelegateTypeID===m.b.MENTEE),this.bookingCheck=this.event.delegates.find(e=>e.contactID===this.contactID),this.mentor=this.event.delegates.find(e=>e.contactID===this.contactID&&e.eventDelegateTypeID===m.b.MENTOR),this.getAssignment(),this.loading=!1,this.initSignalHub()})}getAssignment(){this.menteeLoading=!0,this.contractService.getContractAssignment(0,this.event.referenceID,0,0,0,0,0,0).pipe(Object(l.a)(e=>(this.mentee=e[0],e.length?this.permissionService.getPermission(o.b.Mentor_Network,0,0,e[0].masterCompanyID):Object(r.a)([])))).subscribe(e=>{this.mentorNetworkAdmins=Object(d.j)(e,"contactID"),this.menteeLoading=!1})}getTask(){this.taskLoading=!0,this.taskService.getTask(0,3,this.event.eventID,0,0,0,0,0,!0).subscribe(e=>{this.tasks=e.map(e=>(e.taskOwners=e.taskOwners.map(t=>(t.toDoCanUpdate=e.taskOwners.find(e=>e.contactID===this.contactID),t)),e)),this.taskLoading=!1})}getMeetingTask(){this.feedbackLoading=!0,this.taskService.getTask(0,24,this.event.eventID,0,0,0,0,0,!0).pipe(Object(l.a)(e=>{var t;return e[0]&&(this.taskOwner=e[0].taskOwners.find(e=>e.contactID===this.contactID)),(null===(t=e[0])||void 0===t?void 0:t.taskID)?this.discussionService.fetchDiscussions(0,e[0].taskID,0,0,0,0):Object(r.a)([])})).subscribe(e=>{this.feedbackDiscussion=e[0]||null,this.feedbackLoading=!1})}setActiveTab(e){this.activeTab=e}onEditEvent(){const e=this.modal.open(v.a,{backdrop:"static",size:"md"});e.componentInstance.event=Object(d.l)(this.event),e.result.then(e=>{e&&e.eventID&&(this.event=e,this.updated.emit(this.event))})}onDeleteEvent(){const e=this.modal.open(p.a,{backdrop:"static"});e.componentInstance.objectType="Event",e.result.then(e=>{"Yes"===e&&this.eventService.deleteEvent(this.event.eventID).subscribe(()=>{this.deleted.emit(this.event),this.onClose()})})}sendInvite(){const e=this.modal.open(h.a,{size:"lg"});e.componentInstance.selectedContacts=Object(d.l)(this.delegates),e.componentInstance.companyID=this.user.companyID,e.componentInstance.allowNewContact=!0,e.componentInstance.isDelegateInvite=!0,e.componentInstance.emailValidationOn=!1,e.result.then(e=>{e.length&&this.handleDelegateInvites(e,5)})}handleDelegateInvites(e,t){this.delegates.filter(t=>!e.some(e=>e.contactID===t.contactID)).forEach(e=>{this.eventService.deleteEventDelegate(e.eventDelegateID).subscribe(()=>{this.delegates=this.delegates.filter(t=>t.eventDelegateID!==e.eventDelegateID)})}),e.filter(e=>!this.delegates.filter(t=>t.contactID===e.contactID).length).forEach(e=>{this.insertNewDelegate(e,t)})}insertNewDelegate(e,t){this.eventService.insertEventDelegate({eventID:this.event.eventID,contactID:e.contactID,addedByID:this.user.contactID,assessmentScore:0,contractNumber:"",eventDelegateTypeID:t,eventDelegateStatusID:1,setaID:0,endDate:"",startDate:"",projectedEndDate:""}).subscribe(t=>{t.eventDelegateID=t.inOut_EventDelegateID,t.firstName=e.firstName,t.surname=e.surname,t.profileImage=(null==e?void 0:e.profileImage)||(null==e?void 0:e.profilePhoto),t.eventDelegateStatusID=1,t.confirmed=0,this.delegates.push(t)})}updateDelegateStatus(e,t){const n=this.delegates[e];n.eventDelegateStatusID=t,this.eventService.updateEventDelegate(n).subscribe()}deleteDelegate(e){const t=this.modal.open(p.a);t.componentInstance.objectType="Delegate",t.componentInstance.objectDetails=this.delegates[e].firstName,t.result.then(t=>{t&&"Yes"===t&&this.eventService.deleteEventDelegate(this.delegates[e].eventDelegateID).subscribe(()=>{this.delegates.splice(e,1)})})}massStatusUpdate(e){this.delegates.forEach(t=>{t.eventDelegateStatusID=e,this.eventService.updateEventDelegate(t).subscribe()})}sortDelegates(){this.delegates=this.delegates.sort(this.sort?(e,t)=>e.eventDelegateStatusID>t.eventDelegateStatusID?1:-1:(e,t)=>e.eventDelegateStatusID<t.eventDelegateStatusID?1:-1),this.sort=!this.sort}notifyDelegate(e){const t=Object(d.a)(new Date),n=`You've been selected as a presenter at ${this.event.eventTitle} on ${e.delegateStartDate}`,i={notificationCategoryID:u.a.event_invite_event_deligate,referenceID:this.event.eventID,contactID:e.contactID,description:n,createdContact:this.contactID},a=t+"|"+this.event.eventID,s={date:t,body:n,topic:n,senderFullName:"",senderPhoto:"",notificationId:Math.floor(1e3*Math.random()),channel:"dashboard",reference:i.referenceID,notificationType:f.a.eventRequest,senderId:i.createdContact,receivers:[i.contactID],uniqueId:a,discussionId:0};this.notificationService.noticeNotification(i).subscribe(()=>{this.signalRService.transferMessage("dashboard",s)})}onAcceptInvite(){this.updateEventDelegateStatus(2)}onDeclineInvite(){this.updateEventDelegateStatus(3)}updateEventDelegateStatus(e){this.bookingCheck.eventDelegateStatusID=e;const t={eventDelegateID:this.bookingCheck.eventDelegateID,confirmed:0,assessmentScore:0,assessmentResultID:0,eventDelegateStatusID:e,eventDelegateStatusDate:Object(g.y)(new Date,"yyyy-MM-dd HH:mm:ss","en-UK"),endDate:this.bookingCheck.delegateEndDate,projectedEndDate:"",startDate:this.bookingCheck.delegateStartDate};this.eventService.updateEventDelegate(t).subscribe(()=>{this.toastrService.success("You're now "+(2===e?"accepted ":"declined ")+this.event.eventTitle),this.bookingCheck.eventDelegateStatusID=t.eventDelegateStatusID,this.noticeNotification(2===e?8:7,this.event.eventID,this.event.scheduledbyID)})}noticeNotification(e,t,n){const i=this.user.firstName,a=this.user.surname,s=new Date,r=Object(g.y)(s,"yyyy-MM-dd HH:mm:ss","en-UK"),o=`${i} ${a} has ${8===e?"accepted":"declined"} invitation to "${this.event.eventTitle}" event`,c={notificationCategoryID:e,referenceID:t,contactID:n,description:o,createdContact:this.contactID},l=r+"|"+this.event.eventID,d={date:r,body:o,topic:o,senderFullName:"",senderPhoto:"",notificationId:Math.floor(1e3*Math.random()),channel:"dashboard",reference:c.referenceID,notificationType:f.a.eventRequest,senderId:c.createdContact,receivers:[c.contactID],uniqueId:l,discussionId:0};this.notificationService.noticeNotification(c).subscribe(()=>{this.signalRService.transferMessage("dashboard",d)})}checkChat(){this.discussionService.fetchDiscussions(0,this.event.eventID,2,0,0).subscribe(e=>{e[0]&&(this.activeMessage=e[0],this.channel="chat"+this.activeMessage.discussionID,this.signalRService.joinChannel(this.channel),this.getMember(this.activeMessage.discussionID),this.getChats(this.activeMessage.discussionID))})}getMember(e){this.chatMembers=[],this.discussionService.getAllMembers(e).subscribe(t=>{this.chatMembers=t,this.chatMembers.filter(e=>e.contactID===this.contactID).length||this.discussionService.addMember({contactID:this.contactID,discussionID:e,isAdmin:!1}).subscribe(()=>{this.getMember(e)})})}initSignalHub(){this.signalRService.transferMessageEvent.subscribe(e=>{if(this.channel===e.channel){const t=e.message,n=t.data;if(t.type===D.a.chatAdd&&this.onChatAdd(n),t.type===D.a.chatDelete&&this.onDeleteChat(n.discussionID),t.type===D.a.chatEdit&&this.onChatEdit(n),e.message&&e.message.hasOwnProperty("newDiscussionID")&&this.getReplyChat(e.message.newDiscussionID),t.type===D.a.typingIndicator){const e=t.data,n=this.typingIndicator.findIndex(t=>t.id===e.id);-1!==n?e.typing||this.typingIndicator.splice(n,1):e.typing&&this.typingIndicator.push(e)}}})}onChatAdd(e){const t=this.discussions.length-1;e.isSameTime=t>=0&&Object(d.b)(this.discussions[t],e),e.isSameDate=t>=0&&Object(d.f)(this.discussions[t],e),this.discussions.push(e)}onChatEdit(e){if(!e)return void(this.editChat=null);const t=this.discussions.findIndex(t=>t.discussionID===e.discussionID);if(-1!==t){const n=this.discussions.length-1;e.isSameTime=n>=0&&Object(d.b)(this.discussions[n],e),e.isSameDate=n>=0&&Object(d.f)(this.discussions[n],e),this.discussions[t]=Object(I.a)(e)}this.editChat=null}onInstantAdd(e){const t=this.discussions.findIndex(t=>t.tempKey===e.tempKey);-1!==t&&(this.discussions[t].discussionID=e.discussionID)}leaveChannel(){this.signalRService.leaveChannel(this.channel)}getChats(e){this.loading=!0,this.discussionService.fetchDiscussions(0,0,0,e,0).subscribe(e=>{(e=e.reverse()).map((t,n)=>(t.isSameTime=n>0&&Object(d.b)(e[n-1],t),t.isSameDate=n>0&&Object(d.f)(e[n-1],t),t)),e[0]&&(e[0].visible=!0),this.discussions=e,this.loading=!1})}onEditChatItem(e){this.editChat=e}onDeleteChatItem(e){this.discussionService.deleteDiscussion(e).subscribe(()=>{this.onDeleteChat(e),this.signalRService.transferMessage(this.channel,{type:D.a.chatDelete,data:{discussionID:e}})})}onDeleteChat(e){var t;const n=null===(t=this.discussions)||void 0===t?void 0:t.findIndex(t=>t.discussionID===e);-1!==n&&this.discussions.splice(n,1)}getReplyChat(e){this.discussionService.fetchDiscussions(0,this.activeMessage.referenceID,40,this.activeMessage.discussionID,e).subscribe(e=>{e[0]&&this.onChatAdd(e[0])})}onClose(){this.closed.emit(!0)}confirmPostSession(){if(this.taskOwner)return;const e=this.modal.open(p.a);e.componentInstance.objectType="Confirm Session Ending",e.componentInstance.objectDetails="Would you like to submit your post session feedback now?",e.componentInstance.customConfirm=!0,e.result.then(e=>{e&&"Yes"===e&&this.sendMentorFeedback()})}sendMentorFeedback(){this.loading=!0;const e=Object(d.l)(this.event.delegates),t={taskTitle:`Mentoring Review: ${this.mentee.companyName} and ${this.mentee.assigneeFirstName} ${this.mentee.assigneeSurname}`,taskDescription:"",endDate:Object(d.a)(new Date),taskValue:0,taskCategoryID:24,referenceID:this.event.eventID,autoSignOff:!0,taskModeID:0,submittedBy:this.event.scheduledbyID,parentTaskID:0,url:"",documentFolderID:0,taskReason:"",taskSignOffCondition:"",taskClassificationID:0,taskTypeID:0,formID:0};let n;this.taskService.addTask(t).pipe(Object(l.a)(t=>{t.taskID=t.inOut_TaskID,n=t.taskID;const i=[];return e.forEach(e=>{const n=new y.a;n.taskID=t.taskID,n.contactID=e.contactID,n.taskOwnerCategoryID=e.eventDelegateTypeID===m.b.MENTOR?23:24,n.referenceID=e.eventDelegateID,i.push(this.taskService.addTaskOwner(n))}),Object(s.a)(i)})).subscribe(e=>{this.notifyMentor(n,e),this.taskOwner=e.find(e=>e.contactID===this.contactID)})}notifyMentor(e,t){let n=0;this.discussionService.insertDiscussion({discussionTopic:`Mentoring Review: ${this.mentee.companyName} and ${this.mentee.assigneeFirstName} ${this.mentee.assigneeSurname}`,discussionCategoryID:124,isDirectMessage:!0,discussionCreatedByContactID:this.contactID,discussionBody:"Please complete form below",referenceID:e,discussionValue:0}).pipe(Object(l.a)(e=>{e.discussionID=e.inOut_DiscussionID,this.feedbackDiscussion=e,n=e.inOut_DiscussionID;const i=[];if(t.forEach(t=>{var n;const a={discussionID:e.discussionID,contactID:t.contactID,isAdmin:!0,discussionMemberTypeID:this.mentorNetworkAdmins.some(e=>e.contactID===t.contactID)||(null===(n=this.mentee)||void 0===n?void 0:n.assignedByID)===this.contactID?1:0};i.push(this.discussionService.addMember(a))}),this.mentorNetworkAdmins.forEach(n=>{if(!t.some(e=>e.contactID===n.contactID)){const a={discussionID:e.discussionID,contactID:n.contactID,isAdmin:!0,discussionMemberTypeID:1};t.push(n),i.push(this.discussionService.addMember(a))}}),!this.mentorNetworkAdmins.length&&!t.some(e=>{var t;return e.contactID===(null===(t=this.mentee)||void 0===t?void 0:t.assignedByID)})){const n={discussionID:e.discussionID,contactID:this.mentee.assignedByID,isAdmin:!0,discussionMemberTypeID:1};t.push({contactID:this.mentee.assignedByID}),i.push(this.discussionService.addMember(n))}return Object(s.a)(i)})).subscribe(()=>{const e={date:k().format(b.c),body:`Mentoring Review: ${this.mentee.companyName} and ${this.mentee.assigneeFirstName} ${this.mentee.assigneeSurname}`,topic:`Mentoring Review: ${this.mentee.companyName} and ${this.mentee.assigneeFirstName} ${this.mentee.assigneeSurname}`,senderFullName:this.user.firstName+" "+this.user.surname,channel:"dashboard",reference:n,notificationType:f.a.discussionNotification,senderId:this.companyID,receivers:t.map(e=>e.contactID)};this.signalRService.transferMessage("dashboard",e),this.toastrService.success("Session is completed"),this.loading=!1})}navigateToFeedback(){this.router.navigate(["/home"],{queryParams:{discussionID:this.feedbackDiscussion.discussionID}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.leaveChannel()}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](x.a),i["\u0275\u0275directiveInject"](S.a),i["\u0275\u0275directiveInject"](w.p),i["\u0275\u0275directiveInject"](C.a),i["\u0275\u0275directiveInject"](O.a),i["\u0275\u0275directiveInject"](E.a),i["\u0275\u0275directiveInject"](M.a),i["\u0275\u0275directiveInject"](P.a),i["\u0275\u0275directiveInject"](T.b),i["\u0275\u0275directiveInject"](j.a),i["\u0275\u0275directiveInject"](_.a),i["\u0275\u0275directiveInject"](V.c))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["app-event-minutes-rhp"]],inputs:{fullScreen:"fullScreen",nonFullScreen:"nonFullScreen",Data:["activeEvent","Data"]},outputs:{closed:"closed",updated:"updated",deleted:"deleted"},decls:39,vars:27,consts:[[1,"d-flex"],[1,"d-flex","flex-column","task-right-panel"],[1,"d-flex","flex-column","min-full-height",3,"avnonLoader"],["class","page-title d-flex",4,"ngIf"],[1,"page-header","d-flex","flex-column","pb-3"],[1,"profile-overview","w-100"],[1,"d-flex","w-100"],["class","actions ml-auto mt-0 ml-2",4,"ngIf"],[1,"d-flex","align-items-center"],[1,"icon-list","w-auto"],["class","text-muted other mt-2 mr-4",4,"ngIf"],[1,"text-muted","other","mt-2","mr-4"],[1,"fas","fa-map-marker-alt"],[4,"ngIf","ngIfElse"],["elseInPerson",""],["class","pl-3 pr-3 ml-auto",4,"ngIf"],[1,"d-flex","flex-column","w-100","mb-4"],[1,"col-12","d-flex","pl-3","pr-3","mt-2","justify-content-between","align-items-center","filter-container","border-bottom"],["class","entry",3,"border-0",4,"ngFor","ngForOf"],[1,"p-0","w-100","d-flex","flex-column"],[1,"col-12","d-flex","pl-3","pr-3","mt-2","justify-content-between","align-items-center","filter-container"],[1,"m-0"],[1,"d-flex","flex-column","flex-grow-1","pl-3","pr-3"],["class","meta no-notes",4,"ngIf"],["class","group-item",4,"ngFor","ngForOf"],["class","d-flex w-100 mt-2",4,"ngIf"],[1,"d-flex","pt-4","pb-3","pl-3","pf-3"],[1,"mb-0"],[1,"w-100",3,"tasks","contactID","user","showHeader","showDate","hideCheck","delegates","referenceID","placeholder","showStatus"],[1,"page-title","d-flex"],[1,"cursor-pointer","text-primary","display-inline","mr-2",3,"click"],[1,"fas","fa-long-arrow-alt-left"],[1,"display-inline","mb-0","mr-2"],[1,"actions","ml-auto","mt-0","ml-2"],[1,"dropdown"],["type","button","id","d","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-30"],[1,"ico","dots-ico"],["aria-labelledby","d",1,"dropdown-menu"],[3,"click"],[1,"dropdown-item"],[1,"fas","fa-clock"],["class","meta-alt","target","_blank",3,"href",4,"ngIf"],[4,"ngIf"],["target","_blank",1,"meta-alt",3,"href"],[1,"pl-3","pr-3","ml-auto"],["class","btn default-action-btn btn-sm",3,"click",4,"ngIf"],["class","btn-sm btn-warning",3,"click",4,"ngIf"],["class","tag tag-green",4,"ngIf"],[1,"btn","default-action-btn","btn-sm",3,"click"],[1,"btn-sm","btn-warning",3,"click"],[1,"tag","tag-green"],[1,"entry"],[1,"media","avatar","avatar-40","avatar-40-rounded"],["alt","Avatar",1,"img-fluid","img-40","cover",3,"src"],[1,"d-flex","justify-content-between"],[1,"font-weight-normal"],[1,"d-flex","align-items-center","actions"],[1,"meta","mr-2"],["class","tag tag-orange mr-auto",4,"ngIf"],["class","tag tag-green mr-auto",4,"ngIf"],["class","dropdown ml-auto",4,"ngIf"],[1,"meta"],[1,"tag","tag-orange","mr-auto"],[1,"tag","tag-green","mr-auto"],[1,"dropdown","ml-auto"],["type","button","id","dd1","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-30"],["aria-labelledby","dd1",1,"dropdown-menu","dropdown-menu-end"],[3,"click",4,"ngIf"],[1,"meta","no-notes"],[1,"group-item"],[3,"isAgenda","chatItem","members","editChat","removeChat"],[1,"d-flex","w-100","mt-2"],["elseEditChat",""],[1,"w-100",3,"members","isAgenda","delegates","channel","chat","contactId","instantPost","onChatAdd"],[1,"w-100",3,"members","editChat","channel","chat","contactId","isAgenda","delegates","instantPost","onChatAdd","onChatEdit"]],template:function(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",0),i["\u0275\u0275elementStart"](1,"div",1),i["\u0275\u0275elementStart"](2,"div",2),i["\u0275\u0275template"](3,H,5,0,"div",3),i["\u0275\u0275elementStart"](4,"div",4),i["\u0275\u0275elementStart"](5,"div",5),i["\u0275\u0275elementStart"](6,"div",6),i["\u0275\u0275elementStart"](7,"h2"),i["\u0275\u0275text"](8),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](9,$,11,0,"div",7),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](10,"p"),i["\u0275\u0275text"](11),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"div",8),i["\u0275\u0275elementStart"](13,"div",9),i["\u0275\u0275template"](14,U,5,6,"span",10),i["\u0275\u0275elementStart"](15,"span",11),i["\u0275\u0275element"](16,"i",12),i["\u0275\u0275template"](17,W,2,1,"ng-container",13),i["\u0275\u0275template"](18,q,2,2,"ng-template",null,14,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](20,X,4,3,"div",15),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](21,"div",16),i["\u0275\u0275elementStart"](22,"div",17),i["\u0275\u0275elementStart"](23,"h3"),i["\u0275\u0275text"](24,"Attendees"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](25,ie,15,12,"div",18),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](26,"div",19),i["\u0275\u0275elementStart"](27,"div",20),i["\u0275\u0275elementStart"](28,"h3",21),i["\u0275\u0275text"](29,"Points of discussion"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](30,"div",22),i["\u0275\u0275template"](31,ae,2,0,"p",23),i["\u0275\u0275template"](32,se,2,3,"div",24),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](33,ce,4,2,"div",25),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](34,"div",26),i["\u0275\u0275elementStart"](35,"h3",27),i["\u0275\u0275text"](36,"Activities"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](37,"div",6),i["\u0275\u0275element"](38,"app-weekly-todo",28),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275reference"](19);i["\u0275\u0275classProp"]("overlay-fullscreen",t.fullScreen),i["\u0275\u0275advance"](1),i["\u0275\u0275classProp"]("none-full",t.nonFullScreen),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("avnonLoader",t.loading||t.feedbackLoading||t.taskLoading||t.menteeLoading),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!t.nonFullScreen),i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate"](null==t.event?null:t.event.eventTitle),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",t.eventAdmin||t.superAdmin),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](t.event.eventPitch),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",t.event.startTime),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",2===t.event.eventFormatID)("ngIfElse",e),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",t.taskOwner||t.mentor),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngForOf",t.delegates),i["\u0275\u0275advance"](6),i["\u0275\u0275property"]("ngIf",!t.discussions.length),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",t.discussions),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",t.activeMessage),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("tasks",t.tasks)("contactID",t.contactID)("user",t.user)("showHeader",!0)("showDate",!0)("hideCheck",!0)("delegates",t.delegates)("referenceID",t.event.eventID)("placeholder","Type and press enter")("showStatus",!1)}},directives:[F.a,g.n,g.m,A.a,N.a,R.a],pipes:[g.e,B.a,L.a],styles:[".filter-applicants[_ngcontent-%COMP%]{flex-wrap:wrap}.filter-applicants[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{position:relative;border:1px solid #c8c8c8;margin-bottom:10px}.filter-applicants[_ngcontent-%COMP%]   .btn.active[_ngcontent-%COMP%]{border:1px solid #406fe4!important;color:#406fe4}.filter-applicants[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#406fe4!important}  ngb-timepicker .form-control{border-left:none;border-right:none;border-top:none;box-shadow:none;border-radius:0;outline:none}  ngb-timepicker .form-control:focus{box-shadow:none}.overlay-fullscreen[_ngcontent-%COMP%]{top:0;left:0;position:fixed;z-index:1022;width:100%;height:100vh;background:rgba(0,0,0,.5)}.overlay-fullscreen[_ngcontent-%COMP%]   .task-right-panel[_ngcontent-%COMP%]{right:0!important;min-height:calc(100vh - 14px);max-height:calc(100vh - 14px);height:100%;top:7px}@media (max-width:1500px){.overlay-fullscreen[_ngcontent-%COMP%]   .task-right-panel[_ngcontent-%COMP%]{width:calc(100% - 594px)}}.none-full[_ngcontent-%COMP%]{top:0!important;right:0;width:100%;left:0;bottom:0}.default-action-btn[_ngcontent-%COMP%]{color:#c26555;background:none;border:1px solid #c26555}.default-action-btn[_ngcontent-%COMP%]:focus, .default-action-btn[_ngcontent-%COMP%]:hover{background:#d9d9d9;border:1px solid #d9d9d9;outline:none;box-shadow:none}.default-action-btn[_ngcontent-%COMP%]:disabled{opacity:.9}"]}),e})()},Ws3k:function(e,t,n){"use strict";n.r(t),n.d(t,"PlannerModule",function(){return nt});var i=n("ofXK"),a=n("tyNb"),s=n("fXoL");let r=(()=>{class e{constructor(e){this.location=e}ngOnInit(){}back(){this.location.back()}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](i.j))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-weekly-plan-preview"]],decls:1,vars:0,template:function(e,t){1&e&&s["\u0275\u0275element"](0,"router-outlet")},directives:[a.h],styles:[".planner-content[_ngcontent-%COMP%]{margin-top:55px;min-height:calc(100vh - 55px);max-width:calc(100% - 200px);flex:0 0 100%}.weekly-menu-tab[_ngcontent-%COMP%]{z-index:2;background:#fff;display:flex;align-items:flex-end;height:50px;position:sticky;top:52px;max-width:600px;border-left:1px solid #dfdfdf;border-right:1px solid #dfdfdf}"]}),e})();var o=n("XNiG"),c=n("cp0P"),l=n("8J6U"),d=n("Q4ZP"),m=n("9122"),p=n("69f4"),h=n("Wgwc"),u=n("XIp8"),f=n("1G5W"),g=n("1kSV"),v=n("ev4g"),D=n("6BoG"),I=n("kmKP"),y=n("4gaG"),k=n("Jn3s"),b=n("3Pt+"),x=n("VPdJ"),S=n("CXZW"),w=n("oTus"),C=n("AeW6"),O=n("sYmb"),E=n("0mlJ");const M=["selectContainer"],P=["weeklySelectContainer"],T=["datepicker"];function j(e,t){1&e&&(s["\u0275\u0275elementContainerStart"](0),s["\u0275\u0275text"](1," Today "),s["\u0275\u0275elementContainerEnd"]())}function _(e,t){if(1&e&&(s["\u0275\u0275elementContainerStart"](0),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"date"),s["\u0275\u0275pipe"](3,"dateObject"),s["\u0275\u0275elementContainerEnd"]()),2&e){const e=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind2"](2,1,s["\u0275\u0275pipeBind1"](3,4,e.dayViewDate),"dd MMM yyyy")," ")}}function V(e,t){if(1&e&&(s["\u0275\u0275elementContainerStart"](0),s["\u0275\u0275template"](1,j,2,0,"ng-container",16),s["\u0275\u0275template"](2,_,4,6,"ng-container",16),s["\u0275\u0275elementContainerEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",e.isToday),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!e.isToday)}}function F(e,t){if(1&e&&(s["\u0275\u0275elementContainerStart"](0),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"date"),s["\u0275\u0275pipe"](3,"dateObject"),s["\u0275\u0275pipe"](4,"date"),s["\u0275\u0275pipe"](5,"dateObject"),s["\u0275\u0275elementContainerEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate2"](" ",s["\u0275\u0275pipeBind2"](2,2,s["\u0275\u0275pipeBind1"](3,5,e.startOfTheWeek),"dd MMM")," - ",s["\u0275\u0275pipeBind2"](4,7,s["\u0275\u0275pipeBind1"](5,10,e.endOfTheWeek),"dd MMM yyyy")," ")}}function A(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"a",27),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().addEvent()}),s["\u0275\u0275text"](1,"Add Event"),s["\u0275\u0275elementEnd"]()}}function N(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"a",40),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](2).addEvent()}),s["\u0275\u0275text"](1,"Add Event"),s["\u0275\u0275elementEnd"]()}}function R(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td",41),s["\u0275\u0275elementStart"](2,"div",42),s["\u0275\u0275elementStart"](3,"h3",43),s["\u0275\u0275text"](4),s["\u0275\u0275pipe"](5,"date"),s["\u0275\u0275pipe"](6,"dateObject"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"td",44),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"](2).triggerEventAdd(n)}),s["\u0275\u0275elementStart"](8,"span",45),s["\u0275\u0275text"](9,"Schedule a meeting"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,i=s["\u0275\u0275nextContext"](2);s["\u0275\u0275classProp"]("mouseOver",i.mouseOver===n),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind2"](5,3,s["\u0275\u0275pipeBind1"](6,6,e.date),"HH:mm"))}}function B(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",46),s["\u0275\u0275listener"]("mouseleave",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](2).mouseOver=null})("mouseover",function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"](2).mouseOver=n}),s["\u0275\u0275elementEnd"]()}2&e&&s["\u0275\u0275property"]("dtsSelectItem",t.$implicit)}function L(e,t){if(1&e&&(s["\u0275\u0275elementContainerStart"](0),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"date"),s["\u0275\u0275pipe"](3,"dateObject"),s["\u0275\u0275pipe"](4,"date"),s["\u0275\u0275pipe"](5,"dateObject"),s["\u0275\u0275elementContainerEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate2"](" ",s["\u0275\u0275pipeBind2"](2,2,s["\u0275\u0275pipeBind1"](3,5,e.startTime),"HH:mm")," - ",s["\u0275\u0275pipeBind2"](4,7,s["\u0275\u0275pipeBind1"](5,10,e.endTime),"HH:mm")," ")}}const H=function(e,t,n){return{"top.px":e,"left.px":t,"height.px":n}};function $(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",47),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"](2).navigateToEvent(n)}),s["\u0275\u0275elementStart"](1,"h3",31),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](3,L,6,12,"ng-container",16),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;s["\u0275\u0275classProp"]("w-100",e.fullWidth),s["\u0275\u0275property"]("ngStyle",s["\u0275\u0275pureFunction3"](5,H,0===e.offsetTop?10:35*e.offsetTop+15,(0===e.offsetLeft?0:200*e.offsetLeft)+10*e.offsetLeft,35*(e.offsetHeight-e.offsetTop>0?e.offsetHeight-e.offsetTop:1)-15)),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",e.eventTitle," "),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",e.startTime&&e.endTime)}}function U(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementContainerStart"](0),s["\u0275\u0275elementStart"](1,"div",28),s["\u0275\u0275elementStart"](2,"app-weekly-todo",29),s["\u0275\u0275listener"]("taskUpdated",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().onTaskUpdate(t)})("taskDeleted",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().onTaskDelete(t)}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"div",30),s["\u0275\u0275elementStart"](4,"h1",31),s["\u0275\u0275text"](5,"Schedule"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](6,N,2,0,"a",32),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"dts-select-container",33,34),s["\u0275\u0275listener"]("selectionEnded",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().onSelectEnded(t)}),s["\u0275\u0275elementStart"](9,"table",35),s["\u0275\u0275template"](10,R,10,8,"tr",36),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"div",37),s["\u0275\u0275template"](12,B,1,1,"div",38),s["\u0275\u0275template"](13,$,4,9,"div",39),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("contactID",e.contactID)("user",e.user)("companyID",e.companyID)("tasks",e.tasks)("startDate",e.dayViewDate),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngIf",e.superAdmin||e.trainingCoordinator),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngForOf",e.daySchedule),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",e.daySchedule),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",e.filteredEvents)}}function W(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",57),s["\u0275\u0275elementStart"](1,"div",58),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"](2).onWeeklyClick(n)}),s["\u0275\u0275elementStart"](2,"h3",31),s["\u0275\u0275text"](3),s["\u0275\u0275pipe"](4,"date"),s["\u0275\u0275pipe"](5,"dateObject"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"span",59),s["\u0275\u0275text"](7),s["\u0275\u0275pipe"](8,"date"),s["\u0275\u0275pipe"](9,"dateObject"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](10,"div",60),s["\u0275\u0275elementStart"](11,"app-weekly-todo",61),s["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,i=s["\u0275\u0275nextContext"](2);s["\u0275\u0275classProp"]("border-left",0===n),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind2"](4,13,s["\u0275\u0275pipeBind1"](5,16,e.date),"EEEE")),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind2"](8,18,s["\u0275\u0275pipeBind1"](9,21,e.date),"dd MMM")),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("contactID",i.contactID)("companyID",i.companyID)("user",i.user)("hideAddBorder",!0)("weekTodo",!0)("limitEnabled",!0)("limit",!0)("tasks",e.tasks)("startDate",e.date)}}function K(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"tr",62),s["\u0275\u0275listener"]("mouseleave",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](2).mouseOver=null})("mouseover",function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"](2).mouseOver=n}),s["\u0275\u0275elementStart"](1,"td",41),s["\u0275\u0275elementStart"](2,"div",63),s["\u0275\u0275elementStart"](3,"h3",43),s["\u0275\u0275text"](4),s["\u0275\u0275pipe"](5,"date"),s["\u0275\u0275pipe"](6,"dateObject"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,i=s["\u0275\u0275nextContext"](2);s["\u0275\u0275classProp"]("mouseOver",i.mouseOver===n),s["\u0275\u0275advance"](4),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind2"](5,3,s["\u0275\u0275pipeBind1"](6,6,e.date),"HH:mm"))}}function z(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td",68),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.index,i=s["\u0275\u0275nextContext"]().index;return s["\u0275\u0275nextContext"](2).triggerEventAdd(n,!0,i)}),s["\u0275\u0275elementStart"](2,"span",45),s["\u0275\u0275text"](3,"Schedule a meeting"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.index,n=s["\u0275\u0275nextContext"]().index,i=s["\u0275\u0275nextContext"](2);s["\u0275\u0275classProp"]("mouseOver",i.hovers[n]===e)}}const q=function(e,t){return{hourDate:e,date:t}};function G(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",46),s["\u0275\u0275listener"]("mouseleave",function(){s["\u0275\u0275restoreView"](e);const t=s["\u0275\u0275nextContext"]().index;return s["\u0275\u0275nextContext"](2).hovers[t]=null})("mouseover",function(){s["\u0275\u0275restoreView"](e);const n=t.index,i=s["\u0275\u0275nextContext"]().index;return s["\u0275\u0275nextContext"](2).hovers[i]=n}),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275property"]("dtsSelectItem",s["\u0275\u0275pureFunction2"](1,q,e.date,n.date))}}function Y(e,t){if(1&e&&(s["\u0275\u0275elementContainerStart"](0),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"date"),s["\u0275\u0275pipe"](3,"dateObject"),s["\u0275\u0275pipe"](4,"date"),s["\u0275\u0275pipe"](5,"dateObject"),s["\u0275\u0275elementContainerEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate2"](" ",s["\u0275\u0275pipeBind2"](2,2,s["\u0275\u0275pipeBind1"](3,5,e.startTime),"HH:mm")," - ",s["\u0275\u0275pipeBind2"](4,7,s["\u0275\u0275pipeBind1"](5,10,e.endTime),"HH:mm")," ")}}function J(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",69),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"](3).navigateToEvent(n)}),s["\u0275\u0275elementStart"](1,"h3",31),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](3,Y,6,12,"ng-container",16),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index;s["\u0275\u0275classProp"]("w-100",e.fullWidth),s["\u0275\u0275property"]("dtsSelectItem",e)("ngStyle",s["\u0275\u0275pureFunction3"](6,H,0===e.offsetTop?10:45*e.offsetTop+15,0===n?0:20*n,45*(e.offsetHeight-e.offsetTop>0?e.offsetHeight-e.offsetTop:1)-15)),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",e.eventTitle," "),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",e.startTime&&e.endTime)}}function X(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",57),s["\u0275\u0275elementStart"](1,"div",64),s["\u0275\u0275elementStart"](2,"table",65),s["\u0275\u0275template"](3,z,4,2,"tr",36),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"div",66),s["\u0275\u0275template"](5,G,1,4,"div",38),s["\u0275\u0275template"](6,J,4,10,"div",67),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",n.daySchedule),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",n.daySchedule),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",e.events)}}function Q(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",48),s["\u0275\u0275elementStart"](1,"div",49),s["\u0275\u0275template"](2,W,12,23,"div",50),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"dts-select-container",51,52),s["\u0275\u0275listener"]("selectionEnded",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().weeklySelectEnd(t)}),s["\u0275\u0275elementStart"](5,"table",53),s["\u0275\u0275template"](6,K,7,8,"tr",54),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"div",55),s["\u0275\u0275template"](8,X,7,3,"div",56),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",e.weeklyPlan),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngForOf",e.daySchedule),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",e.weeklyPlan)}}function Z(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"app-event-rhp",70),s["\u0275\u0275listener"]("updated",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().onEventUpdate(t)})("deleted",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().onEventDelete(t)})("closed",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().dismiss()}),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("fullScreen",!0)("activeEvent",e.activeEvent)}}function ee(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"app-event-minutes-rhp",70),s["\u0275\u0275listener"]("updated",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().onEventUpdate(t)})("deleted",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().onEventDelete(t)})("closed",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().dismiss()}),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("fullScreen",!0)("activeEvent",e.activeEvent)}}const te=function(){return{standalone:!0}},ne=function(){return[4,12,13]};let ie=(()=>{class e extends p.a{constructor(e,t,n,i,a,s,r,c,l,d){super(l,d),this.modal=e,this.taskService=t,this.eventService=n,this.router=i,this.userService=a,this.activatedRoute=s,this.renderer2=r,this.document=c,this.mobileResponsiveService=l,this.location=d,this.events=[],this.weeklyPlan=[],this.isMonday=!0,this.activeFilter=3,this.destroy$=new o.a,this.activeView=0,this.daySchedule=[],this.mouseOver=null,this.filteredEvents=[],this.tasks=[],this.hovers=[-1,-1,-1,-1,-1,-1,-1],this.user=this.userService.user.getValue(),this.contactID=this.user.contactID,this.companyID=this.user.companyID,this.userService.taskFullWidth=!0,this.superAdmin=this.user.permissions.some(e=>m.b.Admin===e.permissionAreaID),this.trainingCoordinator=this.user.permissions.some(e=>m.b.Training_Coordinator===e.permissionAreaID)}ngOnInit(){3===this.user.userGroupID&&(this.activeFilter=1),super.ngOnInit(),this.userService.fullWidth.next(!0),this.isToday=!0,this.dayViewDate=new Date,this.handleDays();const e=+this.activatedRoute.snapshot.queryParams.eventID,t=+this.activatedRoute.snapshot.queryParams.taskID;e&&this.getEventProfile(e),t&&this.getTaskProfile(t),this.userService.filterToggle.pipe(Object(f.a)(this.destroy$)).subscribe(e=>{this.toggleFilter=!this.toggleFilter&&e})}initData(){this.loading=!0;let e=Object(l.a)(new Date(this.dayViewDate).setHours(0,0,0)),t=Object(l.a)(new Date(this.dayViewDate).setHours(23,59,59));1===this.activeView&&(e=Object(l.a)(new Date(this.startOfTheWeek).setHours(0,0,0)),t=Object(l.a)(new Date(this.endOfTheWeek).setHours(0,0,0)));let n=this.contactID,i=0,a=0;3===this.activeFilter?(n=0,a=0,i=this.companyID):2===this.activeFilter&&(i=0,n=0,a=this.contactID),Object(c.a)(this.eventService.getEventDelegatesByDate(0,0,0,n,0,0,i,0,0,t,e,a),this.taskService.getTaskOwners(0,0,0,this.contactID,0,0,e,t)).subscribe(e=>{this.events=Object(l.j)(e[0],"eventID");const t=Object(l.j)(e[1],"taskOwnerID");let n=Object(u.a)(t);const i=Object(u.a)(t);n=Object(l.j)(n,"taskID"),n=n.map(e=>(e.taskOwners=i.filter(t=>t.taskID===e.taskID),e.underWayCount=e.taskOwners.filter(e=>1===e.taskStatusID).length||0,e.pendingCount=e.taskOwners.filter(e=>2===e.taskStatusID).length||0,e.completedCount=e.taskOwners.filter(e=>3===e.taskStatusID).length||0,e.toDoCanUpdate=e.taskOwners.find(e=>e.contactID===this.contactID),e)),this.tasks=n,this.filter()})}getEventProfile(e){this.eventService.selectEvent(0,e).pipe(Object(f.a)(this.destroy$)).subscribe(e=>{e[0]&&(this.activeEvent=e[0])})}getTaskProfile(e){this.taskService.getTask(e,0,0,0,0,0,0,0,!1).pipe(Object(f.a)(this.destroy$)).subscribe(e=>{e[0]&&this.taskService.storeActiveTaskRx(Object(l.l)(e[0]))})}handleWeeks(){this.weeklyPlan=[];let e=0;this.isMonday&&(e=1);const t=h().startOf("w").add(e,"d").toDate(),n=h().endOf("w").add(e,"d").toDate();this.startOfTheWeek=new Date(t),this.endOfTheWeek=new Date(n);for(let i=0;i<=6;i++)this.weeklyPlan.push({date:Object(l.a)(h(t).add(i,"d").toDate(),"yyyy.MM.dd"),events:[],tasks:[]});this.initData()}filter(){const e=[];this.events.sort((e,t)=>h(e.startTime).diff(e.endTime,"minutes")-h(t.startTime).diff(t.endTime,"minutes")).forEach((t,n)=>{t.offsetTop=0,t.offsetLeft=0,t.offsetHeight=1,t.offsetRange=[];const i=+h(t.startTime).format("m");let a=this.daySchedule.findIndex(e=>h(e.date).format("HH")===h(t.startTime).format("HH"));i>=30&&(a+=1);const s=+h(t.endTime).format("m");let r=this.daySchedule.findIndex(e=>h(e.date).format("HH")===h(t.endTime).format("HH"));if(s>=30&&(r+=1),-1!==r&&-1!==a){t.offsetHeight=r+1,t.offsetTop=a,t.offsetLeft=0;for(let e=t.offsetTop;e<=t.offsetHeight-1;e++)t.offsetRange.push(e);e.push(t)}}),this.filteredEvents=[],e.forEach((t,n)=>{0!==n&&(console.log(t.offsetRange,t),t.offsetLeft=e.slice(0,n).filter(e=>e.offsetRange.some(e=>t.offsetRange.includes(e))).length),t.fullWidth=!e.slice(n+1).filter(e=>e.offsetRange.some(e=>t.offsetRange.includes(e))).length&&!t.offsetLeft,this.filteredEvents.push(t)}),this.tasks=this.tasks.sort((e,t)=>e.taskID-t.taskID),0===this.activeView&&(this.tasks=this.tasks.filter(e=>!!e.endDate&&Object(l.a)(new Date(this.dayViewDate),"dd.MM.yyyy")===Object(l.a)(new Date(e.endDate),"dd.MM.yyyy"))),this.weeklyPlan=this.weeklyPlan.map(e=>(e.events=this.events.filter(t=>Object(l.a)(t.startTime,"yyyy.MM.dd")===e.date),e.tasks=this.tasks.filter(t=>!!t.endDate&&Object(l.a)(t.endDate,"yyyy.MM.dd")===e.date),e)),this.loading=!1}prev(){if(this.events=[],this.filteredEvents=[],this.tasks=[],0===this.activeView){this.dayViewDate=h(this.dayViewDate).subtract(1,"d").toDate();const e=Object(l.a)(new Date,"dd.MM.yyyy"),t=Object(l.a)(this.dayViewDate,"dd.MM.yyyy");return this.isToday=e===t,this.datepicker.navigateTo({year:h(this.dayViewDate).year(),month:h(this.dayViewDate).month()+1}),void this.initData()}const e=new Date(this.startOfTheWeek),t=new Date(this.endOfTheWeek);this.startOfTheWeek=new Date(e.setDate(e.getDate()-7)),this.endOfTheWeek=new Date(t.setDate(t.getDate()-7)),this.weeklyPlan=this.weeklyPlan.map(e=>{const t=new Date(e.date);return e.tasks=[],e.events=[],e.date=Object(l.a)(new Date(t.setDate(t.getDate()-7)),"yyyy.MM.dd"),e}),this.datepicker.navigateTo({year:h(this.startOfTheWeek).year(),month:h(this.startOfTheWeek).month()+1}),this.initData()}next(){if(this.events=[],this.filteredEvents=[],this.tasks=[],0===this.activeView){this.dayViewDate=h(this.dayViewDate).add(1,"d").toDate();const e=Object(l.a)(new Date,"dd.MM.yyyy"),t=Object(l.a)(this.dayViewDate,"dd.MM.yyyy");return this.isToday=e===t,this.datepicker.navigateTo({year:h(this.dayViewDate).year(),month:h(this.dayViewDate).month()+1}),void this.initData()}const e=new Date(this.startOfTheWeek),t=new Date(this.endOfTheWeek);this.startOfTheWeek=new Date(e.setDate(e.getDate()+7)),this.endOfTheWeek=new Date(t.setDate(t.getDate()+7)),this.weeklyPlan=this.weeklyPlan.map(e=>{const t=new Date(e.date);return e.tasks=[],e.events=[],e.date=Object(l.a)(new Date(t.setDate(t.getDate()+7)),"yyyy.MM.dd"),e}),this.datepicker.navigateTo({year:h(this.endOfTheWeek).year(),month:h(this.endOfTheWeek).month()+1}),this.initData()}onDatePicked(){this.events=[],this.filteredEvents=[],this.tasks=[];let e=0;this.isMonday&&(e=1);const t=new Date(this.pickDate.year,this.pickDate.month-1,this.pickDate.day-e);if(0===this.activeView){this.dayViewDate=new Date(this.pickDate.year,this.pickDate.month-1,this.pickDate.day);const e=Object(l.a)(new Date,"dd.MM.yyyy"),t=Object(l.a)(this.dayViewDate,"dd.MM.yyyy");this.isToday=e===t,this.initData()}const n=h(t).startOf("w").add(e,"d").toDate(),i=h(t).endOf("w").add(e,"d").toDate();this.startOfTheWeek=new Date(n),this.endOfTheWeek=new Date(i);const a=[];for(let s=0;s<=6;s++)a.push({date:Object(l.a)(h(n).add(s,"d").toDate(),"yyyy.MM.dd"),events:[],tasks:[]});this.weeklyPlan=a,this.initData()}addEvent(){const e=this.modal.open(d.a,{backdrop:"static",size:"md"});e.componentInstance.preventPostNavigation=!0,e.result.then(e=>{this.events.push(e),this.filter()})}clearDate(){this.pickDate={day:null,month:null,year:null}}navigateToEvent(e){this.renderer2.addClass(this.document.body,"hide-scrolls"),this.disableSelection=!0,this.activeEvent=e}onTypeFilter(e=1){this.toggleFilter=!1,this.activeFilter=e,this.initData()}handleDays(){this.daySchedule=[];let e=7;for(let t=1;t<=25;t++){let n=0;t%2!=0?(e++,n=0):n=30;const i=new Date(this.dayViewDate).setHours(e,n,0);this.daySchedule.push({date:Object(l.a)(i),events:[],tasks:[]})}this.initData()}switchView(e){this.activeView=e,this.tasks=[],0===e?this.handleDays():this.handleWeeks()}triggerEventAdd(e,t=!1,n=0,i=0,a=0){if((this.superAdmin||this.trainingCoordinator)&&!this.disableSelection){const s=this.modal.open(d.a,{backdrop:"static",size:"md"});if(s.componentInstance.preventPostNavigation=!0,t){const t=new Date(this.weeklyPlan[n].date),r=new Date(this.daySchedule[e].date);let o={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},c={hour:r.getHours()+1,minute:r.getMinutes()};if(s.componentInstance.plannerStartDate={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},i>0&&e!==i){const e=new Date(this.daySchedule[i].date);c={hour:e.getHours(),minute:e.getMinutes()}}if(a>0&&n!==a){const e=new Date(this.weeklyPlan[a].date);o={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}s.componentInstance.plannerEndDate=o,s.componentInstance.plannerStartTime={hour:r.getHours(),minute:r.getMinutes()},s.componentInstance.plannerEndTime=c}else{const t=new Date(this.daySchedule[e].date);let n={hour:t.getHours()+1,minute:t.getMinutes()};if(i>0&&e!==i){const e=new Date(this.daySchedule[i].date);n={hour:e.getHours(),minute:e.getMinutes()}}s.componentInstance.plannerStartTime={hour:t.getHours(),minute:t.getMinutes()},s.componentInstance.plannerEndTime=n}s.result.then(e=>{e.eventID&&(this.events.push(e),this.filter())})}}onWeeklyClick(e,t=!1,n=0){this.dayViewDate=new Date(this.weeklyPlan[e].date);const i=Object(l.a)(new Date,"dd.MM.yyyy"),a=Object(l.a)(this.dayViewDate,"dd.MM.yyyy");this.isToday=i===a,this.events=[],this.tasks=[],this.filteredEvents=[],this.activeView=0,this.initData()}onEventDelete(e){if(0===this.activeView){const t=this.events.findIndex(t=>t.eventID===e.eventID);-1!==t&&(this.events.splice(t,1),this.filter())}else{const t=this.weeklyPlan.findIndex(t=>t.events.some(t=>t.eventID===e.eventID));-1!==t&&(this.weeklyPlan[t].events=this.weeklyPlan[t].events.filter(t=>t.eventID!==e.eventID))}}onEventUpdate(e){if(0===this.activeView){const t=this.events.findIndex(t=>t.eventID===e.eventID);-1!==t&&(this.events[t]=e,this.filter())}else{const t=this.weeklyPlan.findIndex(t=>t.events.some(t=>t.eventID===e.eventID));if(-1!==t){const n=this.weeklyPlan[t].events.findIndex(t=>t.eventID===e.eventID);-1!==n&&(this.weeklyPlan[t].events[n]=e)}}}onTaskDelete(e){const t=this.tasks.findIndex(t=>t.taskID===e);-1!==t&&this.tasks.splice(t,1)}onTaskUpdate(e){const t=this.tasks.findIndex(t=>t.taskID===e.taskID);-1!==t?this.tasks[t]=e:this.tasks.push(e),this.filter()}onSelectEnded(e){if(!e.length)return;e=e.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());const t=this.daySchedule.findIndex(t=>e[0].date===t.date),n=this.daySchedule.findIndex(t=>e[e.length-1].date===t.date);setTimeout(()=>{this.triggerEventAdd(t,!1,0,n),this.selectContainer.clearSelection()},100)}weeklySelectEnd(e){if(!e.length)return;const t=(e=e.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime())).sort((e,t)=>new Date(e.hourDate).getTime()-new Date(t.hourDate).getTime()),n=this.daySchedule.findIndex(e=>t[0].hourDate===e.date),i=this.daySchedule.findIndex(e=>t[t.length-1].hourDate===e.date),a=this.weeklyPlan.findIndex(t=>e[0].date===t.date),s=this.weeklyPlan.findIndex(t=>e[e.length-1].date===t.date);setTimeout(()=>{this.triggerEventAdd(n,!0,a,i,s),this.weeklySelectContainer.clearSelection()},100)}dismiss(){this.activeEvent=null,this.disableSelection=!1,this.renderer2.removeClass(this.document.body,"hide-scrolls")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.userService.fullWidth.next(!1),this.renderer2.removeClass(this.document.body,"hide-scrolls"),this.userService.taskFullWidth=!1}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](g.p),s["\u0275\u0275directiveInject"](v.a),s["\u0275\u0275directiveInject"](D.a),s["\u0275\u0275directiveInject"](a.c),s["\u0275\u0275directiveInject"](I.a),s["\u0275\u0275directiveInject"](a.a),s["\u0275\u0275directiveInject"](s.Renderer2),s["\u0275\u0275directiveInject"](i.d),s["\u0275\u0275directiveInject"](y.a),s["\u0275\u0275directiveInject"](i.j))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-weekly-events"]],viewQuery:function(e,t){if(1&e&&(s["\u0275\u0275viewQuery"](M,!0),s["\u0275\u0275viewQuery"](P,!0),s["\u0275\u0275viewQuery"](T,!0)),2&e){let e;s["\u0275\u0275queryRefresh"](e=s["\u0275\u0275loadQuery"]())&&(t.selectContainer=e.first),s["\u0275\u0275queryRefresh"](e=s["\u0275\u0275loadQuery"]())&&(t.weeklySelectContainer=e.first),s["\u0275\u0275queryRefresh"](e=s["\u0275\u0275loadQuery"]())&&(t.datepicker=e.first)}},features:[s["\u0275\u0275InheritDefinitionFeature"]],decls:46,vars:33,consts:[[1,"weekly-planner","d-flex","flex-column","w-100",3,"avnonLoader"],[1,"d-flex","flex-grow-1"],[1,"left-hand-filter","d-flex","flex-column","pt-4","pl-2","pr-2",3,"click"],[1,"d-flex","flex-column","w-100","inner-container",3,"click"],[1,"d-flex","flex-column","bg-white"],[1,"picker",3,"ngModel","ngModelOptions","ngModelChange"],["datepicker",""],[1,"pl-3","pr-3","mt-4"],[1,"nav","flex-column","filter-menu"],[1,"nav-item"],[1,"nav-link","cursor-pointer",3,"click"],[1,"d-flex","flex-column","w-100","flex-grow-1","right-content"],[1,"d-flex","w-100","align-items-center","pb-2","border-bottom","pl-3","pr-3","pt-2"],[1,"d-flex","justify-content-between","pl-1","pr-1","pt-2","pb-2","align-items-center"],[1,"fas","fa-chevron-left","mr-1","cursor-pointer",3,"click"],[1,"cursor-pointer"],[4,"ngIf"],[1,"fas","fa-chevron-right","ml-1","cursor-pointer",3,"click"],["class","btn btn-sm btn-outline-primary ml-auto mr-2",3,"click",4,"ngIf"],["ngbDropdown","",1,"d-inline-block","view-switcher"],["id","dropdownBasic2","ngbDropdownToggle","",1,"btn"],[1,"fas","fa-caret-down"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic2"],["ngbDropdownItem","",3,"click"],["ngbDropdownItem","","routerLink","/weekly-plan/tasks"],["class","d-flex week-view flex-column flex-grow-1",4,"ngIf"],[3,"fullScreen","activeEvent","updated","deleted","closed",4,"ngIf"],[1,"btn","btn-sm","btn-outline-primary","ml-auto","mr-2",3,"click"],[1,"d-flex","flex-column","w-100"],[3,"contactID","user","companyID","tasks","startDate","taskUpdated","taskDeleted"],[1,"d-flex","align-items-center","pt-2","pb-2","pl-3","pr-3"],[1,"mb-0"],["class","btn btn-sm btn-outline-primary ml-auto",3,"click",4,"ngIf"],[1,"d-flex","flex-column","w-100","position-relative",3,"selectionEnded"],["selectContainer","dts-select-container"],[1,"table","daily-schedule","border-bottom","mb-0"],[3,"mouseOver",4,"ngFor","ngForOf"],[1,"planner-calendar"],["class","schedule-liner",3,"dtsSelectItem","mouseleave","mouseover",4,"ngFor","ngForOf"],["class","card d-flex flex-column p-2",3,"w-100","ngStyle","click",4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-outline-primary","ml-auto",3,"click"],[1,"border-right","p-0"],[1,"d-flex","align-items-center","time-capsule","pl-3"],[1,"m-0"],[1,"align-middle","pl-4","pt-0","pb-0",3,"click"],[1,"text-muted","font-weight-light","schedule-text"],[1,"schedule-liner",3,"dtsSelectItem","mouseleave","mouseover"],[1,"card","d-flex","flex-column","p-2",3,"ngStyle","click"],[1,"d-flex","week-view","flex-column","flex-grow-1"],[1,"d-flex","todo-planner"],["class","d-flex flex-column p-0 m-0 top-line week-view-item overall-col",3,"border-left",4,"ngFor","ngForOf"],[1,"d-flex",3,"selectionEnded"],["weeklySelectContainer","dts-select-container"],[1,"table","daily-schedule","alternative","border-bottom","mb-0"],[3,"mouseOver","mouseleave","mouseover",4,"ngFor","ngForOf"],[1,"d-flex","flex-grow-1","boundary"],["class","d-flex flex-column p-0 m-0 top-line week-view-item overall-col",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","p-0","m-0","top-line","week-view-item","overall-col"],[1,"border-bottom","pb-1","cursor-pointer","pl-3","pr-3","pt-3",3,"click"],[1,"text-muted"],[1,"pt-0","pb-0","pl-0","pr-0","d-flex","flex-column"],[1,"d-flex",3,"contactID","companyID","user","hideAddBorder","weekTodo","limitEnabled","limit","tasks","startDate","click"],[3,"mouseleave","mouseover"],[1,"d-flex","align-items-center","time-capsule","justify-content-center"],[1,"d-flex","flex-column","w-100","position-relative"],[1,"table","daily-schedule","border-bottom","mb-0","min-h"],[1,"planner-calendar","alternative"],["class","card card-new d-flex flex-column p-2",3,"dtsSelectItem","w-100","ngStyle","click",4,"ngFor","ngForOf"],[1,"align-middle","pt-0","pb-0","pl-1","pr-1","w-100",3,"click"],[1,"card","card-new","d-flex","flex-column","p-2",3,"dtsSelectItem","ngStyle","click"],[3,"fullScreen","activeEvent","updated","deleted","closed"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275elementStart"](2,"div",2),s["\u0275\u0275listener"]("click",function(){return t.toggleFilter=!1}),s["\u0275\u0275elementStart"](3,"div",3),s["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()}),s["\u0275\u0275elementStart"](4,"div",4),s["\u0275\u0275elementStart"](5,"ngb-datepicker",5,6),s["\u0275\u0275listener"]("ngModelChange",function(e){return t.pickDate=e})("ngModelChange",function(){return t.onDatePicked()}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"h3",7),s["\u0275\u0275text"](8,"Filters"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"ul",8),s["\u0275\u0275elementStart"](10,"li",9),s["\u0275\u0275elementStart"](11,"a",10),s["\u0275\u0275listener"]("click",function(){return t.onTypeFilter(1)}),s["\u0275\u0275text"](12),s["\u0275\u0275pipe"](13,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](14,"li",9),s["\u0275\u0275elementStart"](15,"a",10),s["\u0275\u0275listener"]("click",function(){return t.onTypeFilter(2)}),s["\u0275\u0275text"](16),s["\u0275\u0275pipe"](17,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](18,"li",9),s["\u0275\u0275elementStart"](19,"a",10),s["\u0275\u0275listener"]("click",function(){return t.onTypeFilter(3)}),s["\u0275\u0275text"](20),s["\u0275\u0275pipe"](21,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](22,"div",11),s["\u0275\u0275elementStart"](23,"div",12),s["\u0275\u0275elementStart"](24,"div",13),s["\u0275\u0275elementStart"](25,"i",14),s["\u0275\u0275listener"]("click",function(){return t.prev()}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](26,"span",15),s["\u0275\u0275template"](27,V,3,2,"ng-container",16),s["\u0275\u0275template"](28,F,6,12,"ng-container",16),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](29,"i",17),s["\u0275\u0275listener"]("click",function(){return t.next()}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](30,A,2,0,"a",18),s["\u0275\u0275elementStart"](31,"div",19),s["\u0275\u0275elementStart"](32,"button",20),s["\u0275\u0275text"](33),s["\u0275\u0275element"](34,"i",21),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](35,"div",22),s["\u0275\u0275elementStart"](36,"button",23),s["\u0275\u0275listener"]("click",function(){return t.switchView(0)}),s["\u0275\u0275text"](37,"Day View"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](38,"button",23),s["\u0275\u0275listener"]("click",function(){return t.switchView(1)}),s["\u0275\u0275text"](39,"Week View"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](40,"button",24),s["\u0275\u0275text"](41,"Task View"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](42,U,14,9,"ng-container",16),s["\u0275\u0275template"](43,Q,9,3,"div",25),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](44,Z,1,2,"app-event-rhp",26),s["\u0275\u0275template"](45,ee,1,2,"app-event-minutes-rhp",26)),2&e&&(s["\u0275\u0275property"]("avnonLoader",t.loading),s["\u0275\u0275advance"](2),s["\u0275\u0275classProp"]("toggled",t.toggleFilter),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngModel",t.pickDate)("ngModelOptions",s["\u0275\u0275pureFunction0"](30,te)),s["\u0275\u0275advance"](6),s["\u0275\u0275classProp"]("active",1===t.activeFilter),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](13,24,"PLANNER.SCHEDULE-FILTERS.MY-EVENTS")," "),s["\u0275\u0275advance"](3),s["\u0275\u0275classProp"]("active",2===t.activeFilter),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](17,26,"PLANNER.SCHEDULE-FILTERS.MY-SCHEDULED-EVENTS")," "),s["\u0275\u0275advance"](3),s["\u0275\u0275classProp"]("active",3===t.activeFilter),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](21,28,"PLANNER.SCHEDULE-FILTERS.COMPANY-CALENDAR")," "),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngIf",0===t.activeView),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",1===t.activeView),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",(t.superAdmin||t.trainingCoordinator)&&1===t.activeView),s["\u0275\u0275advance"](1),s["\u0275\u0275classProp"]("ml-auto",!t.superAdmin&&!t.trainingCoordinator||0===t.activeView),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",0===t.activeView?"Day View":"Week View"," "),s["\u0275\u0275advance"](9),s["\u0275\u0275property"]("ngIf",0===t.activeView),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",1===t.activeView),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.activeEvent&&!s["\u0275\u0275pureFunction0"](31,ne).includes(t.activeEvent.eventCategoryID)),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.activeEvent&&s["\u0275\u0275pureFunction0"](32,ne).includes(t.activeEvent.eventCategoryID)))},directives:[k.a,g.g,b.q,b.t,i.n,g.i,g.m,g.k,g.j,a.d,x.a,S.b,i.m,S.c,i.o,w.a,C.a],pipes:[O.c,i.e,E.a],styles:[".weekly-planner[_ngcontent-%COMP%]{width:100%;min-height:calc(100vh - 64px)}@media (max-width:1024px){.weekly-planner[_ngcontent-%COMP%]{min-height:calc(100vh - 110px)}}.weekly-planner[_ngcontent-%COMP%]   .title-col[_ngcontent-%COMP%]{padding-top:.75rem;border-right:1px solid;border-color:#ebeef0}.delegate-list[_ngcontent-%COMP%]:last-child{border-bottom:0}.delegate-list[_ngcontent-%COMP%]   .date-holder[_ngcontent-%COMP%]{min-width:48px}.top-line[_ngcontent-%COMP%]{border-right:1px solid;border-color:#ebeef0}.top-line[_ngcontent-%COMP%]:last-child{border-right:0}.daily-schedule.alternative[_ngcontent-%COMP%]{width:73px;position:sticky;left:0;z-index:1}.daily-schedule.alternative[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:100%!important;display:inline-block}.daily-schedule.min-h[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;text-align:center}.daily-schedule.min-h[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .schedule-text[_ngcontent-%COMP%]{line-height:35px}.daily-schedule[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer;min-height:36px}.daily-schedule[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{min-height:36px}.daily-schedule[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .schedule-text[_ngcontent-%COMP%]{opacity:0}.daily-schedule[_ngcontent-%COMP%]   tr.mouseOver[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#f0f3ff}.daily-schedule[_ngcontent-%COMP%]   tr.mouseOver[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .schedule-text[_ngcontent-%COMP%]{opacity:1!important}.daily-schedule[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#f0f3ff}.daily-schedule[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]   .schedule-text[_ngcontent-%COMP%]{opacity:1!important}.daily-schedule[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{width:100px}.daily-schedule[_ngcontent-%COMP%]   .time-capsule[_ngcontent-%COMP%]{height:35px;width:100%}.planner-calendar[_ngcontent-%COMP%]{position:absolute;left:115px;right:15px;top:0;bottom:0;display:flex;flex-direction:column;overflow-y:hidden;overflow-x:auto;z-index:0}.planner-calendar.alternative[_ngcontent-%COMP%]{left:15px!important;overflow:hidden!important}.planner-calendar[_ngcontent-%COMP%]   .schedule-liner[_ngcontent-%COMP%]{min-height:37px;display:flex;width:100%;cursor:pointer}.planner-calendar[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{color:#fff;z-index:2;width:200px;position:absolute;background:#3457d4;cursor:pointer;border:1px solid #fff;box-shadow:0 0 1px 0 #f1f1f1}.planner-calendar[_ngcontent-%COMP%]   .card.card-new[_ngcontent-%COMP%]{width:auto}.planner-calendar[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.planner-calendar[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{background:#5d79dd;z-index:3}.planner-calendar[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .hidden-item[_ngcontent-%COMP%]{display:none}.overall-col[_ngcontent-%COMP%]:hover{background:#f0f3ff}.view-switcher[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:0 4px;height:30px;border:none;background:none!important}.view-switcher[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background:#cad5ff!important}.view-switcher[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:focus{outline:none}.week-view[_ngcontent-%COMP%]{flex-wrap:nowrap;max-width:100%;overflow-x:auto}.week-view[_ngcontent-%COMP%]   .week-view-item[_ngcontent-%COMP%]{min-width:222px}.right-content[_ngcontent-%COMP%]{max-width:100%;overflow:hidden}.todo-planner[_ngcontent-%COMP%]{padding-left:72px}  .picker .ngb-dp-day,   .picker .ngb-dp-day>div{width:26px!important;height:1.5rem!important}  .picker .ngb-dp-day>div{line-height:1.5rem!important}  .picker .ngb-dp-weekday{width:26px!important}.dts-range-start[_ngcontent-%COMP%]{border:0!important}.dts-select-item.selected[_ngcontent-%COMP%]{border:1px solid #2196f3!important}"]}),e})();var ae=n("p0ro"),se=n("MNGV"),re=n("p+bo"),oe=n("eIep"),ce=n("LRne"),le=n("w6ya"),de=n("4CJs"),me=n("knhq"),pe=n("euQB"),he=n("S2+F"),ue=n("9nlD"),fe=n("5eHb"),ge=n("xDUJ");function ve(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",17),s["\u0275\u0275elementStart"](1,"input",18),s["\u0275\u0275listener"]("change",function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"]().onStageSelect(n)}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](2,"label",19),s["\u0275\u0275text"](3),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"span",20),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"]().openActive(n)}),s["\u0275\u0275text"](5),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,i=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275propertyInterpolate1"]("id","program-",n,""),s["\u0275\u0275property"]("checked",i.selectedPortfolios.includes(e.programInstanceStageID)),s["\u0275\u0275advance"](1),s["\u0275\u0275propertyInterpolate1"]("for","program-",n,""),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("",e.programStageTitle," "),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",e.activeCount," companies")}}function De(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"option",12),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"date"),s["\u0275\u0275pipe"](3,"dateObject"),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275property"]("ngValue",e),s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind2"](2,2,s["\u0275\u0275pipeBind1"](3,5,e.date),"MMM yyyy")," ")}}function Ie(e,t){1&e&&s["\u0275\u0275element"](0,"span",21)}let ye=(()=>{class e{constructor(e,t,n,i,a,s,r,o,c){this.taskService=e,this.activeModal=t,this.portfolioService=n,this.signalRService=i,this.notificationService=a,this.toastrService=s,this.formService=r,this.modal=o,this.userService=c,this.portfolios=[],this.originalPortfolios=[],this.selectedPortfolios=[],this.dates=[{id:1,date:"2021-01-31"},{id:2,date:"2021-02-28"},{id:3,date:"2021-03-31"},{id:4,date:"2021-04-30"},{id:5,date:"2021-05-31"}],this.taskSections=[],this.user=this.userService.user.getValue(),this.contactID=this.user.contactID,this.companyID=this.user.companyID||0}ngOnInit(){this.getPortfolio(),this.getCustomForm()}getPortfolio(){this.loading=!0,this.portfolioService.getCompanyRoadmapStages(0,0,0,0,0,this.companyID).subscribe(e=>{this.portfolios=Object(l.j)(e.filter(e=>3===e.programStageTypeID&&2===e.companyProgramStageStatusID),"programInstanceStageID"),this.originalPortfolios=e.filter(e=>3===e.programStageTypeID&&2===e.companyProgramStageStatusID),this.portfolios=this.portfolios.map(e=>(e.activeCount=this.originalPortfolios.filter(t=>t.programInstanceStageID===e.programInstanceStageID&&2===e.companyProgramStageStatusID).length,e)),this.loading=!1})}onStageSelect(e){const t=this.portfolios[e];this.selectedPortfolios.includes(t.programInstanceStageID)?this.selectedPortfolios.splice(e,1):this.selectedPortfolios.push(t.programInstanceStageID)}onSubmit(){this.loading=!0;const e=new se.a,t=new Date(this.date.date),n=Object(l.a)(t,"MMM"),i=Object(l.a)(t,"yyyy");e.contactID=this.contactID,e.endDate=Object(l.a)(t),e.taskCategoryID=31,e.submittedBy=this.user.contactID,e.autoSignOff=!1,e.referenceID=this.companyID,e.companyID=this.companyID,e.taskTitle=`Monthly Report ${n} ${i}`;const a=[];this.selectedPortfolios.forEach(e=>{this.originalPortfolios.filter(t=>t.programInstanceStageID===e&&2===t.companyProgramStageStatusID).forEach(e=>{a.filter(t=>t.contactID===e.contactID).length||a.push(e)})}),this.taskService.addTask(e).pipe(Object(oe.a)(t=>{e.taskOwners=[],e.taskID=t.inOut_TaskID;const n=[];return a.forEach(t=>{const i=new re.a;i.contactID=t.contactID,i.taskID=e.taskID,i.deadline=e.endDate,i.companyID=t.companyID,n.push(this.taskService.addTaskOwner(i))}),Object(c.a)(n)})).subscribe(t=>{const n=[];t.forEach(t=>{if(!t.taskOwnerID)return;const i=a.findIndex(e=>e.contactID===t.contactID);-1!==i&&(t.firstName=a[i].firstname,t.surname=a[i].surname,e.taskOwners.push(t));const s=new re.b;s.taskCategoryID=31,s.taskOwnerID=t.taskOwnerID,s.taskID=t.taskID,s.companyID=this.companyID,s.taskSectionReferenceID=0,n.push(this.taskService.addTaskOwnerSection(s))}),(n.length>0?Object(c.a)(n):Object(ce.a)(n)).subscribe(()=>{a.forEach(t=>{this.noticeNotification(e.taskID,t.contactID)}),this.formTask&&this.createFormTask(e.taskID),this.toastrService.success("Monthly report has been added"),this.activeModal.close({task:e}),this.loading=!1})})}noticeNotification(e,t){const n=new Date(this.date.date),i=Object(l.a)(n,"MMM"),a=Object(l.a)(n,"yyyy"),s=Object(l.a)(new Date),r=`Your monthly operational report(${i} ${a}) is due`,o={notificationCategoryID:le.a.monthly_report_task_owner,referenceID:e,contactID:t,description:r,createdContact:this.contactID},c=s+"|"+e,d={date:s,body:r.replace("|",""),topic:r.replace("|",""),senderFullName:"",senderPhoto:"",notificationId:Math.floor(1e3*Math.random()),channel:"dashboard",reference:o.referenceID,notificationType:de.a.applicantRequest,senderId:o.createdContact,receivers:[o.contactID],uniqueId:c,discussionId:0};this.notificationService.noticeNotification(o).subscribe(()=>{this.signalRService.transferMessage("dashboard",d)})}openActive(e){if(0===e.activeCount)return;const t=this.originalPortfolios.filter(t=>2===t.companyProgramStageStatusID&&t.programInstanceStageID===e.programInstanceStageID),n=this.modal.open(me.a,{size:"lg",backdrop:"static"});n.componentInstance.activeStages=t,n.componentInstance.stage=e}getCustomForm(){this.customFormLoading=!0,this.taskService.getTaskSection(this.companyID,31).pipe(Object(oe.a)(e=>{if(e.some(e=>12===e.taskSectionCategoryID)){const t=e.find(e=>12===e.taskSectionCategoryID);return this.formService.getFormTask(t.taskSectionID,31)}return Object(ce.a)([])})).subscribe(e=>{this.formTask=e[0]||null})}createFormTask(e){const t=new se.a;t.formID=this.formTask.formID,t.taskCategoryID=1,t.referenceID=e,t.endDate=Object(l.a)(new Date),t.taskTitle=this.formTask.formName,t.submittedBy=this.contactID,t.parentTaskID=e,this.taskService.addTask(t).subscribe()}dismiss(){this.activeModal.dismiss()}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](v.a),s["\u0275\u0275directiveInject"](g.a),s["\u0275\u0275directiveInject"](pe.a),s["\u0275\u0275directiveInject"](he.a),s["\u0275\u0275directiveInject"](ue.a),s["\u0275\u0275directiveInject"](fe.b),s["\u0275\u0275directiveInject"](ge.a),s["\u0275\u0275directiveInject"](g.p),s["\u0275\u0275directiveInject"](I.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-monthly-report-task-dialog"]],decls:24,vars:7,consts:[[1,"modal-header"],["id","postModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-block",3,"avnonLoader","ngSubmit"],["f","ngForm"],[1,"form-group","mb-2"],["for","program"],["class","form-check",4,"ngFor","ngForOf"],["for","month"],["name","month","id","month","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"w-100","d-flex","align-items-center","mb-3"],["type","submit",1,"btn","btn-primary","ml-auto",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","checked","change"],[1,"form-check-label","font-weight-normal",3,"for"],[1,"cursor-pointer","ml-1","text-primary",3,"click"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"h5",1),s["\u0275\u0275text"](2," Generate Monthly Report "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"button",2),s["\u0275\u0275listener"]("click",function(){return t.dismiss()}),s["\u0275\u0275elementStart"](4,"span",3),s["\u0275\u0275text"](5,"\xd7"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"div",4),s["\u0275\u0275elementStart"](7,"form",5,6),s["\u0275\u0275listener"]("ngSubmit",function(){return t.onSubmit()}),s["\u0275\u0275elementStart"](9,"div",7),s["\u0275\u0275elementStart"](10,"label",8),s["\u0275\u0275text"](11,"Which Programs"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](12,ve,6,5,"div",9),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"div",7),s["\u0275\u0275elementStart"](14,"label",10),s["\u0275\u0275text"](15,"Which Month"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](16,"select",11),s["\u0275\u0275listener"]("ngModelChange",function(e){return t.date=e}),s["\u0275\u0275elementStart"](17,"option",12),s["\u0275\u0275text"](18,"Please Select"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](19,De,4,7,"option",13),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](20,"div",14),s["\u0275\u0275elementStart"](21,"button",15),s["\u0275\u0275template"](22,Ie,1,0,"span",16),s["\u0275\u0275text"](23," Submit "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275reference"](8);s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("avnonLoader",t.loading),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngForOf",t.portfolios),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngModel",t.date),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngValue",void 0),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngForOf",t.dates),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("disabled",t.loading||e.invalid||!t.selectedPortfolios.length),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.loading)}},directives:[b.E,b.r,b.s,k.a,i.m,b.B,b.A,b.q,b.t,b.v,b.D,i.n],pipes:[i.e,E.a],styles:[""]}),e})();var ke=n("KJJU"),be=n("frau"),xe=n("3DXX"),Se=n("VgRj"),we=n("XAmU"),Ce=n("WhH8"),Oe=n("1bi4");function Ee(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"textarea",24),s["\u0275\u0275listener"]("ngModelChange",function(t){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().task.taskDescription=t}),s["\u0275\u0275text"](1,"\t\t\t"),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("ngModel",e.task.taskDescription)}}function Me(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"span",28),s["\u0275\u0275element"](1,"i",29),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",2===e.currentUser.userGroupID?"Select Employees":"Add Task Owners"," ")}}function Pe(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"span",31),s["\u0275\u0275text"](1),s["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",e.firstName+" "+e.surname," ")}}function Te(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"span",28),s["\u0275\u0275template"](1,Pe,2,1,"span",30),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"](2);s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngForOf",e.selectedOwners)}}function je(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",10),s["\u0275\u0275elementStart"](1,"label",25),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"div",26),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().openOwnerSelect()}),s["\u0275\u0275template"](4,Me,3,1,"span",27),s["\u0275\u0275template"](5,Te,2,1,"span",27),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"]("",2===e.currentUser.userGroupID?"Employees":"Task Owners"," *"),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",0===e.selectedOwners.length),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",e.selectedOwners.length>0)}}function _e(e,t){1&e&&s["\u0275\u0275element"](0,"span",32)}let Ve=(()=>{class e{constructor(e,t,n,i,a,s,r,o,c,l){this.discussionService=e,this.taskService=t,this.ngbModal=n,this.activeModal=i,this.contactService=a,this.toastrService=s,this.signalRService=r,this.userService=o,this.distributionService=c,this.notificationService=l,this.task=new se.a,this.endDateModel={year:null,month:null,day:null},this.taskOwners=[],this.currentUser=new ke.a,this.selectedOwners=[],this.loading=!1,this.detailsVisible=!1,this.currentUser=this.userService.user.getValue(),this.currentUser.companyID=this.currentUser.companyID||0}ngOnInit(){var e;if(this.task&&this.task.taskID){this.selectedOwners=this.task.taskOwners;const t=new Date(this.task.endDate);this.endDateModel.year=t.getFullYear(),this.endDateModel.month=t.getMonth()+1,this.endDateModel.day=t.getDate(),this.detailsVisible=(null===(e=this.task.taskDescription)||void 0===e?void 0:e.length)>0}else this.task.submittedBy=this.currentUser.contactID,this.task.formID=0,this.task.taskCategoryID=37,this.task.referenceID=0}openOwnerSelect(){const e=this.ngbModal.open(be.a);e.componentInstance.emailValidationOn=!0,e.componentInstance.selectedContacts=Object(l.l)(this.selectedOwners),e.result.then(e=>{e&&(this.selectedOwners=Object(l.j)(e,"contactID"))},()=>{})}onSubmit(){var e,t,n;if(!this.endDateModel.year)return void this.toastrService.warning("Task due data is missing");if(this.loading)return;const i=new Date(null===(e=this.endDateModel)||void 0===e?void 0:e.year,(null===(t=this.endDateModel)||void 0===t?void 0:t.month)-1,null===(n=this.endDateModel)||void 0===n?void 0:n.day),a={taskID:null,autoSignOff:!1,endDate:Object(l.a)(i),referenceID:this.task.referenceID,submittedBy:this.task.submittedBy,taskDescription:this.task.taskDescription,taskTitle:this.task.taskTitle,taskCategoryID:this.task.taskCategoryID,formID:this.task.formID||0};this.selectedOwners=Object(l.j)(this.selectedOwners,"contactID"),this.loading=!0,this.task&&this.task.taskID?(a.taskID=this.task.taskID,a.taskCategoryID=this.task.taskCategoryID,this.processUpdateTask(a)):this.processAddTask(a)}processAddTask(e){let t,n;const i=[],a=[];this.taskService.addTask(e).pipe(Object(oe.a)(s=>{const r=[];return s.taskID=s.inOut_TaskID,t=s.taskID,n=s,n.taskOwners=[],i.push({discussionTopic:e.taskTitle,discussionCategoryID:10,referenceID:t,isDirectMessage:!0,discussionCreatedByContactID:this.currentUser.contactID,discussionBody:e.taskDescription,parentDiscussionID:0}),this.addTaskOwner(s,e,a,r),r.length>0?Object(c.a)(r):Object(ce.a)([])}),Object(oe.a)(a=>(a.forEach(a=>{if(a.hasOwnProperty("taskOwnerID")){const s=this.selectedOwners.findIndex(e=>e.contactID===a.contactID);-1!==s&&(a.firstName=this.selectedOwners[s].firstName,a.surname=this.selectedOwners[s].surname,n.taskOwners.push(a)),i.push({discussionTopic:e.taskTitle,discussionCategoryID:6,referenceID:a.taskOwnerID,isDirectMessage:!0,discussionCreatedByContactID:this.currentUser.contactID,discussionBody:e.taskDescription,parentDiscussionID:0}),this.noticeNotification(le.a.onboarding_task,t,a)}}),Object(ce.a)([])))).subscribe(()=>{this.checkUpdateDiscussions({discussions:i,members:a,task:n})},()=>{})}processUpdateTask(e){let t,n;const i=[],a=[];this.taskService.updateTask(e).pipe(Object(oe.a)(s=>{const r=[];return t=s.taskID,n=s,n.taskOwners=[],i.push({discussionTopic:e.taskTitle,discussionCategoryID:10,referenceID:t,isDirectMessage:!0,discussionCreatedByContactID:this.currentUser.contactID,discussionBody:e.taskDescription,parentDiscussionID:0}),this.updateTaskOwner(s,e,a,r),r.length>0?Object(c.a)(r):Object(ce.a)([])}),Object(oe.a)(t=>(t.forEach(t=>{if(t.hasOwnProperty("taskOwnerID")){const a=this.selectedOwners.findIndex(e=>e.contactID===t.contactID);-1!==a&&(t.firstName=this.selectedOwners[a].firstName,t.surname=this.selectedOwners[a].surname,n.taskOwners.push(t)),i.push({discussionTopic:e.taskTitle,discussionCategoryID:6,referenceID:t.taskOwnerID,isDirectMessage:!0,discussionCreatedByContactID:this.currentUser.contactID,discussionBody:e.taskDescription,parentDiscussionID:0})}}),Object(ce.a)([])))).subscribe(()=>{this.activeModal.close({status:"ok"})},()=>{this.loading=!1})}addTaskOwner(e,t,n,i){this.selectedOwners=Object(l.j)(this.selectedOwners,"contactID"),this.selectedOwners.forEach(a=>{const s=new re.a;s.contactID=a.contactID,s.taskID=e.taskID,s.deadline=t.endDate,s.taskOwnerCategoryID=t.taskCategoryID,s.referenceID=t.referenceID||0,s.companyID=a.companyID||0,-1===n.findIndex(e=>e===a.contactID)&&n.push(a.contactID),s.companyID=(null==a?void 0:a.companyID)||0,i.push(this.taskService.addTaskOwner(s))})}updateTaskOwner(e,t,n,i){var a,s;const r=[],o=[];this.selectedOwners=Object(l.j)(this.selectedOwners,"contactID"),null===(a=this.selectedOwners)||void 0===a||a.forEach(e=>{var t;-1===(null===(t=this.task.taskOwners)||void 0===t?void 0:t.findIndex(t=>t.contactID===e.contactID))&&r.push(e)}),null===(s=this.task)||void 0===s||s.taskOwners.forEach(e=>{var t;-1===(null===(t=this.selectedOwners)||void 0===t?void 0:t.findIndex(t=>t.contactID===e.contactID))&&o.push(e)}),r.forEach(a=>{const s=new re.a;s.contactID=a.contactID,s.taskID=e.taskID,s.deadline=t.endDate,s.taskOwnerCategoryID=t.taskCategoryID,s.referenceID=t.referenceID||0,s.companyID=a.companyID||0,-1===n.findIndex(e=>e===a.contactID)&&n.push(a.contactID),i.push(this.taskService.addTaskOwner(s))}),o.forEach(e=>{-1===n.findIndex(t=>t===e.contactID)&&n.push(e.contactID),i.push(this.taskService.deleteTaskOwner({taskOwnerID:e.taskOwnerID,taskID:this.task.taskID,contactID:e.contactID,referenceID:e.referenceID}))})}checkUpdateDiscussions(e){if(e&&e.hasOwnProperty("discussions")&&e.hasOwnProperty("members")){const t=e.members,n=[];let i=[];e.discussions.forEach(e=>{e.parentDiscussionID=0,n.push(this.discussionService.insertDiscussion(e))}),Object(c.a)(n).pipe(Object(oe.a)(e=>{const n=[];return i=e,e.forEach(e=>(t.forEach(t=>{6===e.discussionCategoryID&&n.push(this.discussionService.addMember({discussionID:e.discussionID,contactID:t,isAdmin:!0}))}),e)),n.length?Object(c.a)(n):Object(ce.a)([])})).subscribe(()=>{this.activeModal.close({disResponse:i,task:e.task})},()=>{})}}noticeNotification(e,t,n){const i=this.selectedOwners.find(e=>e.contactID===n.contactID);i&&(n.firstName=i.firstName);const a=Object(l.a)(new Date),s=`${this.currentUser.firstName} ${this.currentUser.surname}| has assigned you a Qualification Repository / Profile update task`,r={notificationCategoryID:e,referenceID:t,contactID:n.contactID,description:s,createdContact:this.currentUser.contactID},o=a+"|"+t,c={date:a,body:s.replace("|",""),topic:s.replace("|",""),senderFullName:"",senderPhoto:"",notificationId:Math.floor(1e3*Math.random()),channel:"dashboard",reference:r.referenceID,notificationType:de.a.applicantRequest,senderId:r.createdContact,receivers:[r.contactID],uniqueId:o,discussionId:0},d=Se.a.fullDomain()+"/explore/people/"+n.contactID+"?taskID="+t,m={distributionTitle:"Onboarding Task",distributionCategoryID:20,referenceID:t,distributionDate:null,userID:this.currentUser.contactID,emailBody:xe.a.onBoarding(n,d,this.currentUser),subjectLine:"Onboarding Task",senderEmail:"info@incubatorportal.com",senderName:this.currentUser.firstName,replyTo:null,contacts:[n.contactID]};this.distributionService.create(m).subscribe(),this.notificationService.noticeNotification(r).subscribe(()=>{this.signalRService.transferMessage("dashboard",c)})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](we.a),s["\u0275\u0275directiveInject"](v.a),s["\u0275\u0275directiveInject"](g.p),s["\u0275\u0275directiveInject"](g.a),s["\u0275\u0275directiveInject"](Ce.a),s["\u0275\u0275directiveInject"](fe.b),s["\u0275\u0275directiveInject"](he.a),s["\u0275\u0275directiveInject"](I.a),s["\u0275\u0275directiveInject"](Oe.a),s["\u0275\u0275directiveInject"](ue.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-onboarding-task-add"]],decls:31,vars:9,consts:[[1,"modal-header"],["id","postModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"avnonLoader","ngSubmit"],["f","ngForm"],[1,"form-group","mb-2"],["for","taskTitle"],["type","text","name","taskTitle","id","taskTitle","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group"],["for","taskDescription",1,"cursor-pointer","text-primary",3,"click"],["name","taskDescription","id","taskDescription","class","form-control",3,"ngModel","ngModelChange",4,"ngIf"],["class","form-group",4,"ngIf"],["for","endDate"],[1,"input-group",3,"click"],["placeholder","yyyy-mm-dd","name","endDate","required","","ngbDatepicker","","id","endDate","container","body","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["endDatePicker","ngbDatepicker"],[1,"input-group-append"],[1,"input-group-text","bg-transparent"],[1,"calendar-icon","icon-sm"],[1,"w-100","d-flex","align-items-center"],["type","submit",1,"btn","btn-primary","ml-auto",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["name","taskDescription","id","taskDescription",1,"form-control",3,"ngModel","ngModelChange"],["for","taskOwners"],["id","taskOwners",3,"click"],["class","title-sm",4,"ngIf"],[1,"title-sm"],[1,"fas","fa-plus"],["class","badge badge-info p-2 m-1",4,"ngFor","ngForOf"],[1,"badge","badge-info","p-2","m-1"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"h1",1),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"button",2),s["\u0275\u0275listener"]("click",function(){return t.activeModal.dismiss()}),s["\u0275\u0275elementStart"](4,"span",3),s["\u0275\u0275text"](5,"\xd7"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"div",4),s["\u0275\u0275elementStart"](7,"form",5,6),s["\u0275\u0275listener"]("ngSubmit",function(){return t.onSubmit()}),s["\u0275\u0275elementStart"](9,"div",7),s["\u0275\u0275elementStart"](10,"label",8),s["\u0275\u0275text"](11,"Task Title *"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"input",9),s["\u0275\u0275listener"]("ngModelChange",function(e){return t.task.taskTitle=e}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"div",10),s["\u0275\u0275elementStart"](14,"label",11),s["\u0275\u0275listener"]("click",function(){return t.detailsVisible=!t.detailsVisible}),s["\u0275\u0275text"](15),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](16,Ee,2,1,"textarea",12),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](17,je,6,3,"div",13),s["\u0275\u0275elementStart"](18,"div",10),s["\u0275\u0275elementStart"](19,"label",14),s["\u0275\u0275text"](20,"Deadline *"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](21,"div",15),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275reference"](23).toggle()}),s["\u0275\u0275elementStart"](22,"input",16,17),s["\u0275\u0275listener"]("ngModelChange",function(e){return t.endDateModel=e}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](24,"div",18),s["\u0275\u0275elementStart"](25,"span",19),s["\u0275\u0275element"](26,"span",20),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](27,"div",21),s["\u0275\u0275elementStart"](28,"button",22),s["\u0275\u0275template"](29,_e,1,0,"span",23),s["\u0275\u0275text"](30," Submit "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275reference"](8);s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",t.task&&t.task.taskID?"Edit":"Create"," Qualification Repository Task "),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("avnonLoader",t.loading),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngModel",t.task.taskTitle),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"](" ",t.detailsVisible?"Hide":"Add"," Details "),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.detailsVisible),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!(null!=t.task&&t.task.taskID)),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngModel",t.endDateModel),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("disabled",!e.valid||t.loading||0===t.selectedOwners.length),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.loading)}},directives:[b.E,b.r,b.s,k.a,b.b,b.A,b.q,b.t,i.n,g.o,i.m],styles:[""]}),e})();function Fe(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"span",32),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().resetFilter()}),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()}2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](2,1,"PLANNER.TASK-FILTER.CLEAR-FILTERS")," "))}function Ae(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",33),s["\u0275\u0275elementStart"](1,"div",34),s["\u0275\u0275listener"]("click",function(){s["\u0275\u0275restoreView"](e);const t=s["\u0275\u0275nextContext"]();return t.isMobileFilteringOn=!t.isMobileFilteringOn}),s["\u0275\u0275elementStart"](2,"span",35),s["\u0275\u0275element"](3,"i",36),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](4,"h3",37),s["\u0275\u0275text"](5),s["\u0275\u0275pipe"](6,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}2&e&&(s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate"](s["\u0275\u0275pipeBind1"](6,1,"COMMON.FILTERS")))}function Ne(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"a",43),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](2).createMonthlyReport()}),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()}2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](2,1,"PLANNER.CREATE-MONTHLY-REPORT")," "))}const Re=function(){return[2,3]};function Be(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",38),s["\u0275\u0275elementStart"](1,"button",39),s["\u0275\u0275element"](2,"span",40),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"ul",41),s["\u0275\u0275elementStart"](4,"li"),s["\u0275\u0275template"](5,Ne,3,3,"a",42),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"li"),s["\u0275\u0275elementStart"](7,"a",43),s["\u0275\u0275listener"]("click",function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().createOnboardingTask()}),s["\u0275\u0275text"](8),s["\u0275\u0275pipe"](9,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngIf",!s["\u0275\u0275pureFunction0"](4,Re).includes(e.user.userGroupID)),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](9,2,"PLANNER.CREATE-ONBOARDING-TASK")," ")}}const Le=function(e){return{"d-none-imp":e}},He=[{path:"",component:r,children:[{path:"",component:ie},{path:"tasks",component:(()=>{class e extends p.a{constructor(e,t,n,i,a,s){super(a,s),this.taskService=e,this.userService=t,this.router=n,this.modal=i,this.mobileResponsiveService=a,this.location=s,this.tasks=[],this.originTasks=[],this.filter={open:null,closed:null,my:null,me:null,today:null,week:null},this.destroy$=new o.a,this.user=this.userService.user.getValue(),this.contactID=this.user.contactID,this.companyID=this.user.companyID,this.superAdmin=this.user.permissions.some(e=>m.b.Admin===e.permissionAreaID)}ngOnInit(){super.ngOnInit(),this.initTasks(),this.userService.filterToggle.pipe(Object(f.a)(this.destroy$)).subscribe(e=>{this.toggleFilter=!this.toggleFilter&&e})}initTasks(){this.loading=!0,this.taskService.getTaskOwners(0,0,0,this.contactID,0,0).pipe(Object(f.a)(this.destroy$)).subscribe(e=>{e=Object(l.j)(e,"taskOwnerID");let t=Object(u.a)(e);const n=Object(u.a)(e);t=Object(l.j)(t,"taskID"),t=t.map(e=>{if(e.taskOwners=n.filter(t=>t.taskID===e.taskID),e.underWayCount=e.taskOwners.filter(e=>1===e.taskStatusID).length||0,e.pendingCount=e.taskOwners.filter(e=>2===e.taskStatusID).length||0,e.completedCount=e.taskOwners.filter(e=>3===e.taskStatusID).length||0,e.toDoCanUpdate=e.taskOwners.find(e=>e.contactID===this.contactID),e.endDate){const t=new Date(e.endDate);e.endDateModel={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()}}return e}),this.originTasks=t,this.onFilter(),this.loading=!1})}openAddTaskModal(){const e=this.modal.open(ae.a,{size:"lg"});e.componentInstance.taskOwners=[],e.componentInstance.taskSupporters=[],e.componentInstance.referenceId=0,e.componentInstance.masterCompanyID=this.companyID,e.result.then(e=>{e&&e.task&&(this.originTasks.push(e.task),this.onFilter())},()=>{})}syncTask(e){this.originTasks.push(e),this.onFilter()}onFilter(){let e=Object(l.l)(this.originTasks);this.filter.open&&(e=e.filter(e=>3!==e.taskStatusID)),this.filter.closed&&(e=e.filter(e=>3===e.taskStatusID)),this.filter.my&&(e=e.filter(e=>e.contactID===this.contactID)),this.filter.me&&(e=e.filter(e=>e.submittedBy===this.contactID)),this.filter.today&&(e=e.filter(e=>!!e.endDate&&Object(l.a)(new Date,"dd-MM-yyyy")===Object(l.a)(e.endDate,"dd-MM-yyyy"))),this.filter.week&&(e=e.filter(e=>!!e.endDate&&Object(l.a)(new Date,"w")===Object(l.a)(e.endDate,"w"))),this.tasks=e}statusFilter(e){"open"===e?(this.filter.open=!0,this.filter.closed=!1):(this.filter.open=!1,this.filter.closed=!0),this.onFilter()}ownerFilter(e){"my"===e?(this.filter.my=!0,this.filter.me=!1):(this.filter.my=!1,this.filter.me=!0),this.onFilter()}dateFilter(e){"today"===e?(this.filter.today=!0,this.filter.week=!1):(this.filter.today=!1,this.filter.week=!0),this.onFilter()}resetFilter(){this.filter={open:null,closed:null,my:null,me:null,today:null,week:null},this.onFilter()}createMonthlyReport(){this.modal.open(ye).result.then(e=>{e&&e.task&&this.syncTask(e.task)})}createOnboardingTask(){this.modal.open(Ve).result.then(e=>{e&&e.task&&this.syncTask(e.task)})}onTaskDelete(e){const t=this.originTasks.findIndex(t=>t.taskID===e);-1!==t&&(this.originTasks.splice(t,1),this.onFilter())}onTaskUpdate(e){const t=this.originTasks.findIndex(t=>t.taskID===e.taskID);-1!==t&&(this.originTasks[t]=e,this.onFilter())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](v.a),s["\u0275\u0275directiveInject"](I.a),s["\u0275\u0275directiveInject"](a.c),s["\u0275\u0275directiveInject"](g.p),s["\u0275\u0275directiveInject"](y.a),s["\u0275\u0275directiveInject"](i.j))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["app-weekly-tasks"]],features:[s["\u0275\u0275InheritDefinitionFeature"]],decls:55,vars:50,consts:[[1,"d-flex","w-100","min-full-height"],[1,"left-hand-filter","d-flex","flex-column","pt-4","pl-2","pr-2",3,"click"],[1,"d-flex","flex-column","w-100","inner-container",3,"click"],[1,"pl-3","pr-3","mt-4"],[1,"form-group","d-flex","flex-column"],[1,"custom-control","custom-radio","custom-control-inline"],["type","radio","id","filter-1","name","filter-1",1,"custom-control-input",3,"checked","change"],["for","filter-1",1,"custom-control-label"],["type","radio","id","filter-2","name","filter-2",1,"custom-control-input",3,"checked","change"],["for","filter-2",1,"custom-control-label"],[1,"d-flex","w-100","border-top","mt-2","mb-2"],["type","radio","id","filter-3","name","filter-3",1,"custom-control-input",3,"checked","change"],["for","filter-3",1,"custom-control-label"],["type","radio","id","filter-4","name","filter-4",1,"custom-control-input",3,"checked","change"],["for","filter-4",1,"custom-control-label"],["type","radio","id","filter-5","name","filter-5",1,"custom-control-input",3,"checked","change"],["for","filter-5",1,"custom-control-label"],["type","radio","id","filter-6","name","filter-6",1,"custom-control-input",3,"checked","change"],["for","filter-6",1,"custom-control-label"],["class","cursor-pointer text-primary ml-auto mt-2",3,"click",4,"ngIf"],[1,"d-flex","flex-column","flex-grow-1"],[1,"d-flex","flex-column","w-100",3,"avnonLoader","ngClass"],["class","page-title d-flex py-2 justify-content-end",4,"ngIf"],[1,"col-12","d-flex","pl-3","pr-3","align-items-center","filter-container"],[1,"cursor-pointer","text-primary","display-inline","mr-2",3,"click"],[1,"fas","fa-long-arrow-alt-left"],[1,"post-count"],[1,"actions","d-flex","ml-auto"],[1,"d-flex","align-items-center","cursor-pointer","ml-auto",3,"click"],[1,"plus-ico-2"],["class","dropdown ml-2",4,"ngIf"],[3,"tasks","showDate","showStatus","parentTaskID","referenceID","taskCategoryID","contactID","companyID","user","showHeader","taskDeleted","taskUpdated"],[1,"cursor-pointer","text-primary","ml-auto","mt-2",3,"click"],[1,"page-title","d-flex","py-2","justify-content-end"],[1,"d-flex","align-items-center","cursor-pointer",3,"click"],[1,"cursor-pointer","text-primary","display-inline","mr-2"],[1,"fas","fa-cog","is-gray"],[1,"display-inline","mb-0","meta"],[1,"dropdown","ml-2"],["type","button","id","dd1","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-30"],[1,"ico","dots-ico","dots-ico--gray"],["aria-labelledby","dd1",1,"dropdown-menu","dropdown-menu-end"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0),s["\u0275\u0275elementStart"](1,"div",1),s["\u0275\u0275listener"]("click",function(){return t.toggleFilter=!1}),s["\u0275\u0275elementStart"](2,"div",2),s["\u0275\u0275listener"]("click",function(e){return e.stopPropagation()}),s["\u0275\u0275elementStart"](3,"h3",3),s["\u0275\u0275text"](4," Filters "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"div",4),s["\u0275\u0275elementStart"](6,"div",5),s["\u0275\u0275elementStart"](7,"input",6),s["\u0275\u0275listener"]("change",function(){return t.statusFilter("open")}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](8,"label",7),s["\u0275\u0275text"](9),s["\u0275\u0275pipe"](10,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"div",5),s["\u0275\u0275elementStart"](12,"input",8),s["\u0275\u0275listener"]("change",function(){return t.statusFilter("closed")}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"label",9),s["\u0275\u0275text"](14),s["\u0275\u0275pipe"](15,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](16,"div",10),s["\u0275\u0275elementStart"](17,"div",5),s["\u0275\u0275elementStart"](18,"input",11),s["\u0275\u0275listener"]("change",function(){return t.ownerFilter("my")}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](19,"label",12),s["\u0275\u0275text"](20),s["\u0275\u0275pipe"](21,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](22,"div",5),s["\u0275\u0275elementStart"](23,"input",13),s["\u0275\u0275listener"]("change",function(){return t.ownerFilter("me")}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](24,"label",14),s["\u0275\u0275text"](25),s["\u0275\u0275pipe"](26,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275element"](27,"div",10),s["\u0275\u0275elementStart"](28,"div",5),s["\u0275\u0275elementStart"](29,"input",15),s["\u0275\u0275listener"]("change",function(){return t.dateFilter("today")}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](30,"label",16),s["\u0275\u0275text"](31),s["\u0275\u0275pipe"](32,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](33,"div",5),s["\u0275\u0275elementStart"](34,"input",17),s["\u0275\u0275listener"]("change",function(){return t.dateFilter("week")}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](35,"label",18),s["\u0275\u0275text"](36),s["\u0275\u0275pipe"](37,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](38,Fe,3,3,"span",19),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](39,"div",20),s["\u0275\u0275elementStart"](40,"div",21),s["\u0275\u0275template"](41,Ae,7,3,"div",22),s["\u0275\u0275elementStart"](42,"div",23),s["\u0275\u0275elementStart"](43,"span",24),s["\u0275\u0275listener"]("click",function(){return t.back()}),s["\u0275\u0275element"](44,"i",25),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](45,"span",26),s["\u0275\u0275text"](46),s["\u0275\u0275pipe"](47,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](48,"div",27),s["\u0275\u0275elementStart"](49,"a",28),s["\u0275\u0275listener"]("click",function(){return t.openAddTaskModal()}),s["\u0275\u0275element"](50,"span",29),s["\u0275\u0275text"](51),s["\u0275\u0275pipe"](52,"translate"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](53,Be,10,5,"div",30),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](54,"app-weekly-todo",31),s["\u0275\u0275listener"]("taskDeleted",function(e){return t.onTaskDelete(e)})("taskUpdated",function(e){return t.onTaskUpdate(e)}),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275classProp"]("toggled",t.toggleFilter),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("checked",t.filter.open),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](10,32,"PLANNER.TASK-FILTER.OPEN")," "),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("checked",t.filter.closed),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](15,34,"PLANNER.TASK-FILTER.CLOSED")," "),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("checked",t.filter.my),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](21,36,"PLANNER.TASK-FILTER.MY-TASKS")," "),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("checked",t.filter.me),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](26,38,"PLANNER.TASK-FILTER.MY-ASSIGNED-TASKS")," "),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("checked",t.filter.today),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](32,40,"PLANNER.TASK-FILTER.DUE-TODAY")," "),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("checked",t.filter.week),s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](37,42,"PLANNER.TASK-FILTER.DUE-THIS-WEEK")," "),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.filter.open||t.filter.closed||t.filter.me||t.filter.my||t.filter.today||t.filter.week),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("avnonLoader",t.loading)("ngClass",s["\u0275\u0275pureFunction1"](48,Le,t.isMobileFilteringOn)),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",t.isMobileScreenSize),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate2"](" ",t.tasks.length," ",s["\u0275\u0275pipeBind1"](47,44,"PLANNER.TASKS")," "),s["\u0275\u0275advance"](5),s["\u0275\u0275textInterpolate1"](" ",s["\u0275\u0275pipeBind1"](52,46,"PLANNER.ASSIGN-TASK")," "),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",t.superAdmin),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("tasks",t.tasks)("showDate",!0)("showStatus",!0)("parentTaskID",0)("referenceID",0)("taskCategoryID",3)("contactID",t.contactID)("companyID",t.companyID)("user",t.user)("showHeader",!0))},directives:[i.n,k.a,i.l,x.a],pipes:[O.c],styles:[".weekly-planner[_ngcontent-%COMP%]{max-width:600px;min-height:calc(100vh - 105px)}.asana-table[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{font-size:11px}.asana-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:1px solid #dfdfdf;border-top:0;padding:.5rem}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{max-width:40px;vertical-align:middle;padding-left:1rem}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-right:1rem}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0 .5rem;border:0}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border:0;padding:0;border-radius:0;line-height:32px;height:32px;background:transparent}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{box-shadow:none}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control.ng-touched.ng-invalid[_ngcontent-%COMP%]{border-bottom:1px solid #f44336;outline:0;box-shadow:none!important}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .dots-ico[_ngcontent-%COMP%]{opacity:.8;filter:grayscale(1)}.asana-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#f0f3ff}.count-placeholder[_ngcontent-%COMP%]   .count-30[_ngcontent-%COMP%]{width:30px;height:30px;position:absolute;display:flex;justify-content:center;align-items:center;font-weight:700;text-align:center;top:0;background:rgba(0,0,0,.6);color:#fff;border-radius:50%}"]}),e})()}]}];let $e=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.g.forChild(He)],a.g]}),e})();var Ue=n("j4PG"),We=n("GKkB"),Ke=n("kvvH"),ze=n("pr+S"),qe=n("4Ptv"),Ge=n("zemM"),Ye=n("PCNd"),Je=n("6pDZ"),Xe=n("vvGM"),Qe=n("ZLSo"),Ze=n("OZbp"),et=n("5+WD"),tt=n("ccsH");let nt=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.c,$e,g.q,Ue.a,b.l,b.z,Ge.a,b.l,g.h,We.a,Ke.a,ze.a,qe.a,O.b,Ye.a,g.l,g.D,Je.a,Xe.a,g.B,Qe.a,Ze.a,S.a,et.c,tt.a]]}),e})()}}]);