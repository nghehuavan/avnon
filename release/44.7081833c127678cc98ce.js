(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{"E/1g":function(t,e,n){"use strict";n.r(e),n.d(e,"ProductGoalWizardModule",function(){return at});var i=n("ofXK"),a=n("tyNb"),r=n("MNGV");class o{constructor(){this.taskID=null,this.taskMetricValue=null,this.taskMetricDescription=null,this.taskMetricID=null}}var s=n("AytR"),c=n("eIep"),l=n("8J6U"),p=n("p+bo"),d=n("cp0P"),m=n("LRne"),u=n("w6ya"),h=n("4CJs"),g=n("VgRj"),f=n("3DXX"),I=n("FddC"),y=n("frau"),D=n("fXoL"),S=n("Hu2X"),b=n("2tam"),v=n("ev4g"),x=n("XAmU"),C=n("5eHb"),k=n("1kSV"),w=n("9nlD"),P=n("S2+F"),E=n("k9EJ"),M=n("1bi4"),O=n("kmKP"),j=n("Jn3s"),A=n("3Pt+"),$=n("SdWN");function V(t,e){if(1&t&&(D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"p",14),D["\u0275\u0275text"](2,"Status Select"),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](3,"p",9),D["\u0275\u0275text"](4),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()),2&t){const t=D["\u0275\u0275nextContext"](2);D["\u0275\u0275advance"](4),D["\u0275\u0275textInterpolate2"](" What best describes the status of your ",2===(null==t.companyProduct?null:t.companyProduct.productTypeID)?"service":"product"," (",t.companyProduct.productName,") ")}}function F(t,e){if(1&t&&(D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"p",14),D["\u0275\u0275text"](2),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](3,"p",9),D["\u0275\u0275text"](4," In order to pass this stage the company must complete the following. "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()),2&t){const t=D["\u0275\u0275nextContext"](2);D["\u0275\u0275advance"](2),D["\u0275\u0275textInterpolate1"](" ",t.companyProduct.companyProductStatus," ")}}function T(t,e){1&t&&(D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"p",14),D["\u0275\u0275text"](2," Assign Supporters "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]())}function B(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementStart"](0,"div",19),D["\u0275\u0275listener"]("click",function(){D["\u0275\u0275restoreView"](t);const n=e.$implicit;return D["\u0275\u0275nextContext"](3).onStatusSelect(n.companyProductStatusID)}),D["\u0275\u0275elementStart"](1,"div",20),D["\u0275\u0275elementStart"](2,"h3",21),D["\u0275\u0275text"](3),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](4,"p",22),D["\u0275\u0275text"](5),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"]()}if(2&t){const t=e.$implicit,n=D["\u0275\u0275nextContext"](3);D["\u0275\u0275classProp"]("twitter-fill",n.companyProduct&&n.companyProduct.companyProductStatusID===t.companyProductStatusID),D["\u0275\u0275advance"](3),D["\u0275\u0275textInterpolate"](t.companyProductStatus),D["\u0275\u0275advance"](2),D["\u0275\u0275textInterpolate1"](" ",t.companyProductStatusDescription," ")}}function L(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"div",15),D["\u0275\u0275template"](2,B,6,4,"div",16),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](3,"div",17),D["\u0275\u0275elementStart"](4,"button",18),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).step=2}),D["\u0275\u0275text"](5," Next "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=D["\u0275\u0275nextContext"](2);D["\u0275\u0275advance"](2),D["\u0275\u0275property"]("ngForOf",t.productStatuses),D["\u0275\u0275advance"](2),D["\u0275\u0275property"]("disabled",!(null!=t.companyProduct&&t.companyProduct.companyProductStatusID))}}function R(t,e){if(1&t&&(D["\u0275\u0275elementStart"](0,"p",21),D["\u0275\u0275text"](1),D["\u0275\u0275elementEnd"]()),2&t){const t=D["\u0275\u0275nextContext"](2).$implicit;D["\u0275\u0275advance"](1),D["\u0275\u0275textInterpolate1"](" ",t.taskMetricDescription," ")}}function N(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementStart"](0,"span",32),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.toggleForm=!0}),D["\u0275\u0275text"](1," Add Details "),D["\u0275\u0275elementEnd"]()}}const U=function(){return{standalone:!0}};function G(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"div",33),D["\u0275\u0275elementStart"](2,"textarea",34),D["\u0275\u0275listener"]("ngModelChange",function(e){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.taskMetricDescription=e}),D["\u0275\u0275text"](3,"\t\t\t\t\t\t\t\t\t\t\t"),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](4,"span",35),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.toggleForm=!1}),D["\u0275\u0275text"](5," Save "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=D["\u0275\u0275nextContext"](2),e=t.index,n=t.$implicit;D["\u0275\u0275advance"](2),D["\u0275\u0275propertyInterpolate1"]("name","taskMetricDescription-",e,""),D["\u0275\u0275property"]("ngModel",n.taskMetricDescription)("ngModelOptions",D["\u0275\u0275pureFunction0"](3,U))}}function _(t,e){if(1&t&&(D["\u0275\u0275elementStart"](0,"div",20),D["\u0275\u0275elementStart"](1,"h3",21),D["\u0275\u0275text"](2),D["\u0275\u0275elementEnd"](),D["\u0275\u0275template"](3,R,2,1,"p",30),D["\u0275\u0275template"](4,N,2,0,"span",31),D["\u0275\u0275template"](5,G,6,4,"ng-container",1),D["\u0275\u0275elementEnd"]()),2&t){const t=D["\u0275\u0275nextContext"]().$implicit;D["\u0275\u0275advance"](2),D["\u0275\u0275textInterpolate"](t.companyProductStatusCheckList),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",t.taskMetricDescription&&!t.toggleForm),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",!t.taskMetricDescription&&!t.toggleForm),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",t.toggleForm)}}function q(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementStart"](0,"div",38),D["\u0275\u0275elementStart"](1,"h3",22),D["\u0275\u0275text"](2),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](3,"i",39),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.toggleForm=!0}),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](4,"i",40),D["\u0275\u0275listener"]("click",function(){D["\u0275\u0275restoreView"](t);const e=D["\u0275\u0275nextContext"](2).index;return D["\u0275\u0275nextContext"](3).removeMetric(e)}),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"]()}if(2&t){const t=D["\u0275\u0275nextContext"](2).$implicit;D["\u0275\u0275advance"](2),D["\u0275\u0275textInterpolate1"]("",t.companyProductStatusCheckList," ")}}function J(t,e){if(1&t&&(D["\u0275\u0275elementStart"](0,"p",21),D["\u0275\u0275text"](1),D["\u0275\u0275elementEnd"]()),2&t){const t=D["\u0275\u0275nextContext"](2).$implicit;D["\u0275\u0275advance"](1),D["\u0275\u0275textInterpolate1"](" ",t.taskMetricDescription," ")}}function X(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementStart"](0,"span",41),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.toggleForm=!0}),D["\u0275\u0275text"](1," Add Details "),D["\u0275\u0275elementEnd"]()}}function z(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"div",33),D["\u0275\u0275elementStart"](2,"input",42),D["\u0275\u0275listener"]("ngModelChange",function(e){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.companyProductStatusCheckList=e}),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](3,"textarea",43),D["\u0275\u0275listener"]("ngModelChange",function(e){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.taskMetricDescription=e}),D["\u0275\u0275text"](4,"\t\t\t\t\t\t\t\t\t\t\t"),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](5,"span",44),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).$implicit.toggleForm=!1}),D["\u0275\u0275text"](6," Save "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=D["\u0275\u0275nextContext"](2),e=t.index,n=t.$implicit;D["\u0275\u0275advance"](2),D["\u0275\u0275propertyInterpolate1"]("name","companyProductStatusCheckList-",e,""),D["\u0275\u0275property"]("ngModelOptions",D["\u0275\u0275pureFunction0"](8,U))("ngModel",n.companyProductStatusCheckList),D["\u0275\u0275advance"](1),D["\u0275\u0275propertyInterpolate1"]("name","taskMetricDescription-",e,""),D["\u0275\u0275property"]("ngModel",n.taskMetricDescription)("ngModelOptions",D["\u0275\u0275pureFunction0"](9,U)),D["\u0275\u0275advance"](2),D["\u0275\u0275classProp"]("disabled",!n.companyProductStatusCheckList)}}function Y(t,e){if(1&t&&(D["\u0275\u0275elementStart"](0,"div",20),D["\u0275\u0275template"](1,q,5,1,"div",36),D["\u0275\u0275template"](2,J,2,1,"p",30),D["\u0275\u0275template"](3,X,2,0,"span",37),D["\u0275\u0275template"](4,z,7,10,"ng-container",1),D["\u0275\u0275elementEnd"]()),2&t){const t=D["\u0275\u0275nextContext"]().$implicit;D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",!t.toggleForm),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",t.taskMetricDescription&&!t.toggleForm),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",!t.taskMetricDescription&&!t.toggleForm),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",t.toggleForm)}}function H(t,e){if(1&t&&(D["\u0275\u0275elementStart"](0,"div",28),D["\u0275\u0275template"](1,_,6,4,"div",29),D["\u0275\u0275template"](2,Y,5,4,"div",29),D["\u0275\u0275elementEnd"]()),2&t){const t=e.$implicit;D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",!t.customMetric),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",t.customMetric)}}function W(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"form",15,23),D["\u0275\u0275template"](3,H,3,2,"div",24),D["\u0275\u0275element"](4,"div"),D["\u0275\u0275elementStart"](5,"div",25),D["\u0275\u0275elementStart"](6,"button",26),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).addCustomMetric()}),D["\u0275\u0275text"](7," Add a custom metric "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](8,"div",17),D["\u0275\u0275elementStart"](9,"button",27),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).step=1}),D["\u0275\u0275text"](10,"Previous"),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](11,"button",18),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).step=3}),D["\u0275\u0275text"](12," Next "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=D["\u0275\u0275reference"](2),e=D["\u0275\u0275nextContext"](2);D["\u0275\u0275advance"](3),D["\u0275\u0275property"]("ngForOf",e.metrics),D["\u0275\u0275advance"](8),D["\u0275\u0275property"]("disabled",!e.metrics.length||t.invalid)}}function K(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementStart"](0,"div",50),D["\u0275\u0275element"](1,"img",51),D["\u0275\u0275pipe"](2,"avatar"),D["\u0275\u0275elementStart"](3,"div",52),D["\u0275\u0275elementStart"](4,"div",53),D["\u0275\u0275elementStart"](5,"h3",22),D["\u0275\u0275text"](6),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](7,"i",54),D["\u0275\u0275listener"]("click",function(){D["\u0275\u0275restoreView"](t);const n=e.index;return D["\u0275\u0275nextContext"](3).removeSupporter(n)}),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"]()}if(2&t){const t=e.$implicit;D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("src",D["\u0275\u0275pipeBind1"](2,3,t.profilePhoto),D["\u0275\u0275sanitizeUrl"]),D["\u0275\u0275advance"](5),D["\u0275\u0275textInterpolate2"]("",t.assigneeFirstName," ",t.assigneeSurname,"")}}function Q(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"p",45),D["\u0275\u0275text"](2," Select the mentor(s) and business advisor(s) who'll be assisting the company to achieve this goal "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](3,"div",46),D["\u0275\u0275template"](4,K,8,5,"div",47),D["\u0275\u0275elementStart"](5,"div",25),D["\u0275\u0275elementStart"](6,"span",48),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).assignSupporter()}),D["\u0275\u0275text"](7," Select supporters "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](8,"div",17),D["\u0275\u0275elementStart"](9,"button",27),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).step=2}),D["\u0275\u0275text"](10,"Previous"),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](11,"button",49),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"](2).submit()}),D["\u0275\u0275text"](12," Submit "),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=D["\u0275\u0275nextContext"](2);D["\u0275\u0275advance"](4),D["\u0275\u0275property"]("ngForOf",t.selectedSupporters),D["\u0275\u0275advance"](7),D["\u0275\u0275property"]("disabled",!t.selectedSupporters.length)}}function Z(t,e){if(1&t){const t=D["\u0275\u0275getCurrentView"]();D["\u0275\u0275elementContainerStart"](0),D["\u0275\u0275elementStart"](1,"div",2),D["\u0275\u0275elementStart"](2,"span",3),D["\u0275\u0275listener"]("click",function(){return D["\u0275\u0275restoreView"](t),D["\u0275\u0275nextContext"]().back()}),D["\u0275\u0275element"](3,"i",4),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](4,"h1",5),D["\u0275\u0275text"](5,"Activate Primary Goal"),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](6,"div",6),D["\u0275\u0275elementStart"](7,"span",7),D["\u0275\u0275element"](8,"img",8),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](9,"h2",9),D["\u0275\u0275elementStart"](10,"a"),D["\u0275\u0275text"](11),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](12,"span",10),D["\u0275\u0275text"](13),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementEnd"](),D["\u0275\u0275element"](14,"div",11),D["\u0275\u0275elementStart"](15,"div",12),D["\u0275\u0275template"](16,V,5,2,"ng-container",1),D["\u0275\u0275template"](17,F,5,1,"ng-container",1),D["\u0275\u0275template"](18,T,3,0,"ng-container",1),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementStart"](19,"div",13),D["\u0275\u0275template"](20,L,6,2,"ng-container",1),D["\u0275\u0275template"](21,W,13,2,"ng-container",1),D["\u0275\u0275template"](22,Q,13,2,"ng-container",1),D["\u0275\u0275elementEnd"](),D["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=D["\u0275\u0275nextContext"]();D["\u0275\u0275advance"](8),D["\u0275\u0275property"]("src",t.company.companyLogo?t.blobUrl+t.company.companyLogo:"assets/img/placeholder.jpg",D["\u0275\u0275sanitizeUrl"]),D["\u0275\u0275advance"](3),D["\u0275\u0275textInterpolate1"](" ",t.company.companyName," "),D["\u0275\u0275advance"](2),D["\u0275\u0275textInterpolate1"](" ",t.company.industry," "),D["\u0275\u0275advance"](3),D["\u0275\u0275property"]("ngIf",1===t.step),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",2===t.step),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",3===t.step),D["\u0275\u0275advance"](2),D["\u0275\u0275property"]("ngIf",1===t.step),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",2===t.step),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",3===t.step)}}const tt=[{path:":id/goal",component:(()=>{class t{constructor(t,e,n,i,a,o,c,l,p,d,m,u,h){this.companyService=t,this.companyProductService=e,this.taskService=n,this.discussionService=i,this.router=a,this.toastrService=o,this.modal=c,this.notificationService=l,this.signalRService=p,this.contractService=d,this.distributionService=m,this.activatedRoute=u,this.userService=h,this.goal=new r.a,this.productStatuses=[],this.metrics=[],this.blobUrl=s.a.apiBlobUrl+"/256px/",this.step=1,this.mentors=[],this.selectedSupporters=[],this.user=this.userService.user.getValue(),this.companyID=this.user.companyID||0,this.contactID=this.user.contactID}ngOnInit(){this.companyProductID=this.activatedRoute.snapshot.params.id,this.getProduct(),this.loadMentors()}getProduct(){this.productLoading=!0,this.companyProductService.getProduct(0,this.companyProductID).pipe(Object(c.a)(t=>(this.companyProduct=t[0],Object(d.a)(this.companyProductService.getStatuses(this.companyProduct.productCategoryID),this.companyService.getCompanyProfile(this.companyProduct.companyID))))).subscribe(t=>{this.productStatuses=t[0],this.company=t[1],this.companyProduct.companyProductStatusID&&this.onStatusSelect(this.companyProduct.companyProductStatusID),this.productLoading=!1})}submit(){this.loading=!0;const t=this.productStatuses.find(t=>t.companyProductStatusID===this.companyProduct.companyProductStatusID);this.goal.taskTitle=t.companyProductStatus,this.goal.taskClassificationID=this.companyProduct.companyProductStatusID,this.goal.endDate=Object(l.a)(new Date),this.goal.companyID=this.companyID,this.goal.submittedBy=this.contactID,this.goal.referenceID=this.companyProduct.companyProductID,this.goal.taskCategoryID=6,this.goal.formID=0,this.companyProduct.companyID=this.companyID,this.taskService.addTask(this.goal).pipe(Object(c.a)(t=>{this.goal.taskID=t.inOut_TaskID;const e=new p.a;return e.contactID=this.company.companyOwnerContactID,e.companyID=this.company.companyID,e.taskID=this.goal.taskID,e.endDate=this.goal.endDate,this.taskService.addTaskOwner(e)}),Object(c.a)(t=>this.discussionService.insertDiscussion({discussionTopic:this.goal.taskTitle,discussionCategoryID:6,referenceID:t.taskOwnerID,isDirectMessage:!0,discussionCreatedByContactID:this.contactID,discussionBody:this.goal.taskTitle,parentDiscussionID:0}))).subscribe(t=>{this.discussionService.addMember({discussionID:t.discussionID,contactID:this.contactID,isAdmin:!0}).subscribe(),this.selectedSupporters.forEach(t=>{const e=new I.a;e.taskID=this.goal.taskID,e.contactID=t.contactID,this.taskService.addTaskSupporter(e).subscribe(()=>{this.notifySupporter(t.contactID,this.goal)})}),this.companyProductService.updateProduct(this.companyProduct).subscribe(),this.notifyOwner(this.company.companyOwnerContactID,this.goal),this.submitChecklistGoals()})}submitChecklistGoals(){const t=[],e=[];this.metrics.forEach(e=>{const n=new r.a;n.submittedBy=this.contactID,n.taskTitle=e.companyProductStatusCheckList,n.referenceID=e.companyProductStatusChecklistID,n.parentTaskID=this.goal.taskID,n.taskClassificationID=e.taskMetricValue,n.taskDescription=e.taskMetricDescription,n.formID=0,n.taskCategoryID=35,n.endDate=this.goal.endDate,t.push(this.taskService.addTask(n))}),(t.length>0?Object(d.a)(t):Object(m.a)(t)).subscribe(t=>{const n=[];t.forEach(t=>{t.taskID=t.inOut_TaskID;const i=new p.a;i.contactID=this.company.companyOwnerContactID,i.taskID=t.taskID,i.endDate=this.goal.endDate,e.push(t),n.push(this.taskService.addTaskOwner(i))}),(n.length>0?Object(d.a)(n):Object(m.a)([])).subscribe(t=>{const n=[];t.forEach(t=>{const i=e.find(e=>e.taskID===t.taskID),a=e.findIndex(e=>e.taskID===t.taskID);-1!==a&&(e[a].taskOwnerID=t.taskOwnerID),i&&i.taskClassificationID&&(t.taskStatusID=2,t.dateSentForSignOff=Object(l.a)(new Date),this.taskService.updateTaskOwner(t).subscribe()),n.push(this.discussionService.insertDiscussion({discussionTopic:this.goal.taskTitle,discussionCategoryID:6,referenceID:t.taskOwnerID,isDirectMessage:!0,discussionCreatedByContactID:this.contactID,discussionBody:this.goal.taskTitle,parentDiscussionID:0}))}),(n.length>0?Object(d.a)(n):Object(m.a)([])).subscribe(t=>{t.forEach(t=>{const n=e.find(e=>e.taskOwnerID===t.referenceID);n&&this.postDiscussion(t.discussionID,n.taskDescription),this.discussionService.addMember({discussionID:t.discussionID,contactID:this.contactID,isAdmin:!0}).subscribe()}),this.loading=!1,this.toastrService.success("Goal has been succesfully created"),this.back()})})})}onStatusSelect(t){this.companyProduct.companyProductStatusID=t,this.companyProduct.companyProductStatus=this.productStatuses.find(e=>e.companyProductStatusID===t).companyProductStatus,this.loading=!0,this.companyProductService.getChecklist(0,t).subscribe(t=>{this.metrics=[],t.forEach(t=>{this.metrics.push({taskID:0,taskMetricDescription:t.companyProductStatusCheckListDescription,taskMetricValue:0,companyProductStatusCheckList:t.companyProductStatusCheckList,companyProductStatusChecklistID:t.companyProductStatusChecklistID,companyProductStatusID:t.companyProductStatusID})}),this.loading=!1})}postDiscussion(t,e){this.discussionService.insertDiscussion({discussionTopic:e,discussionCategoryID:6,isDirectMessage:!0,discussionCreatedByContactID:this.contactID,discussionBody:e,parentDiscussionID:t}).subscribe()}loadMentors(){this.mentorsLoading=!0,this.contractService.getContractAssignment(0,0,0,0,0,this.companyID,0).subscribe(t=>{this.mentors=t.map(t=>(t.firstName=t.assigneeFirstName,t.surname=t.assigneeSurname,t)),this.mentorsLoading=!1})}assignSupporter(){const t=this.modal.open(y.a);t.componentInstance.staticSelector=!0,t.componentInstance.contacts=this.mentors,t.componentInstance.selectedContacts=Object(l.l)(this.selectedSupporters),t.result.then(t=>{this.selectedSupporters=t})}removeSupporter(t){this.selectedSupporters.splice(t,1)}back(){this.router.navigate(["/company",this.companyProduct.companyID,"dashboard"])}notifySupporter(t,e){const n=Object(l.a)(new Date),i=`You've been assigned as a supporter to ${this.company.companyName} for ${e.taskTitle}`,a={notificationCategoryID:u.a.goal_supporter_role,referenceID:e.taskID,contactID:t,description:i,createdContact:this.contactID},r=n+"|"+e.taskID,o=this.selectedSupporters.find(e=>e.contactID===t).assigneeFirstName,s={date:n,body:i.replace("|",""),topic:i.replace("|",""),senderFullName:"",senderPhoto:"",notificationId:Math.floor(1e3*Math.random()),channel:"dashboard",reference:a.referenceID,notificationType:h.a.applicantRequest,senderId:a.createdContact,receivers:[a.contactID],uniqueId:r,discussionId:0};this.notificationService.noticeNotification(a).subscribe(()=>{this.signalRService.transferMessage("dashboard",s)});const c=g.a.fullDomain()+"/goal/"+e.taskID,p={distributionTitle:"Goal Supporter",distributionCategoryID:null,referenceID:null,distributionDate:null,userID:this.contactID,emailBody:f.a.template(`\n\t\t\t<p>Hi ${o}</p>\n\t\t\t<p>You've been assigned as a supporter to ${this.company.companyName} for ${e.taskTitle}.</p>\n\t\t\t<br>\n\t\t\t<p><span class="btn btn-primary" style="margin: 0; padding: 0"><a href="${c}">Read More</a></span></p>\n\t\t\t<br>\n\t\t`),subjectLine:"Goal Supporter",senderEmail:"info@incubatorportal.com",senderName:`${this.user.firstName} ${this.user.surname}`,replyTo:null,contacts:[t]};this.distributionService.create(p).subscribe(()=>{},()=>{})}notifyOwner(t,e){const n=Object(l.a)(new Date),i=`Your goal: '${e.taskTitle}' is active. Click see details to access the checklist `,a={notificationCategoryID:u.a.goal_support_task_owner,referenceID:e.taskID,contactID:t,description:i,createdContact:this.contactID},r=n+"|"+e.taskID,o={date:n,body:i.replace("|",""),topic:i.replace("|",""),senderFullName:"",senderPhoto:"",notificationId:Math.floor(1e3*Math.random()),channel:"dashboard",reference:a.referenceID,notificationType:h.a.applicantRequest,senderId:a.createdContact,receivers:[a.contactID],uniqueId:r,discussionId:0};this.notificationService.noticeNotification(a).subscribe(()=>{this.signalRService.transferMessage("dashboard",o)});const s=g.a.fullDomain()+"/goal/"+e.taskID,c={distributionTitle:"Goal Activation",distributionCategoryID:null,referenceID:null,distributionDate:null,userID:this.contactID,emailBody:f.a.template(`\n\t\t\t<p>Your goal: '${e.taskTitle}' is active. Click see read more to access the checklist </p>\n\t\t\t<br>\n\t\t\t<p><span class="btn btn-primary" style="margin: 0; padding: 0"><a href="${s}">Read More</a></span></p>\n\t\t\t<br>\n\t\t`),subjectLine:"Goal Activation",senderEmail:"info@incubatorportal.com",senderName:`${this.user.firstName} ${this.user.surname}`,replyTo:null,contacts:[t]};this.distributionService.create(c).subscribe(()=>{},()=>{})}addCustomMetric(){const t=new o;t.customMetric=!0,t.toggleForm=!0,this.metrics.push(t)}removeMetric(t){this.metrics.splice(t,1)}}return t.\u0275fac=function(e){return new(e||t)(D["\u0275\u0275directiveInject"](S.a),D["\u0275\u0275directiveInject"](b.a),D["\u0275\u0275directiveInject"](v.a),D["\u0275\u0275directiveInject"](x.a),D["\u0275\u0275directiveInject"](a.c),D["\u0275\u0275directiveInject"](C.b),D["\u0275\u0275directiveInject"](k.p),D["\u0275\u0275directiveInject"](w.a),D["\u0275\u0275directiveInject"](P.a),D["\u0275\u0275directiveInject"](E.a),D["\u0275\u0275directiveInject"](M.a),D["\u0275\u0275directiveInject"](a.a),D["\u0275\u0275directiveInject"](O.a))},t.\u0275cmp=D["\u0275\u0275defineComponent"]({type:t,selectors:[["app-product-goal-wizard"]],decls:2,vars:2,consts:[[1,"product-content","p-0",3,"avnonLoader"],[4,"ngIf"],[1,"page-title"],[1,"cursor-pointer","text-primary","display-inline","mr-2",3,"click"],[1,"fas","fa-long-arrow-alt-left"],[1,"display-inline"],[1,"entry","border-none"],[1,"media","avatar","avatar-48","avatar-48-square"],["alt","Avatar",1,"img-fluid","img-48",3,"src"],[1,"mt-1"],[1,"meta"],[1,"bottom-actions","d-flex","justify-content-end","align-items-center"],[1,"profile-overview","pb-0","pt-0","mt-0"],[1,"section","section-alt","alt-bordered","pt-3"],[1,"p-23"],[1,"w-100","d-flex","flex-column"],["class","item-with-banner cursor-pointer d-flex w-100 pl-3 pr-3 pb-2 pt-2",3,"twitter-fill","click",4,"ngFor","ngForOf"],[1,"d-flex","w-100","pl-3","pr-3","mt-auto","dock-bottom","pt-2","pb-2","border-top"],[1,"btn","btn-sm","btn-outline-primary","ml-auto",3,"disabled","click"],[1,"item-with-banner","cursor-pointer","d-flex","w-100","pl-3","pr-3","pb-2","pt-2",3,"click"],[1,"network-data","d-flex","flex-column","flex-grow-1"],[1,"mb-1"],[1,"mb-0"],["f","ngForm"],["class","item-with-banner cursor-pointer d-flex w-100 pl-3 pr-3 pb-2 pt-2",4,"ngFor","ngForOf"],[1,"filter-container"],[1,"btn","btn-sm","btn-primary","mr-auto",3,"click"],[1,"btn","btn-sm","btn-light",3,"click"],[1,"item-with-banner","cursor-pointer","d-flex","w-100","pl-3","pr-3","pb-2","pt-2"],["class","network-data d-flex flex-column flex-grow-1",4,"ngIf"],["class","mb-1",4,"ngIf"],["class","cursor text-primary mt-1",3,"click",4,"ngIf"],[1,"cursor","text-primary","mt-1",3,"click"],[1,"d-flex","w-100","flex-column"],["placeholder","Description",1,"form-control",3,"ngModel","name","ngModelOptions","ngModelChange"],[1,"ml-auto","mt-2","mb-1","cursor-pointer","text-primary",3,"click"],["class","d-flex w-100 mb-1",4,"ngIf"],["class","cursor text-primary",3,"click",4,"ngIf"],[1,"d-flex","w-100","mb-1"],[1,"fas","fa-pencil-alt","ml-auto",3,"click"],[1,"fas","fa-trash-alt","ml-2",3,"click"],[1,"cursor","text-primary",3,"click"],["type","text","placeholder","Title","required","",1,"form-control",3,"name","ngModelOptions","ngModel","ngModelChange"],["placeholder","Description",1,"form-control","mt-2",3,"ngModel","name","ngModelOptions","ngModelChange"],[1,"ml-auto","mt-3","mb-1","cursor-pointer","text-primary",3,"click"],[1,"mt-2","pl-3","pr-3"],[1,"d-flex","flex-column"],["class","common-list-item w-100 d-flex flex-row border-top-0",4,"ngFor","ngForOf"],[1,"mr-auto","mt-3","cursor-pointer","text-primary",3,"click"],[1,"btn","btn-sm","btn-primary","ml-auto",3,"disabled","click"],[1,"common-list-item","w-100","d-flex","flex-row","border-top-0"],["alt","Avatar",1,"avatar-48","avatar","contain-avatar",3,"src"],[1,"list-data","d-flex","flex-column","ml-2","flex-grow-1"],[1,"d-flex","w-100"],[1,"fas","fa-trash-alt","text-danger","ml-auto",3,"click"]],template:function(t,e){1&t&&(D["\u0275\u0275elementStart"](0,"div",0),D["\u0275\u0275template"](1,Z,23,9,"ng-container",1),D["\u0275\u0275elementEnd"]()),2&t&&(D["\u0275\u0275property"]("avnonLoader",e.loading||e.productLoading||e.mentorsLoading),D["\u0275\u0275advance"](1),D["\u0275\u0275property"]("ngIf",e.companyProduct&&e.company))},directives:[j.a,i.n,i.m,A.E,A.r,A.s,A.b,A.q,A.t,A.A],pipes:[$.a],styles:[".status-icon[_ngcontent-%COMP%]{height:32px;min-width:32px;display:flex;align-items:center;color:#6c757d;border:1px solid #6c757d;border-radius:50%;font-size:14px;justify-content:center}.disabled[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}"]}),t})()}];let et=(()=>{class t{}return t.\u0275mod=D["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=D["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[a.g.forChild(tt)],a.g]}),t})();var nt=n("j4PG"),it=n("pr+S");let at=(()=>{class t{}return t.\u0275mod=D["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=D["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[i.c,et,nt.a,A.l,A.z,k.q,it.a]]}),t})()},k9EJ:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("tk/3"),a=n("2Vo4"),r=n("fXoL");let o=(()=>{class t{constructor(t){this.http=t,this.BaseURI="https://api.incubatorportal.com/api",this.activeAssignment=new a.a(null),this.activeAssignments=new a.a([])}addContract(t){return this.http.post(this.BaseURI+"/contract",t)}addContractMember(t){return this.http.post(this.BaseURI+"/contract/member",t)}addContractAssignment(t){return this.http.post(this.BaseURI+"/contract/assignment",t)}updateContract(t){return this.http.put(this.BaseURI+"/contract",t)}updateContractMember(t){return this.http.put(this.BaseURI+"/contract/member",t)}updateContractAssignment(t){return this.http.put(this.BaseURI+"/contract/assignment",t)}deleteContract(t){const e={headers:new i.f({"Content-Type":"application/json"}),body:{contractID:t}};return this.http.delete(this.BaseURI+"/contract",e)}deleteContractMember(t){return this.http.delete(`${this.BaseURI}/contract/${t}`)}deleteContractAssignment(t){const e={headers:new i.f({"Content-Type":"application/json"}),body:{contractAssignmentID:t}};return this.http.delete(this.BaseURI+"/contract/assignment",e)}getContractMember(t,e){return this.http.get(this.BaseURI+"/contract/member?contractMemberID="+t+"&contractID="+e)}getContractAssignment(t,e,n,i,a,r,o,s=0){return this.http.get(this.BaseURI+"/contract/assignment?contractID="+t+"&contractAssignmentID="+e+"&contractCategoryID="+n+"&contactID="+i+"&contractAssignmentContactID="+a+"&contractAssignmentCompanyID="+r+"&contractMemberCategoryID="+o+"&companyID="+s)}getContract(t,e,n,i,a,r,o,s,c){return this.http.get(this.BaseURI+"/contract?CompanyID="+t+"&companyLocationID="+e+"&contractID="+n+"&contactID="+i+"&contractCategoryID="+a+"&contractMemberTypeID="+r+"&referenceID="+o+"&contractMemberID="+s+"&masterCompanyID="+c)}setActiveAssignment(t){this.activeAssignment.next(t)}getActiveAssignment(){return this.activeAssignment.asObservable()}setActiveAassignments(t){this.activeAssignments.next(t)}getActiveAssignments(){return this.activeAssignments.asObservable()}getAssignmentImpact(t=0,e=0,n=0,i=0){return this.http.get(`${this.BaseURI}/contract/assignment/impact?ContractID=${t}\n\t\t&ContractAssignmentID=${e}\n\t\t&MenteeCompanyID=${n}\n\t\t&ContactID=${i}\n\t\t`)}}return t.\u0275fac=function(e){return new(e||t)(r["\u0275\u0275inject"](i.b))},t.\u0275prov=r["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);